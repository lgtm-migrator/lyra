(window.__webpackJsonp__=window.__webpackJsonp__||[]).push([[3],{1:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"w",function(){return b}),n.d(t,"v",function(){return g}),n.d(t,"C",function(){return p}),n.d(t,"m",function(){return m}),n.d(t,"p",function(){return h}),n.d(t,"c",function(){return O}),n.d(t,"B",function(){return j}),n.d(t,"h",function(){return v}),n.d(t,"t",function(){return y}),n.d(t,"E",function(){return w}),n.d(t,"A",function(){return k}),n.d(t,"l",function(){return S}),n.d(t,"i",function(){return D}),n.d(t,"r",function(){return $}),n.d(t,"G",function(){return E}),n.d(t,"g",function(){return C}),n.d(t,"o",function(){return N}),n.d(t,"H",function(){return _}),n.d(t,"s",function(){return z}),n.d(t,"e",function(){return A}),n.d(t,"D",function(){return T}),n.d(t,"b",function(){return P}),n.d(t,"j",function(){return M}),n.d(t,"z",function(){return L}),n.d(t,"y",function(){return U}),n.d(t,"x",function(){return H}),n.d(t,"a",function(){return q}),n.d(t,"k",function(){return W}),n.d(t,"F",function(){return B}),n.d(t,"n",function(){return G}),n.d(t,"u",function(){return Y}),n.d(t,"q",function(){return V});n(1144);var i=n(1022),r=n.n(i),o=n(1023),c=n.n(o),a=n(294),s=n.n(a),u=n(0),l=n(254);const d=c.a,f=r.a;function b(e,t){const n={};for(const i of t)Object(u.v)(e,i)&&(n[i]=e[i]);return n}function g(e,t){const n=Object.assign({},e);for(const e of t)delete n[e];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>s()(e)).join(",")})`};const p=s.a;function m(e){if(Object(u.E)(e))return e;const t=Object(u.H)(e)?e:s()(e);if(t.length<250)return t;let n=0;for(let e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n&=n}return n}function h(e){return!1===e||null===e}function O(e,t){return e.indexOf(t)>-1}function j(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function v(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function y(e,...t){for(const n of t)x(e,null!=n?n:{});return e}function x(e,t){for(const n of Object.keys(t))Object(u.ib)(e,n,t[n],!0)}function w(e,t){const n=[],i={};let r;for(const o of e)(r=t(o))in i||(i[r]=1,n.push(o));return n}function k(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function S(e,t){for(const n of e)if(t.has(n))return!0;return!1}function F(e){const t=new Set;for(const n of e){const e=Object(u.X)(n).map((e,t)=>0===t?e:`[${e}]`);e.map((t,n)=>e.slice(0,n+1).join("")).forEach(e=>t.add(e))}return t}function D(e,t){return void 0===e||void 0===t||S(F(e),F(t))}const $=Object.keys;function E(e){const t=[];for(const n in e)Object(u.v)(e,n)&&t.push(e[n]);return t}function C(e){const t=[];for(const n in e)Object(u.v)(e,n)&&t.push({key:n,value:e[n]});return t}function N(e){return!0===e||!1===e}function _(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function z(e,t){return Object(l.c)(e)?"!("+z(e.not,t)+")":Object(l.b)(e)?"("+e.and.map(e=>z(e,t)).join(") && (")+")":Object(l.d)(e)?"("+e.or.map(e=>z(e,t)).join(") || (")+")":t(e)}function A(e,t){if(0===t.length)return!0;const n=t.shift();return A(e[n],t)&&delete e[n],0===$(e).length}function T(e){return e.charAt(0).toUpperCase()+e.substr(1)}function R(e){return e.replace(/(\[|\]|\.)/g,"\\$1")}function P(e,t="datum"){const n=Object(u.X)(e),i=[];for(let e=1;e<=n.length;e++){const r=`[${n.slice(0,e).map(u.Y).join("][")}]`;i.push(`${t}${r}`)}return i.join(" && ")}function M(e,t="datum"){return`${t}[${Object(u.Y)(Object(u.X)(e).join("."))}]`}function L(e){return`${Object(u.X)(e).map(R).join("\\.")}`}function U(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function H(e){return`${Object(u.X)(e).join(".")}`}function q(e){return e?Object(u.X)(e).length:0}function W(...e){for(const t of e)if(void 0!==t)return t}let I=42;function B(e){const t=++I;return e?String(e)+t:t}function G(e){return function(e){return 0===e.indexOf("__")}(e)?e:`__${e}`}function Y(e){return(e%360+360)%360}function V(e){return!!Object(u.E)(e)||!isNaN(e)&&!isNaN(parseFloat(e))}},101:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u});var i=n(138),r=n(345),o=n(346);function c(e){return e instanceof i.a||e instanceof r.a||e instanceof o.a}class a{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class s extends a{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:e,mutatedFlag:t}){e&&this.setContinue(),t&&this.setMutated()}reset(){}optimizeNextFromLeaves(e){if(c(e))return!1;const t=e.parent,{continueFlag:n}=this.run(e);return n&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}class u extends a{}},1021:function(e){e.exports={name:"vega-lite",author:'Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:"4.3.1",collaborators:["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{changelog:"conventional-changelog -p angular",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint --ext .ts .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@commitlint/cli":"^8.3.5","@commitlint/config-conventional":"^8.3.4","@rollup/plugin-commonjs":"11.0.2","@rollup/plugin-json":"^4.0.2","@rollup/plugin-node-resolve":"^7.1.1","@types/chai":"^4.2.8","@types/d3":"^5.7.2","@types/jest":"^25.1.2","@types/jest-environment-puppeteer":"^4.3.1","@types/mkdirp":"^0.5.2","@types/puppeteer":"^2.0.0","@typescript-eslint/eslint-plugin":"^2.19.0","@typescript-eslint/parser":"^2.19.0",ajv:"^6.11.0",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.6.5",concurrently:"^5.1.0","conventional-changelog-cli":"^2.0.31",d3:"^5.15.0",eslint:"^6.8.0","eslint-config-prettier":"^6.10.0","eslint-plugin-prettier":"^3.1.2","gh-pages":"^2.2.0","highlight.js":"^9.18.1","http-server":"^0.12.1",husky:"^4.2.1",jest:"^25.1.0","jest-puppeteer":"^4.4.0","lint-staged":"^10.0.7",mkdirp:"^1.0.3",prettier:"^1.19.1",puppeteer:"^2.1.1",rollup:"^1.31.0","rollup-plugin-sourcemaps":"^0.5.0","rollup-plugin-terser":"^5.2.0","svg2png-many":"^0.0.7",terser:"^4.6.3","ts-jest":"^25.2.0","ts-json-schema-generator":"0.60.0",typescript:"~3.7.5","vega-cli":"^5.9.1","vega-datasets":"^1.29.0","vega-embed":"^6.2.2","vega-tooltip":"^0.20.1","vega-typings":"~0.12.3","yaml-front-matter":"^4.1.0"},dependencies:{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~1.10.0","vega-event-selector":"~2.0.2","vega-expression":"~2.6.3","vega-scale":"^6.0.0","vega-util":"~1.12.2",yargs:"~15.1.0"},peerDependencies:{vega:"^5.9.0"},husky:{hooks:{"pre-commit":"lint-staged","commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},"lint-staged":{"*.ts":["eslint --fix","git add"],"*.{md,css,yml}":["prettier --write","git add"]},jest:{preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1}}},1023:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!=r--;){var c=o[r];if(!e(t[c],n[c]))return!1}return!0}return t!=t&&n!=n}},1024:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(1),r=n(247),o=n(359),c=n(360),a=n(255);const s={};function u(e,t,n){const i=new r.a(e,t);s[e]={normalizer:i,parts:n}}function l(){return Object(i.r)(s)}u(o.a,o.d,o.b),u(a.a,a.e,a.b),u(c.a,c.d,c.b)},1025:function(e,t,n){"use strict";n.r(t),n.d(t,"invalidSpec",function(){return o}),n.d(t,"FIT_NON_SINGLE",function(){return c}),n.d(t,"containerSizeNonSingle",function(){return a}),n.d(t,"containerSizeNotCompatibleWithAutosize",function(){return s}),n.d(t,"droppingFit",function(){return u}),n.d(t,"cannotProjectOnChannelWithoutField",function(){return l}),n.d(t,"cannotProjectAggregate",function(){return d}),n.d(t,"nearestNotSupportForContinuous",function(){return f}),n.d(t,"selectionNotSupported",function(){return b}),n.d(t,"selectionNotFound",function(){return g}),n.d(t,"SCALE_BINDINGS_CONTINUOUS",function(){return p}),n.d(t,"LEGEND_BINDINGS_PROJECT_LENGTH",function(){return m}),n.d(t,"noSameUnitLookup",function(){return h}),n.d(t,"noSuchRepeatedValue",function(){return O}),n.d(t,"columnsNotSupportByRowCol",function(){return j}),n.d(t,"CONCAT_CANNOT_SHARE_AXIS",function(){return v}),n.d(t,"REPEAT_CANNOT_SHARE_AXIS",function(){return y}),n.d(t,"unrecognizedParse",function(){return x}),n.d(t,"differentParse",function(){return w}),n.d(t,"invalidTransformIgnored",function(){return k}),n.d(t,"NO_FIELDS_NEEDS_AS",function(){return S}),n.d(t,"encodingOverridden",function(){return F}),n.d(t,"projectionOverridden",function(){return D}),n.d(t,"primitiveChannelDef",function(){return $}),n.d(t,"invalidFieldType",function(){return E}),n.d(t,"nonZeroScaleUsedWithLengthMark",function(){return C}),n.d(t,"invalidFieldTypeForCountAggregate",function(){return N}),n.d(t,"invalidAggregate",function(){return _}),n.d(t,"missingFieldType",function(){return z}),n.d(t,"droppingColor",function(){return A}),n.d(t,"emptyFieldDef",function(){return T}),n.d(t,"latLongDeprecated",function(){return R}),n.d(t,"LINE_WITH_VARYING_SIZE",function(){return P}),n.d(t,"incompatibleChannel",function(){return M}),n.d(t,"invalidEncodingChannel",function(){return L}),n.d(t,"facetChannelShouldBeDiscrete",function(){return U}),n.d(t,"facetChannelDropped",function(){return H}),n.d(t,"discreteChannelCannotEncode",function(){return q}),n.d(t,"lineWithRange",function(){return W}),n.d(t,"orientOverridden",function(){return I}),n.d(t,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",function(){return B}),n.d(t,"RANGE_STEP_DEPRECATED",function(){return G}),n.d(t,"cannotUseScalePropertyWithNonColor",function(){return Y}),n.d(t,"unaggregateDomainHasNoEffectForRawField",function(){return V}),n.d(t,"unaggregateDomainWithNonSharedDomainOp",function(){return J}),n.d(t,"unaggregatedDomainWithLogScale",function(){return Q}),n.d(t,"cannotApplySizeToNonOrientedMark",function(){return X}),n.d(t,"scaleTypeNotWorkWithChannel",function(){return Z}),n.d(t,"scaleTypeNotWorkWithFieldDef",function(){return K}),n.d(t,"scalePropertyNotWorkWithScaleType",function(){return ee}),n.d(t,"scaleTypeNotWorkWithMark",function(){return te}),n.d(t,"stepDropped",function(){return ne}),n.d(t,"mergeConflictingProperty",function(){return ie}),n.d(t,"mergeConflictingDomainProperty",function(){return re}),n.d(t,"independentScaleMeansIndependentGuide",function(){return oe}),n.d(t,"domainSortDropped",function(){return ce}),n.d(t,"UNABLE_TO_MERGE_DOMAINS",function(){return ae}),n.d(t,"MORE_THAN_ONE_SORT",function(){return se}),n.d(t,"INVALID_CHANNEL_FOR_AXIS",function(){return ue}),n.d(t,"cannotStackRangedMark",function(){return le}),n.d(t,"cannotStackNonLinearScale",function(){return de}),n.d(t,"stackNonSummativeAggregate",function(){return fe}),n.d(t,"invalidTimeUnit",function(){return be}),n.d(t,"dayReplacedWithDate",function(){return ge}),n.d(t,"droppedDay",function(){return pe}),n.d(t,"errorBarCenterAndExtentAreNotNeeded",function(){return me}),n.d(t,"errorBarCenterIsUsedWithWrongExtent",function(){return he}),n.d(t,"errorBarContinuousAxisHasCustomizedAggregate",function(){return Oe}),n.d(t,"errorBarCenterIsNotNeeded",function(){return je}),n.d(t,"errorBand1DNotSupport",function(){return ve}),n.d(t,"channelRequiredForBinned",function(){return ye}),n.d(t,"domainRequiredForThresholdScale",function(){return xe});var i=n(5),r=n(1);function o(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const c='Autosize "fit" only works for single views and layered views.';function a(e){return`${"width"==e?"Width":"Height"} "container" only works for single views and layered views.`}function s(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-x".`}function u(e){return e?`Dropping "fit-${e}" because spec has discrete ${Object(i.H)(e)}.`:'Dropping "fit" because spec has discrete size.'}function l(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function d(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function f(e){return`The "nearest" transform is not supported for ${e} marks.`}function b(e){return`Selection not supported for ${e} yet.`}function g(e){return`Cannot find a selection named "${e}".`}const p="Scale bindings are currently only supported for scales with unbinned, continuous domains.",m="Legend bindings are only supported for selections over an individual field or encoding channel.";function h(e){return`Cannot define and lookup the "${e}" selection in the same view. `+"Try moving the lookup into a second, layered view?"}function O(e){return`Unknown repeated value "${e}".`}function j(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const v="Axes cannot be shared in concatenated views yet (https://github.com/vega/vega-lite/issues/2415).",y="Axes cannot be shared in repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function x(e){return`Unrecognized parse "${e}".`}function w(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function k(e){return`Ignoring an invalid transform: ${Object(r.C)(e)}.`}const S='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function F(e){return`Layer's shared ${e.join(",")} channel ${1===e.length?"is":"are"} overriden.`}function D(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Object(r.C)(t)} is overridden by a child projection ${Object(r.C)(n)}.`}function $(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Object(r.C)(n)}}.`}function E(e){return`Invalid field type "${e}".`}function C(e,t,n){return`A ${n.scaleType?`${n.scaleType} scale`:n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero"} is used to encode ${e}'s ${t}. This can be misleading as the ${"x"===t?"width":"height"} of the ${e} can be arbitrary based on the scale domain. You may want to use point mark instead.`}function N(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function _(e){return`Invalid aggregation operator "${e}".`}function z(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function A(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function T(e,t){return`Dropping ${Object(r.C)(e)} from channel "${t}" since it does not contain any data field, value, or signal.`}function R(e,t,n){return`${e}-encoding with type ${t} is deprecated. Replacing with ${n}-encoding.`}const P="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function M(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function L(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function U(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function H(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function q(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function W(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function I(e,t){return`Specified orient "${e}" overridden with "${t}".`}const B="Custom domain scale cannot be unioned with default field-based domain.",G='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function Y(e){return`Cannot use the scale property "${e}" with non-color channel.`}function V(e){return`Using unaggregated domain with raw field has no effect (${Object(r.C)(e)}).`}function J(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Q(e){return`Unaggregated domain is currently unsupported for log scale (${Object(r.C)(e)}).`}function X(e){return`Cannot apply size to non-oriented mark "${e}".`}function Z(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function K(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function ee(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function te(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function ne(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}function ie(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Object(r.C)(n)} and ${Object(r.C)(i)}). Using ${Object(r.C)(n)}.`}function re(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Object(r.C)(n)} and ${Object(r.C)(i)}). Using the union of the two domains.`}function oe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function ce(e){return`Dropping sort property ${Object(r.C)(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const ae="Unable to merge domains.",se="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",ue="Invalid channel for axis.";function le(e){return`Cannot stack "${e}" if there is already "${e}2".`}function de(e){return`Cannot stack non-linear scale (${e}).`}function fe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function be(e,t){return`Invalid ${e}: ${Object(r.C)(t)}.`}function ge(e){return`Time unit "${e}" is not supported. We are replacing it with ${Object(r.y)(e,"day","date")}.`}function pe(e){return`Dropping day from datetime ${Object(r.C)(e)} as day cannot be combined with other units.`}function me(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function he(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Oe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function je(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function ve(e){return`1D error band does not support ${e}.`}function ye(e){return`Channel ${e} is required for "binned" bin.`}function xe(e){return`Domain for ${e} is required for threshold scale.`}},1026:function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"]},1027:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var i=n(18),r=n(0),o=n(5),c=n(359),a=n(360),s=n(255),u=n(46),l=n(6),d=n(93),f=n(524),b=n(123),g=n(1),p=n(1028),m=n(1029),h=n(1030);class O extends f.a{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[c.c,s.c,a.c,new p.a,new h.a,new m.a]}map(e,t){if(Object(b.a)(e)){const n=Object(u.a)(e.encoding,o.q),i=Object(u.a)(e.encoding,o.c),r=Object(u.a)(e.encoding,o.d);if(n||i||r)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:i}=t;if(n||i)return this.mapUnitWithParentEncodingOrProjection(e,t);const r=this.mapLayerOrUnit.bind(this);for(const n of this.nonFacetUnitNormalizers)if(n.hasMatchingType(e,t.config))return n.run(e,t,r);return e}mapRepeat(e,t){const{repeat:n}=e;return!Object(r.A)(n)&&e.columns&&(e=Object(g.v)(e,["columns"]),l.e(l.b.columnsNotSupportByRowCol("repeat"))),Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}mapFacet(e,t){const{facet:n}=e;return Object(d.b)(n)&&e.columns&&(e=Object(g.v)(e,["columns"]),l.e(l.b.columnsNotSupportByRowCol("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:i}=e,{parentEncoding:r,parentProjection:o,config:c}=t,a=v({parentProjection:o,projection:i}),s=j({parentEncoding:r,encoding:n});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),a?{projection:a}:{}),s?{encoding:s}:{}),{config:c})}mapFacetedUnit(e,t){const n=e.encoding,{row:r,column:o,facet:c}=n,a=Object(i.a)(n,["row","column","facet"]),{mark:s,width:u,projection:l,height:d,selection:f,encoding:b}=e,g=Object(i.a)(e,["mark","width","projection","height","selection","encoding"]),{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:r,column:o,facet:c});return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),m),{facet:p,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{projection:l}:{}),{mark:s}),u?{width:u}:{}),d?{height:d}:{}),{encoding:a}),f?{selection:f}:{})}),t)}getFacetMappingAndLayout(e){var t;const{row:n,column:r,facet:c}=e;if(n||r){c&&l.e(l.b.facetChannelDropped([...n?[o.q]:[],...r?[o.c]:[]]));const a={},s={};for(const n of[o.q,o.c]){const r=e[n];if(r){const{align:e,center:o,spacing:c,columns:u}=r,l=Object(i.a)(r,["align","center","spacing","columns"]);a[n]=l;for(const e of["align","center","spacing"])void 0!==r[e]&&(s[e]=null!=(t=s[e])?t:{},s[e][n]=r[e])}}return{facetMapping:a,layout:s}}{const{align:e,center:t,spacing:n,columns:r}=c;return{facetMapping:Object(i.a)(c,["align","center","spacing","columns"]),layout:Object.assign(Object.assign(Object.assign(Object.assign({},e?{align:e}:{}),t?{center:t}:{}),n?{spacing:n}:{}),r?{columns:r}:{})}}}mapLayer(e,t){var{parentEncoding:n,parentProjection:r}=t,o=Object(i.a)(t,["parentEncoding","parentProjection"]);const{encoding:c,projection:a}=e,s=Object(i.a)(e,["encoding","projection"]),u=Object.assign(Object.assign({},o),{parentEncoding:j({parentEncoding:n,encoding:c}),parentProjection:v({parentProjection:r,projection:a})});return super.mapLayer(s,u)}}function j(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const e=Object(g.r)(t).reduce((e,t)=>(n[t]&&e.push(t),e),[]);e.length>0&&l.e(l.b.encodingOverridden(e))}const i=Object.assign(Object.assign({},null!=t?t:{}),null!=n?n:{});return Object(g.r)(i).length>0?i:void 0}function v(e){const{parentProjection:t,projection:n}=e;return t&&n&&l.e(l.b.projectionOverridden({parentProjection:t,projection:n})),null!=n?n:t}},1028:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n(18),r=n(0),o=n(14),c=n(123),a=n(525),s=n(1);function u(e){const{point:t,line:n}=e,r=Object(i.a)(e,["point","line"]);return Object(s.r)(r).length>1?r:r.type}function l(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Object(s.v)(e[t],["point","line"])}));return e}function d(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Object(r.F)(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Object(r.F)(t.point)?t.point:{}:void 0}function f(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class b{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(Object(c.a)(e)){const{mark:n,encoding:i}=e,r=Object(o.x)(n)?n:{type:n};switch(r.type){case"line":case"rule":case"trail":return!!d(r,t[r.type],i);case"area":return!!d(r,t[r.type],i)||!!f(r,t[r.type])}}return!1}run(e,t,n){const{config:r}=t,{selection:c,projection:b,encoding:g,mark:p}=e,m=Object(i.a)(e,["selection","projection","encoding","mark"]),h=Object(o.x)(p)?p:{type:p},O=d(h,r[h.type],g),j="area"===h.type&&f(h,r[h.type]),v=[Object.assign(Object.assign({},c?{selection:c}:{}),{mark:u(Object.assign(Object.assign({},h),"area"===h.type?{opacity:.7}:{})),encoding:Object(s.v)(g,["shape"])})],y=Object(a.a)(h,g);let x=g;if(y){const{fieldChannel:e,offset:t}=y;x=Object.assign(Object.assign({},g),{[e]:Object.assign(Object.assign({},g[e]),t?{stack:t}:{})})}return j&&v.push(Object.assign(Object.assign({},b?{projection:b}:{}),{mark:Object.assign(Object.assign({type:"line"},Object(s.w)(h,["clip","interpolate","tension","tooltip"])),j),encoding:x})),O&&v.push(Object.assign(Object.assign({},b?{projection:b}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Object(s.w)(h,["clip","tooltip"])),O),encoding:x})),n(Object.assign(Object.assign({},m),{layer:v}),Object.assign(Object.assign({},t),{config:l(r)}))}}},1029:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(18),r=n(5),o=n(4),c=n(6),a=n(123),s=n(1);class u{constructor(){this.name="RangeStep"}hasMatchingType(e){var t,n;if(Object(a.a)(e)&&e.encoding)for(const i of r.p){const r=e.encoding[i];if(r&&Object(o.isFieldDef)(r)&&(null===(n=null===(t=r)||void 0===t?void 0:t.scale)||void 0===n?void 0:n.rangeStep))return!0}return!1}run(e){var t,n;const a={};let u=Object.assign({},e.encoding);for(const e of r.p){const l=Object(r.H)(e),d=u[e];if(d&&Object(o.isFieldDef)(d)&&(null===(n=null===(t=d)||void 0===t?void 0:t.scale)||void 0===n?void 0:n.rangeStep)){const{scale:t}=d,n=Object(i.a)(d,["scale"]),r=t,{rangeStep:o}=r,f=Object(i.a)(r,["rangeStep"]);a[l]={step:t.rangeStep},c.e(c.b.RANGE_STEP_DEPRECATED),u=Object.assign(Object.assign({},u),{[e]:Object.assign(Object.assign({},n),Object(s.r)(f).length>0?{scale:f}:{})})}}return Object.assign(Object.assign(Object.assign({},a),e),{encoding:u})}}},1030:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(21),r=n(5),o=n(4),c=n(6),a=n(123);class s{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(Object(a.a)(e)){const{encoding:t,mark:n}=e;if("line"===n)for(const e of r.s){const n=t[Object(r.D)(e)];if(t[e]&&Object(o.isFieldDef)(n)&&!Object(i.d)(n.bin))return!0}}return!1}run(e,t,n){const{encoding:i}=e;return c.e(c.b.lineWithRange(!!i.x2,!!i.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}},1031:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(6),r=n(80),o=n(526),c=n(248),a=n(185);class s extends o.a{constructor(e,t,n,o,a){var s,u,l,d;super(e,"concat",t,n,a,o,e.resolve),"shared"!==(null===(u=null===(s=e.resolve)||void 0===s?void 0:s.axis)||void 0===u?void 0:u.x)&&"shared"!==(null===(d=null===(l=e.resolve)||void 0===l?void 0:l.axis)||void 0===d?void 0:d.y)||i.e(i.b.CONCAT_CANNOT_SHARE_AXIS),this.concatType=Object(r.g)(e)?"vconcat":Object(r.c)(e)?"hconcat":"concat",this.children=this.getChildren(e).map((e,t)=>Object(c.a)(e,this,this.getName("concat_"+t),void 0,o,a))}getChildren(e){return Object(r.g)(e)?e.vconcat:Object(r.c)(e)?e.hconcat:e.concat}parseLayoutSize(){Object(a.b)(this)}parseAxisGroup(){return null}assembleDefaultLayout(){return Object.assign(Object.assign({},"vconcat"===this.concatType?{columns:1}:{}),{bounds:"full",align:"each"})}}},1032:function(e,t,n){"use strict";var i=n(125),r=n(0),o=n(32),c=n(1),a=n(527),s=n(289);const u={has:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t,n)=>{n.clear&&(t.clear=Object(r.H)(n.clear)?Object(i.a)(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>(a.a.has(t)&&t.project.items.forEach(e=>{const i=n.findIndex(n=>n.name===Object(c.H)(`${t.name}_${e.field}`));-1!==i&&n[i].on.push({events:t.clear,update:"null"})}),n),signals:(e,t,n)=>{function i(e,i){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:i})}if("interval"===t.type)t.project.items.forEach(e=>{const t=n.findIndex(t=>t.name===e.signals.visual);if(i(t,"[0, 0]"),-1===t){i(n.findIndex(t=>t.name===e.signals.data),"null")}});else{let e=n.findIndex(e=>e.name===t.name+o.c);i(e,"null"),s.b.has(t)&&i(e=n.findIndex(e=>e.name===t.name+s.a),"false")}return n}};t.a=u},1033:function(e,t,n){"use strict";var i=n(125),r=n(5),o=n(343),c=n(117);const a="_translate_anchor",s="_translate_delta",u={has:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const u=t.name,d=c.a.has(t),f=u+a,{x:b,y:g}=t.project.hasChannel;let p=Object(i.a)(t.translate,"scope");return d||(p=p.map(e=>(e.between[0].markname=u+o.a,e))),n.push({name:f,value:{},on:[{events:p.map(e=>e.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==b?", extent_x: "+(d?Object(c.b)(e,r.z):`slice(${b.signals.visual})`):"")+(void 0!==g?", extent_y: "+(d?Object(c.b)(e,r.B):`slice(${g.signals.visual})`):"")+"}"}]},{name:u+s,value:{},on:[{events:p,update:`{x: ${f}.x - x(unit), y: ${f}.y - y(unit)}`}]}),void 0!==b&&l(e,t,b,"width",n),void 0!==g&&l(e,t,g,"height",n),n}};function l(e,t,n,i,o){var u;const l=t.name,d=l+a,f=l+s,b=n.channel,g=c.a.has(t),p=o.filter(e=>e.name===n.signals[g?"data":"visual"])[0],m=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(b),O=h.get("type"),j=g&&b===r.z?"-":"",v=`${d}.extent_${b}`,y=`${g?"log"===O?"panLog":"pow"===O?"panPow":"panLinear":"panLinear"}(${v}, ${`${j}${f}.${b} / `+(g?`${m}`:`span(${v})`)}`+(g&&"pow"===O?`, ${u=h.get("exponent"),null!=u?u:1}`:"")+")";p.on.push({events:{signal:f},update:g?y:`clampRange(${y}, 0, ${m})`})}t.a=u},1034:function(e,t,n){"use strict";var i=n(125),r=n(0),o=n(5),c=n(343),a=n(117);const s="_zoom_anchor",u="_zoom_delta",l={has:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const l=t.name,f=a.a.has(t),b=l+u,{x:g,y:p}=t.project.hasChannel,m=Object(r.Y)(e.scaleName(o.z)),h=Object(r.Y)(e.scaleName(o.B));let O=Object(i.a)(t.zoom,"scope");return f||(O=O.map(e=>(e.markname=l+c.a,e))),n.push({name:l+s,on:[{events:O,update:f?"{"+[m?`x: invert(${m}, x(unit))`:"",h?`y: invert(${h}, y(unit))`:""].filter(e=>!!e).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:b,on:[{events:O,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==g&&d(e,t,g,"width",n),void 0!==p&&d(e,t,p,"height",n),n}};function d(e,t,n,i,r){var o;const c=t.name,l=n.channel,d=a.a.has(t),f=r.filter(e=>e.name===n.signals[d?"data":"visual"])[0],b=e.getSizeSignalRef(i).signal,g=e.getScaleComponent(l),p=g.get("type"),m=d?Object(a.b)(e,l):f.name,h=c+u,O=`${d?"log"===p?"zoomLog":"pow"===p?"zoomPow":"zoomLinear":"zoomLinear"}(${m}, ${`${c}${s}.${l}`}, ${h}`+(d&&"pow"===p?`, ${o=g.get("exponent"),null!=o?o:1}`:"")+")";f.on.push({events:{signal:h},update:d?O:`clampRange(${O}, 0, ${b})`})}t.a=l},1035:function(e,t,n){"use strict";var i=n(32);const r={signals:n(531).b,modifyExpr:(e,t)=>{return t.name+i.c+", "+("global"===t.resolve?"true":`{unit: ${Object(i.g)(e)}}`)}};t.a=r},1036:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(18),r=n(1),o=n(24),c=n(20);function a(e){return Object(c.e)(e)||Object(c.c)(e)||Object(c.f)(e)?function(e){return e.children.reduce((e,t)=>e.concat(t.assembleProjections()),s(e))}(e):s(e)}function s(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:c}=n,a=Object(i.a)(n,["name"]);if(t.data){const n={signal:`[${t.size.map(e=>e.signal).join(", ")}]`},i=t.data.reduce((t,n)=>{const i=Object(o.isSignalRef)(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return Object(r.c)(t,i)||t.push(i),t},[]);if(i.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:c,size:n,fit:{signal:i.length>1?`[${i.join(", ")}]`:i[0]}},a)]}return[Object.assign(Object.assign({name:c},{translate:{signal:"[width / 2, height / 2]"}}),a)]}},1037:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n(0),r=n(5),o=n(33),c=n(1038),a=n(45),s=n(1),u=n(20),l=n(656);function d(e){e.component.projection=Object(u.g)(e)?function(e){var t;if(e.hasProjection){const n=e.specifiedProjection,i=!(n&&(null!=n.scale||null!=n.translate)),c=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?function(e){const t=[];for(const n of[[r.k,r.i],[r.l,r.j]])(e.channelHasField(n[0])||e.channelHasField(n[1]))&&t.push({signal:e.getName(`geojson_${t.length}`)});e.channelHasField(r.t)&&e.fieldDef(r.t).type===a.a&&t.push({signal:e.getName(`geojson_${t.length}`)});0===t.length&&t.push(e.requestDataName(o.a));return t}(e):void 0;return new l.a(e.projectionName(!0),Object.assign(Object.assign({},null!=(t=e.config.projection)?t:{}),null!=n?n:{}),c,s)}return}(e):function(e){if(0===e.children.length)return;let t;e.children.forEach(e=>d(e));const n=Object(s.h)(e.children,e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=Object(s.h)(c.a,n=>!Object(i.v)(e.explicit,n)&&!Object(i.v)(t.explicit,n)||!(!Object(i.v)(e.explicit,n)||!Object(i.v)(t.explicit,n)||Object(s.C)(e.get(n))!==Object(s.C)(t.get(n))));if(Object(s.C)(e.size)===Object(s.C)(t.size)){if(n)return e;if(Object(s.C)(e.explicit)===Object(s.C)({}))return t;if(Object(s.C)(t.explicit)===Object(s.C)({}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0});if(t&&n){const n=e.projectionName(!0),i=new l.a(n,t.specifiedProjection,t.size,Object(s.f)(t.data));return e.children.forEach(e=>{const t=e.component.projection;t&&(t.isFit&&i.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}),i}return}(e)}},1038:function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"]},1039:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(18),r=n(1),o=n(24),c=n(20),a=n(99),s=n(137);function u(e){return Object(c.e)(e)||Object(c.c)(e)||Object(c.f)(e)?e.children.reduce((e,t)=>e.concat(u(t)),l(e)):l(e)}function l(e){return Object(r.r)(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const c=r.combine(),{name:u,type:l,selectionExtent:d,domains:f,range:b,reverse:g}=c,p=Object(i.a)(c,["name","type","selectionExtent","domains","range","reverse"]),m=function(e,t,n){if(("x"===n||"y"===n)&&Object(o.isVgRangeStep)(e))return{step:{signal:t+"_step"}};return e}(c.range,u,n);let h;d&&(h=Object(a.d)(e,d));const O=Object(s.a)(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:u,type:l},O?{domain:O}:{}),h?{domainRaw:h}:{}),{range:m}),void 0!==g?{reverse:g}:{}),p)),t},[])}},104:function(e,t,n){"use strict";n.d(t,"g",function(){return c}),n.d(t,"c",function(){return a}),n.d(t,"f",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return h}),n.d(t,"h",function(){return O});var i=n(0),r=n(4),o=n(50);function c(e){var t;return null===(t=e)||void 0===t?void 0:t.selection}function a(e){return e&&!!e.field&&void 0!==e.equal}function s(e){return e&&!!e.field&&void 0!==e.lt}function u(e){return e&&!!e.field&&void 0!==e.lte}function l(e){return e&&!!e.field&&void 0!==e.gt}function d(e){return e&&!!e.field&&void 0!==e.gte}function f(e){return!!(e&&e.field&&Object(i.A)(e.range)&&2===e.range.length)}function b(e){return e&&!!e.field&&(Object(i.A)(e.oneOf)||Object(i.A)(e.in))}function g(e){return b(e)||a(e)||f(e)||s(e)||l(e)||u(e)||d(e)}function p(e,t){return Object(r.valueExpr)(e,{timeUnit:t,time:!0})}function m(e,t=!0){var n;const{field:i}=e,c=null===(n=Object(o.e)(e.timeUnit))||void 0===n?void 0:n.unit,g=c?"time("+Object(o.a)(c,i)+")":Object(r.vgField)(e,{expr:"datum"});if(a(e))return g+"==="+p(e.equal,c);if(s(e)){return`${g}<${p(e.lt,c)}`}if(l(e)){return`${g}>${p(e.gt,c)}`}if(u(e)){return`${g}<=${p(e.lte,c)}`}if(d(e)){return`${g}>=${p(e.gte,c)}`}if(b(e))return`indexof([${function(e,t){return e.map(e=>p(e,t))}(e.oneOf,c).join(",")}], ${g}) !== -1`;if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return h(g,e.valid);if(f(e)){const n=e.range[0],i=e.range[1];if(null!==n&&null!==i&&t)return"inrange("+g+", ["+p(n,c)+", "+p(i,c)+"])";const r=[];return null!==n&&r.push(`${g} >= ${p(n,c)}`),null!==i&&r.push(`${g} <= ${p(i,c)}`),r.length>0?r.join(" && "):"true"}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function h(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function O(e){var t;return g(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=Object(o.e)(e.timeUnit))||void 0===t?void 0:t.unit}):e}},1040:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n(5),r=n(4),o=n(14),c=n(13),a=n(45),s=n(1),u=n(20),l=n(252),d=n(31),f=n(658),b=n(137),g=n(659),p=n(1042);function m(e,{ignoreRange:t}={}){h(e),Object(b.c)(e);for(const t of c.a)Object(g.a)(e,t);t||Object(g.b)(e)}function h(e){Object(u.g)(e)?e.component.scales=function(e){const{encoding:t,mark:n}=e;return i.r.reduce((c,s)=>{let u,l;const d=t[s];if(Object(r.isFieldDef)(d)&&n===o.f&&s===i.t&&d.type===a.a)return c;if(Object(r.isFieldDef)(d)?(u=d,l=d.scale):Object(r.hasConditionalFieldDef)(d)&&(u=d.condition,l=d.condition.scale),u&&null!==l&&!1!==l){l=null!=l?l:{};const t=Object(p.a)(l,s,u,n);c[s]=new f.a(e.scaleName(s+"",!0),{value:t,explicit:l.type===t})}return c},{})}(e):e.component.scales=function(e){const t=e.component.scales={},n={},i=e.component.resolve;for(const t of e.children)h(t),Object(s.r)(t.component.scales).forEach(r=>{var o;if(i.scale[r]=null!=(o=i.scale[r])?o:Object(l.a)(r,e),"shared"===i.scale[r]){const e=n[r],o=t.component.scales[r].getWithExplicit("type");e?Object(c.n)(e.value,o.value)?n[r]=Object(d.e)(e,o,"type","scale",O):(i.scale[r]="independent",delete n[r]):n[r]=o}});for(const i of Object(s.r)(n)){const r=e.scaleName(i,!0),o=n[i];t[i]=new f.a(r,o);for(const t of e.children){const e=t.component.scales[i];e&&(t.renameScale(e.get("name"),r),e.merged=!0)}}return t}(e)}const O=Object(d.f)((e,t)=>Object(c.o)(e)-Object(c.o)(t))},1041:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n(0),r=n(21),o=n(5),c=n(75),a=n(6),s=n(13),u=n(76),l=n(1),d=n(24),f=n(112),b=n(156),g=n(31);const p=["range","scheme"];function m(e){return"x"===e?"width":"y"===e?"height":void 0}function h(e){const t=e.component.scales;o.r.forEach(n=>{const r=t[n];if(!r)return;const f=function(e,t){const n=t.specifiedScales[e],{size:r}=t,f=t.getScaleComponent(e).get("type");for(const t of p)if(void 0!==n[t]){const i=Object(s.q)(f,t),r=Object(s.c)(e,t);if(i)if(r)a.e(r);else switch(t){case"range":return Object(g.c)(n[t]);case"scheme":return Object(g.c)(j(n[t]))}else a.e(a.b.scalePropertyNotWorkWithScaleType(f,t,e))}if(e===o.z||e===o.B){const t=e===o.z?"width":"height",n=r[t];if(Object(u.d)(n)){if(Object(s.g)(f))return Object(g.c)({step:n.step});a.e(a.b.stepDropped(t))}}return Object(g.d)(function(e,t){const{size:n,config:r,mark:f}=t,g=t.getSignalName.bind(t),{type:p}=t.fieldDef(e),h=t.getScaleComponent(e).get("type"),{domain:j,domainMid:x}=t.specifiedScales[e];switch(e){case o.z:case o.B:{if(l.c(["point","band"],h))if(e!==o.z||n.width){if(e===o.B&&!n.height){const e=Object(c.c)(r.view,"height");if(Object(u.d)(e))return e}}else{const e=Object(c.c)(r.view,"width");if(Object(u.d)(e))return e}const i=m(e),a=t.getName(i);return e===o.B&&Object(s.f)(h)?[b.a.fromName(g,a),0]:[0,b.a.fromName(g,a)]}case o.u:{const o=t.component.scales[e].get("zero"),c=function(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(a.b.incompatibleChannel("size",e))}(f,o,r),u=function(e,t,n,r){const o={x:O(n,"x"),y:O(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=y(t,o,r.view);return Object(i.E)(e)?e-1:new b.a(()=>`${e.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=y(t,o,r.view);return Object(i.E)(e)?Math.pow(v*e,2):new b.a(()=>`pow(${v} * ${e.signal}, 2)`)}}throw new Error(a.b.incompatibleChannel("size",e))}(f,n,t,r);return Object(s.i)(h)?function(e,t,n){const i=()=>{const i=Object(d.isSignalRef)(t)?t.signal:t,r=`(${i} - ${e}) / (${n} - 1)`;return`sequence(${e}, ${t} + ${r}, ${r})`};return Object(d.isSignalRef)(t)?new b.a(i):{signal:i()}}(c,u,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&Object(i.A)(n)?n.length+1:(a.e(a.b.domainRequiredForThresholdScale(r)),3)}}(h,r,j,e)):[c,u]}case o.y:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case o.w:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case o.t:return"symbol";case o.b:case o.f:case o.v:return"ordinal"===h?"nominal"===p?"category":"ordinal":void 0!==x?"diverging":"rect"===f||"geoshape"===f?"heatmap":"ramp";case o.o:case o.g:case o.x:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}(e,t))}(n,e);r.setWithExplicit("range",f)})}function O(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Object(r.e)(n.bin)){const i=Object(f.b)(e,n.field,n.bin),r=m(t),o=e.getName(r);return new b.a(()=>{const t=e.getSignalName(i),n=`(${t}.stop - ${t}.start) / ${t}.step`;return`${e.getSignalName(o)} / (${n})`})}}function j(e){return Object(s.k)(e)?Object.assign({scheme:e.name},l.v(e,["name"])):{scheme:e}}const v=.95;function y(e,t,n){const i=Object(u.d)(e.width)?e.width.step:Object(c.d)(n,"width"),r=Object(u.d)(e.height)?e.height.step:Object(c.d)(n,"height");return t.x||t.y?new b.a(()=>{return`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`}):Math.min(i,r)}},1042:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(21),r=n(5),o=n(6),c=n(13),a=n(1),s=n(50);function u(e,t,n,u){const l=function(e,t,n){switch(t.type){case"nominal":case"ordinal":return Object(r.J)(e)||"discrete"===Object(r.P)(e)?("shape"===e&&"ordinal"===t.type&&o.e(o.b.discreteChannelCannotEncode(e,"ordinal")),"ordinal"):a.c(["x","y"],e)&&a.c(["rect","bar","image","rule"],n)?"band":"point";case"temporal":return Object(r.J)(e)?"time":"discrete"===Object(r.P)(e)?(o.e(o.b.discreteChannelCannotEncode(e,"temporal")),"ordinal"):t.timeUnit&&Object(s.e)(t.timeUnit).utc?"utc":"time";case"quantitative":return Object(r.J)(e)?Object(i.e)(t.bin)?"bin-ordinal":"linear":"discrete"===Object(r.P)(e)?(o.e(o.b.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(o.b.invalidFieldType(t.type))}(t,n,u),{type:d}=e;return Object(r.M)(t)?void 0!==d?Object(c.d)(t,d)?Object(c.p)(d,n.type)?d:(o.e(o.b.scaleTypeNotWorkWithFieldDef(d,l)),l):(o.e(o.b.scaleTypeNotWorkWithChannel(t,d,l)),l):l:null}},1043:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(31);class r extends i.a{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}},1044:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(4),r=n(54),o=n(543),c=n(211);function a(e,t){const{row:n,column:a}=t;if(n&&a){let t=null;for(const s of[n,a])if(Object(r.e)(s.sort)){const{field:n,op:a=r.a}=s.sort;e=t=new c.a(e,{joinaggregate:[{op:a,field:n,as:Object(o.b)(s,s.sort,{forAs:!0})}],groupby:[Object(i.vgField)(s)]})}return t}return null}},1045:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(5),r=n(4),o=n(1),c=n(249),a=n(252),s=n(106),u=n(0);function l(e){for(const t of i.e)d(e,t);b(e,"x"),b(e,"y")}function d(e,t){var n;if(e.channelHasField(t)){const i=e.facet[t],c=Object(s.c)("title",null,e.config,t);let a=Object(r.title)(i,e.config,{allowDisabling:!0,includeDefault:void 0===c||!!c});e.child.component.layoutHeaders[t].title&&(a=Object(u.A)(a)?a.join(", "):a,a+=" / "+e.child.component.layoutHeaders[t].title,e.child.component.layoutHeaders[t].title=null);const l=Object(s.c)("labelOrient",i,e.config,t),d=null!=(n=i.header)?n:{},b=Object(o.k)(d.labels,!0),g=Object(o.c)(["bottom","right"],l)?"footer":"header";e.component.layoutHeaders[t]={title:a,facetFieldDef:i,[g]:"facet"===t?[]:[f(e,t,b)]}}}function f(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function b(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:o,resolve:s}=e.component;if(s.axis[t]=Object(a.b)(s,t),"shared"===s.axis[t]){const a="x"===t?"column":"row",s=o[a];for(const o of i.component.axes[t]){const t="top"===(r=o.get("orient"))||"left"===r?"header":"footer";s[t]=null!=(n=s[t])?n:[f(e,a,!1)];const i=Object(c.b)(o,"main",e.config,{header:!0});s[t][0].axes.push(i),o.mainExtracted=!0}}}var r}},1046:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n(6),r=n(80),o=n(1),c=n(249),a=n(552),s=n(183),u=n(251),l=n(185),d=n(534),f=n(20),b=n(99),g=n(553);class p extends f.a{constructor(e,t,n,o,c,a){super(e,"layer",t,n,a,c,e.resolve,e.view);const s=Object.assign(Object.assign(Object.assign({},o),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});this.children=e.layer.map((e,t)=>{if(Object(r.d)(e))return new p(e,this,this.getName("layer_"+t),s,c,a);if(Object(r.f)(e))return new g.a(e,this,this.getName("layer_"+t),s,c,a);throw new Error(i.b.invalidSpec(e))})}parseData(){this.component.data=Object(s.b)(this);for(const e of this.children)e.parseData()}parseLayoutSize(){Object(l.c)(this)}parseSelections(){this.component.selection={};for(const e of this.children)e.parseSelections(),Object(o.r)(e.component.selection).forEach(t=>{this.component.selection[t]=e.component.selection[t]})}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){Object(a.a)(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleSignals()),Object(c.c)(this))}assembleLayoutSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleLayoutSignals()),Object(u.a)(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle())return e}assembleLayout(){return null}assembleMarks(){return Object(b.c)(this,this.children.flatMap(e=>e.assembleMarks()))}assembleLegends(){return this.children.reduce((e,t)=>e.concat(t.assembleLegends()),Object(d.a)(this))}}},1047:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(4),r=n(13),o=n(1),c=n(16),a=n(50);function s(e,t,n){var s,u;const l=null!=(s=e.fieldDef(t))?s:"x"===t?e.fieldDef("x2"):"y"===t?e.fieldDef("y2"):void 0,d=e.axis(t);let f={};if(Object(i.isTimeFormatFieldDef)(l)){const n=e.getScaleComponent(t).get("type")===r.b.UTC,i=Object(c.n)("datum.value",null===(u=Object(a.e)(l.timeUnit))||void 0===u?void 0:u.unit,d.format,null,n);i&&(f.text={signal:i})}return f=Object.assign(Object.assign({},f),n),0===Object(o.r)(f).length?void 0:f}},1048:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(5),r=n(4),o=n(6),c=n(76);function a({encoding:e,size:t}){for(const n of i.p){const a=Object(i.H)(n),s=Object(r.getFieldDef)(e[n]);Object(c.d)(t[a])&&s&&Object(r.isContinuous)(s)&&(delete t[a],o.e(o.b.stepDropped(a)))}return t}},1049:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n(21),r=n(4),o=n(46),c=n(6),a=n(14),s=n(45),u=n(1),l=n(16);function d(e,t,n,{graticule:d}){var f,b,g;const p=Object(a.x)(e)?Object.assign({},e):{type:e},m=null!=(f=p.orient)?f:Object(l.d)("orient",p,n);if(p.orient=function(e,t,n){switch(e){case a.i:case a.d:case a.m:case a.n:case a.k:case a.g:return}const{x:o,y:c,x2:u,y2:l}=t;switch(e){case a.b:if(Object(r.isFieldDef)(o)&&(Object(i.d)(o.bin)||Object(r.isFieldDef)(c)&&c.aggregate&&!o.aggregate))return"vertical";if(Object(r.isFieldDef)(c)&&(Object(i.d)(c.bin)||Object(r.isFieldDef)(o)&&o.aggregate&&!c.aggregate))return"horizontal";if(l||u){if(n)return n;if(!u&&Object(r.isFieldDef)(o)&&o.type===s.d&&!Object(i.e)(o.bin))return"horizontal";if(!l&&Object(r.isFieldDef)(c)&&c.type===s.d&&!Object(i.e)(c.bin))return"vertical"}case a.l:if(u&&l)return;case a.a:if(l)return Object(r.isFieldDef)(c)&&Object(i.d)(c.bin)?"horizontal":"vertical";if(u)return Object(r.isFieldDef)(o)&&Object(i.d)(o.bin)?"vertical":"horizontal";if(e===a.l){if(o&&!c)return"vertical";if(c&&!o)return"horizontal"}case a.h:case a.o:{const t=Object(r.isFieldDef)(o)&&Object(r.isContinuous)(o),i=Object(r.isFieldDef)(c)&&Object(r.isContinuous)(c);if(t&&!i)return"tick"!==e?"horizontal":"vertical";if(!t&&i)return"tick"!==e?"vertical":"horizontal";if(t&&i){const t=o,i=c,r=t.type===s.e,a=i.type===s.e;return r&&!a?"tick"!==e?"vertical":"horizontal":!r&&a?"tick"!==e?"horizontal":"vertical":!t.aggregate&&i.aggregate?"tick"!==e?"vertical":"horizontal":t.aggregate&&!i.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(p.type,t,m),void 0!==m&&m!==p.orient&&c.e(c.b.orientOverridden(p.orient,m)),"bar"===p.type&&p.orient){const e=null!=(b=p.cornerRadiusEnd)?b:Object(l.d)("cornerRadiusEnd",p,n);if(void 0!==e){const t=a.c[p.orient];for(const n of t)p[n]=e;void 0!==p.cornerRadiusEnd&&delete p.cornerRadiusEnd}}return void 0===Object(u.k)(p.opacity,Object(l.d)("opacity",p,n))&&(p.opacity=function(e,t){if(Object(u.c)([a.i,a.o,a.d,a.m],e)&&!Object(o.e)(t))return.7;return}(p.type,t)),void 0===p.filled&&(p.filled=!d&&function(e,t){const n=Object(l.d)("filled",e,t),i=e.type;return Object(u.k)(n,i!==a.i&&i!==a.h&&i!==a.l)}(p,n)),void 0===(null!=(g=p.cursor)?g:Object(l.d)("cursor",p,n))&&(p.cursor=function(e,t,n){if(t.href||e.href||Object(l.d)("href",e,n))return"pointer";return e.cursor}(p,t,n)),p}},105:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return b}),n.d(t,"f",function(){return g}),n.d(t,"g",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return O});var i=n(18),r=n(0),o=n(4),c=n(46),a=n(6),s=n(14),u=n(1),l=n(24);function d(e){const{tooltip:t}=e,n=Object(i.a)(e,["tooltip"]);if(!t)return{filteredEncoding:e};let o,c;return Object(r.A)(t)?(t.forEach(e=>{e.aggregate?(o||(o=[]),o.push(e)):(c||(c=[]),c.push(e))}),o&&(n.tooltip=o)):t.aggregate?n.tooltip=t:c=t,Object(r.A)(c)&&1===c.length&&(c=c[0]),{customTooltipWithoutAggregatedField:c,filteredEncoding:n}}function f(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...e.map(({fieldPrefix:e,titlePrefix:n})=>{const r=i?` of ${t.field}`:"";return{field:e+t.field,type:t.type,title:Object(l.isSignalRef)(n)?{signal:n+`"${escape(r)}"`}:n+r}}),...Object(c.c)(n)]}}function b(e){const{axis:t,title:n,field:i}=e;return t&&void 0!==t.title?void 0:Object(u.k)(n,i)}function g(e,t,n,i,o){const{scale:c,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:d,extraEncoding:f={}})=>{const g=b(n);return p(e,s,o,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==g?{title:g}:{}),void 0!==c?{scale:c}:{}),void 0!==a?{axis:a}:{})},Object(r.H)(d)?{[t+"2"]:{field:d+"_"+n.field}}:{}),i),f)})}}function p(e,t,n,i){const{clip:o,color:c,opacity:a}=e,u=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),o?{clip:o}:{}),c?{color:c}:{}),a?{opacity:a}:{}),Object(s.x)(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),Object(r.B)(e[t])?{}:e[t])})]:[]}function m(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[r],c=i[r+"2"],a=i[r+"Error"],s=i[r+"Error2"];return{continuousAxisChannelDef:h(o,n),continuousAxisChannelDef2:h(c,n),continuousAxisChannelDefError:h(a,n),continuousAxisChannelDefError2:h(s,n),continuousAxis:r}}function h(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=Object(i.a)(e,["aggregate"]);return n!==t&&a.e(a.b.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function O(e,t){const{mark:n,encoding:i}=e;if(Object(o.isFieldDef)(i.x)&&Object(o.isContinuous)(i.x)){if(Object(o.isFieldDef)(i.y)&&Object(o.isContinuous)(i.y)){if(void 0===i.x.aggregate&&i.y.aggregate===t)return"vertical";if(void 0===i.y.aggregate&&i.x.aggregate===t)return"horizontal";if(i.x.aggregate===t&&i.y.aggregate===t)throw new Error("Both x and y cannot have aggregate");return Object(s.x)(n)&&n.orient?n.orient:"vertical"}return"horizontal"}if(Object(o.isFieldDef)(i.y)&&Object(o.isContinuous)(i.y))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}},1050:function(e,t,n){"use strict";n.d(t,"a",function(){return w});var i=n(0),r=n(4),o=n(33),c=n(46),a=n(14),s=n(54),u=n(1),l=n(24),d=n(16),f=n(1051),b=n(1052),g=n(1053),p=n(1054),m=n(660),h=n(562),O=n(1055),j=n(1056),v=n(1057),y=n(1058);const x={area:f.a,bar:b.a,circle:h.a,geoshape:g.a,image:p.a,line:m.a,point:h.b,rect:O.a,rule:j.a,square:h.c,text:v.a,tick:y.a,trail:m.b};function w(e){return Object(u.c)([a.h,a.a,a.p],e.mark)?function(e){const t=Object(c.g)(e.mark,e.encoding),n=F(e,{fromPrefix:t.length>0?k:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:k+e.requestDataName(o.a),data:e.requestDataName(o.a),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):Object(u.c)([a.b],e.mark)?function(e){var t,n;const i=l.VG_CORNERRADIUS_CHANNELS.some(t=>e.markDef[t]||Object(d.d)(t,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&i){const[i]=F(e,{fromPrefix:S}),c=e.scaleName(e.stack.fieldChannel),a=(t={})=>e.vgField(e.stack.fieldChannel,t),s=(e,t)=>{const n=[a({prefix:"min",suffix:"start",expr:t}),a({prefix:"max",suffix:"start",expr:t}),a({prefix:"min",suffix:"end",expr:t}),a({prefix:"max",suffix:"end",expr:t})];return`${e}(${n.map(e=>`scale('${c}',${e})`).join(",")})`};let f,b;"x"===e.stack.fieldChannel?(f=Object.assign(Object.assign({},Object(u.w)(i.encode.update,["y","yc","y2","height",...l.VG_CORNERRADIUS_CHANNELS])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),b={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},i.encode.update=Object.assign(Object.assign({},Object(u.v)(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(f=Object.assign(Object.assign({},Object(u.w)(i.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),b={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},i.encode.update=Object.assign(Object.assign({},Object(u.v)(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const t of l.VG_CORNERRADIUS_CHANNELS){const n=Object(d.d)(t,e.markDef,e.config);i.encode.update[t]?(f[t]=i.encode.update[t],delete i.encode.update[t]):n&&(f[t]={value:n}),n&&(i.encode.update[t]={value:0})}const g=e.fieldDef(e.stack.groupbyChannel),p=Object(r.vgField)(g)?[Object(r.vgField)(g)]:[];((null===(t=g)||void 0===t?void 0:t.bin)||(null===(n=g)||void 0===n?void 0:n.timeUnit))&&p.push(Object(r.vgField)(g,{binSuffix:"end"}));const m=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];return(f=m.reduce((t,n)=>{if(i.encode.update[n])return Object.assign(Object.assign({},t),{[n]:i.encode.update[n]});{const i=Object(d.d)(n,e.markDef,e.config);return void 0!==i?Object.assign(Object.assign({},t),{[n]:{value:i}}):t}},f)).stroke&&(f.strokeForeground={value:!0},f.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(o.a),name:S+e.requestDataName(o.a),groupby:p,aggregate:{fields:[a({suffix:"start"}),a({suffix:"start"}),a({suffix:"end"}),a({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:f},marks:[{type:"group",encode:{update:b},marks:[i]}]}]}return F(e)}(e):F(e)}const k="faceted_path_";const S="stack_group_";function F(e,t={fromPrefix:""}){const n=e.mark,l=Object(u.k)(e.markDef.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),f=Object(d.g)(e.markDef),b=e.encoding.key,g=function(e){const{encoding:t,stack:n,mark:o,markDef:l,config:f}=e,b=t.order;if(!(!Object(i.A)(b)&&Object(r.isValueDef)(b)&&Object(u.p)(b.value)||!b&&Object(u.p)(l.order)||Object(u.p)(Object(d.d)("order",l,f)))){if((Object(i.A)(b)||Object(r.isFieldDef)(b))&&!n)return Object(d.m)(b,{expr:"datum"});if(Object(a.y)(o)){const n="horizontal"===l.orient?"y":"x",o=t[n];if(Object(r.isFieldDef)(o)){const t=o.sort;if(Object(i.A)(t))return{field:Object(r.vgField)(o,{prefix:n,suffix:"sort_index",expr:"datum"})};if(Object(s.e)(t))return{field:Object(r.vgField)({aggregate:Object(c.e)(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})};if(Object(s.d)(t)){const n=e.fieldDef(t.encoding);return{field:Object(r.vgField)(n,{expr:"datum"}),order:t.order}}return{field:Object(r.vgField)(o,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}}}(e),p=function(e){if(!e.component.selection)return null;const t=Object(u.r)(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=Object(u.r)(i.component.selection).length,i=i.parent;return n?{interactive:t>0}:null}(e),m=x[n].postEncodingTransform?x[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:x[n].vgMark},l?{clip:!0}:{}),f?{style:f}:{}),b?{key:b.field}:{}),g?{sort:g}:{}),p||{}),{from:{data:t.fromPrefix+e.requestDataName(o.a)},encode:{update:x[n].encodeEntry(e)}}),m?{transform:m}:{})]}},1051:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(26);const r={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore"})),i.e("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),i.e("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),i.c(e))}},1052:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(26);const r={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),i.g(e,"x","bar")),i.g(e,"y","bar"))}},1053:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(4),r=n(45),o=n(26);const c={vgMark:"shape",encodeEntry:e=>Object.assign({},o.a(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Object(i.isFieldDef)(n)&&n.type===r.a?{field:Object(i.vgField)(n,{expr:"datum"})}:{})]}}},1054:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(26);const r={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore"})),i.g(e,"x","image")),i.g(e,"y","image")),i.h(e,"url"))}},1055:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(26);const r={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),i.g(e,"x","rect")),i.g(e,"y","rect"))}},1056:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(26);const r={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),i.e("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),i.e("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),i.d("size",e,{vgChannel:"strokeWidth"})):{}}}},1057:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(16),r=n(26);const o={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r.a(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore"})),r.f("x",e,{defaultPos:"mid"})),r.f("y",e,{defaultPos:"mid"})),r.h(e)),r.d("size",e,{vgChannel:"fontSize"})),r.j("align",function(e,t,n){var r;if(void 0===(null!==(r=e.align)&&void 0!==r?r:Object(i.d)("align",e,n)))return"center";return}(e.markDef,0,t))),r.j("baseline",function(e,t,n){var r;if(void 0===(null!==(r=e.baseline)&&void 0!==r?r:Object(i.d)("baseline",e,n)))return"middle";return}(e.markDef,0,t)))}}},1058:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(0),r=n(75),o=n(1),c=n(24),a=n(16),s=n(26);const u={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",c="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s.a(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),s.f("x",e,{defaultPos:"mid",vgChannel:"xc"})),s.f("y",e,{defaultPos:"mid",vgChannel:"yc"})),s.d("size",e,{defaultValue:l(e),vgChannel:r})),{[c]:{value:Object(o.k)(n.thickness,t.tick.thickness)}})}};function l(e){const{config:t,markDef:n}=e,{orient:s}=n,u="horizontal"===s?"width":"height",l=e.getScaleComponent("horizontal"===s?"x":"y"),d=Object(o.k)(n[u],n.size,Object(a.d)("size",n,t,{vgChannel:u}),t.tick.bandSize);if(void 0!==d)return d;{const e=l?l.get("range"):void 0;return e&&Object(c.isVgRangeStep)(e)&&Object(i.E)(e.step)?3*e.step/4:3*Object(r.d)(t.view,u)/4}}},1059:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(0),r=n(6),o=n(526),c=n(248),a=n(185);class s extends o.a{constructor(e,t,n,i,o){super(e,"repeat",t,n,o,i,e.resolve),e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&r.e(r.b.REPEAT_CANNOT_SHARE_AXIS),this.repeat=e.repeat,this.children=this._initChildren(e,this.repeat,i,o)}_initChildren(e,t,n,r){const o=[],a=!Object(i.A)(t)&&t.row||[n?n.row:null],s=!Object(i.A)(t)&&t.column||[n?n.column:null],u=Object(i.A)(t)&&t||[n?n.repeat:null];for(const t of u)for(const n of a)for(const i of s){const a=(t?`__repeat_repeat_${t}`:"")+(n?`__repeat_row_${n}`:"")+(i?`__repeat_column_${i}`:""),s={repeat:t,row:n,column:i};o.push(Object(c.a)(e.spec,this,this.getName("child"+a),void 0,s,r))}return o}parseLayoutSize(){Object(a.d)(this)}assembleDefaultLayout(){const{repeat:e}=this,t=Object(i.A)(e)?void 0:e.column?e.column.length:1;return Object.assign(Object.assign({},t?{columns:t}:{}),{bounds:"full",align:"all"})}}},106:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var i=n(1);function r(e,t){return Object(i.c)(["top","bottom"],t)?"column":Object(i.c)(["left","right"],t)?"row":"row"===e?"row":"column"}function o(e,t,n,r){const o="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return Object(i.k)(t&&t.header?t.header[e]:void 0,o[e],n.header[e])}function c(e,t,n,i){const r={};for(const c of e){const e=o(c,t,n,i);void 0!==e&&(r[c]=e)}return r}},111:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var i=n(4),r=n(104),o=n(54),c=n(1),a=n(19),s=n(532);class u extends a.a{constructor(e,t){super(e),this.transform=t,this._dependentFields=Object(s.a)(this.transform.calculate)}clone(){return new u(null,Object(c.f)(this.transform))}static parseAllForSortIndex(e,t){return t.forEachFieldDef((t,n)=>{if(Object(i.isScaleFieldDef)(t)&&Object(o.b)(t.sort)){const{field:i,timeUnit:o}=t,c=t.sort,a=c.map((e,t)=>`${Object(r.a)({field:i,timeUnit:o,equal:e})} ? ${t} : `).join("")+c.length;e=new u(e,{calculate:a,as:l(t,n,{forAs:!0})})}}),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Object(c.m)(this.transform)}`}}function l(e,t,n){return Object(i.vgField)(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}},112:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return p});var i=n(18),r=n(0),o=n(21),c=n(4),a=n(1),s=n(16),u=n(20),l=n(147),d=n(19);function f(e,t){return`${Object(o.b)(e)}_${t}`}function b(e,t,n){var i;const r=f(null!=(i=Object(c.normalizeBin)(n,void 0))?i:{},t);return e.getName(`${r}_bins`)}function g(e,t,n){let i,s;i=function(e){return"as"in e}(e)?Object(r.H)(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[Object(c.vgField)(e,{forAs:!0}),Object(c.vgField)(e,{binSuffix:"end",forAs:!0})];const u=Object.assign({},Object(c.normalizeBin)(t,void 0)),d=f(u,e.field),{signal:b,extentSignal:g}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,d);if(Object(o.f)(u.extent)){const e=u.extent,t=e.selection;s=Object(l.b)(n.getSelectionComponent(Object(a.H)(t),t),e),delete u.extent}return{key:d,binComponent:Object.assign(Object.assign(Object.assign({bin:u,field:e.field,as:[i]},b?{signal:b}:{}),g?{extentSignal:g}:{}),s?{span:s}:{})}}class p extends d.a{constructor(e,t){super(e),this.bins=t}clone(){return new p(null,Object(a.f)(this.bins))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{if(Object(c.isTypedFieldDef)(n)&&Object(o.e)(n.bin)){const{key:r,binComponent:o}=g(n,n.bin,t);e[r]=Object.assign(Object.assign(Object.assign({},o),e[r]),function(e,t,n,i){var r,o;if(Object(c.binRequiresRange)(t,n)){const a=Object(u.g)(e)&&null!=(o=null!=(r=e.axis(n))?r:e.legend(n))?o:{},l=Object(c.vgField)(t,{expr:"datum"}),d=Object(c.vgField)(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Object(c.vgField)(t,{binSuffix:"range",forAs:!0}),formula:Object(s.b)(l,d,a.format,i)}}return{}}(t,n,i,t.config))}return e},{});return 0===Object(a.r)(n).length?null:new p(e,n)}static makeFromTransform(e,t,n){const{key:i,binComponent:r}=g(t,t.bin,n);return new p(e,{[i]:r})}merge(e,t){for(const n of Object(a.r)(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=Object(a.E)([...this.bins[n].as,...e.bins[n].as],a.m)):this.bins[n]=e.bins[n];for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(Object(a.G)(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(Object(a.G)(this.bins).map(e=>e.field))}hash(){return`Bin ${Object(a.m)(this.bins)}`}assemble(){return Object(a.G)(this.bins).flatMap(e=>{const t=[],[n,...r]=e.as,s=e.bin,{extent:u}=s,l=Object(i.a)(s,["extent"]),d=Object.assign(Object.assign(Object.assign({type:"bin",field:Object(a.z)(e.field),as:n,signal:e.signal},Object(o.f)(u)?{extent:null}:{extent:u}),e.span?{span:{signal:`span(${e.span})`}}:{}),l);!u&&e.extentSignal&&(t.push({type:"extent",field:Object(a.z)(e.field),signal:e.extentSignal}),d.extent={signal:e.extentSignal}),t.push(d);for(const e of r)for(let i=0;i<2;i++)t.push({type:"formula",expr:Object(c.vgField)({field:n[i]},{expr:"datum"}),as:e[i]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t})}}},1143:function(e,t,n){"use strict";n.r(t),n.d(t,"version",function(){return a});var i=n(1021),r=n(488);n.d(t,"normalize",function(){return r.a});var o=n(871);n.d(t,"compile",function(){return o.a});var c=n(873);n.d(t,"extractTransforms",function(){return c.a});const a=i.version},115:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return a});var i=n(0);const r="_vgsid_",o={single:{on:"click",fields:[r],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[r],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function c(e){return!(!e||"legend"!==e&&!e.legend)}function a(e){return c(e)&&Object(i.F)(e)}},117:function(e,t,n){"use strict";n.d(t,"b",function(){return l});var i=n(0),r=n(32),o=n(5),c=n(6),a=n(13),s=n(20);const u={has:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Object(o.M)(r))continue;const s=e.getScaleComponent(r),u=s?s.get("type"):void 0;if(!s||!Object(a.f)(u)){c.e(c.b.SCALE_BINDINGS_CONTINUOUS);continue}const l={selection:t.name,field:i.field};if(s.set("selectionExtent",l,!0),n.push(i),e.repeater&&e.repeater.row===e.repeater.column){e.getScaleComponent(r===o.z?o.B:o.z).set("selectionExtent",l,!0)}}},topLevelSignals:(e,t,n)=>{const o=t.scales.filter(e=>0===n.filter(t=>t.name===e.signals.data).length);if(!e.parent||d(e)||0===o.length)return n;const c=n.filter(e=>e.name===t.name)[0];let a=c.update;if(a.indexOf(r.d)>=0)c.update=`{${o.map(e=>`${Object(i.Y)(e.field)}: ${e.signals.data}`).join(", ")}}`;else{for(const e of o){const t=`${Object(i.Y)(e.field)}: ${e.signals.data}`;a.indexOf(t)<0&&(a=`${a.substring(0,a.length-1)}, ${t}}`)}c.update=a}return n.concat(o.map(e=>({name:e.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!d(e))for(const e of t.scales){const t=n.filter(t=>t.name===e.signals.data)[0];t.push="outer",delete t.value,delete t.update}return n}};function l(e,t){return`domain(${Object(i.Y)(e.scaleName(t))})`}function d(e){var t;return e.parent&&Object(s.e)(e.parent)&&(null!=(t=!e.parent.parent)?t:d(e.parent.parent))}t.a=u},120:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"h",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return O}),n.d(t,"d",function(){return j}),n.d(t,"e",function(){return v}),n.d(t,"j",function(){return y}),n.d(t,"f",function(){return x}),n.d(t,"k",function(){return w}),n.d(t,"g",function(){return k});var i=n(0),r=n(21),o=n(5),c=n(4),a=n(6),s=n(13),u=n(50),l=n(45),d=n(1),f=n(24),b=n(533);function g(e,t){return!Object(s.g)(e)&&!Object(r.e)(t.bin)}function p(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function m(e,t,n,i){if(void 0!==t.labelAngle)return Object(d.u)(t.labelAngle);{const{configValue:t}=Object(b.a)("labelAngle",e.config,n,y(n),e.getScaleComponent(n).get("type"));return void 0!==t?Object(d.u)(t):n===o.z&&Object(d.c)([l.b,l.c],i.type)?270:void 0}}function h(e,t){if(void 0!==e)return e=Object(d.u)(e),"top"===t||"bottom"===t?e<=45||315<=e?"top"===t?"bottom":"top":135<=e&&e<=225?"top"===t?"top":"bottom":"middle":e<=45||315<=e||135<=e&&e<=225?"middle":45<=e&&e<=135?"left"===t?"top":"bottom":"left"===t?"bottom":"top"}function O(e,t){if(void 0!==e)return e=Object(d.u)(e),"top"===t||"bottom"===t?e%180==0?"center":0<e&&e<180?"top"===t?"right":"left":"top"===t?"left":"right":(e+90)%180==0?"center":90<=e&&e<270?"left"===t?"left":"right":"left"===t?"right":"left"}function j(e,t){if("x"===t&&Object(d.c)(["quantitative","temporal"],e.type))return!0}function v(e,t){if("nominal"!==e.type)return"log"!==t||"greedy"}function y(e){switch(e){case o.z:return"bottom";case o.B:return"left"}throw new Error(a.b.INVALID_CHANNEL_FOR_AXIS)}function x({fieldDef:e,scaleType:t,size:n}){var i;if(!Object(s.g)(t)&&"log"!==t&&!Object(d.c)(["month","hours","day","quarter"],null===(i=Object(u.e)(e.timeUnit))||void 0===i?void 0:i.unit))return Object(r.e)(e.bin)?{signal:`ceil(${n.signal}/10)`}:{signal:`ceil(${n.signal}/40)`}}function w(e,t,n){const r=e.values;return Object(i.A)(r)?Object(c.valueArray)(n,r):Object(f.isSignalRef)(r)?r:void 0}function k(e,t){return"rect"===e&&Object(c.isDiscrete)(t)?1:0}},123:function(e,t,n){"use strict";function i(e){return!!e.mark}n.d(t,"a",function(){return i})},13:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return g}),n.d(t,"l",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"f",function(){return k}),n.d(t,"h",function(){return S}),n.d(t,"i",function(){return F}),n.d(t,"e",function(){return D}),n.d(t,"k",function(){return $}),n.d(t,"m",function(){return E}),n.d(t,"j",function(){return C}),n.d(t,"a",function(){return P}),n.d(t,"q",function(){return M}),n.d(t,"c",function(){return L}),n.d(t,"p",function(){return U}),n.d(t,"d",function(){return H});var i,r=n(18),o=n(0),c=n(5),a=n(6),s=n(45),u=n(1);!function(e){e.LINEAR="linear",e.LOG="log",e.POW="pow",e.SQRT="sqrt",e.SYMLOG="symlog",e.TIME="time",e.UTC="utc",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.BIN_ORDINAL="bin-ordinal",e.ORDINAL="ordinal",e.POINT="point",e.BAND="band"}(i||(i={}));const l={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},d=Object(u.r)(l);function f(e,t){const n=l[e],i=l[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}const b={linear:0,log:1,pow:1,sqrt:1,symlog:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function g(e){return b[e]}const p=["linear","log","pow","sqrt","symlog","time","utc"],m=Object(o.cb)(p),h=Object(o.cb)(["linear","log","pow","sqrt","symlog"]);function O(e){return e in h}const j=Object(o.cb)(["quantile","quantize","threshold"]),v=p.concat(["quantile","quantize","threshold"]),y=Object(o.cb)(v),x=Object(o.cb)(["ordinal","bin-ordinal","point","band"]);function w(e){return e in x}function k(e){return e in y}function S(e){return e in m}function F(e){return e in j}const D={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function $(e){return!Object(o.H)(e)&&!!e.name}function E(e){var t;return null===(t=e)||void 0===t?void 0:t.selection}function C(e){return e&&e.unionWith}const N={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:_,domain:z,range:A,scheme:T}=(Object(u.r)(N),N),R=Object(r.a)(N,["type","domain","range","scheme"]),P=Object(u.r)(R);!function(){var e;const t={};for(const n of c.a)for(const i of Object(u.r)(s.f))for(const r of d){const o=q(n,i);H(n,r)&&U(r,i)&&(t[o]=null!=(e=t[o])?e:[],t[o].push(r))}}();function M(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Object(u.c)(["point","band","identity"],e);case"bins":return!Object(u.c)(["point","band","identity","ordinal"],e);case"round":return S(e)||"band"===e||"point"===e;case"padding":return S(e)||Object(u.c)(["point","band"],e);case"paddingOuter":case"align":return Object(u.c)(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return S(e);case"nice":return S(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return k(e)&&!Object(u.c)(["log","time","utc","threshold","quantile"],e)}}function L(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Object(c.J)(e)?void 0:a.b.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function U(e,t){return Object(u.c)([s.c,s.b],t)?void 0===e||w(e):t===s.e?Object(u.c)([i.TIME,i.UTC,void 0],e):t!==s.d||Object(u.c)([i.LOG,i.POW,i.SQRT,i.SYMLOG,i.QUANTILE,i.QUANTIZE,i.THRESHOLD,i.LINEAR,void 0],e)}function H(e,t){switch(e){case c.z:case c.B:return S(t)||Object(u.c)(["band","point"],t);case c.u:case c.y:case c.o:case c.g:case c.x:return S(t)||F(t)||Object(u.c)(["band","point"],t);case c.b:case c.f:case c.v:return"band"!==t;case c.w:return"ordinal"===t||F(t);case c.t:return"ordinal"===t}return!1}function q(e,t){return e+"_"+t}},130:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return l});var i=n(1);const r={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function o(e){return e&&e.condition}const c=["domain","grid","labels","ticks","title"],a={grid:"grid",gridColor:"grid",gridDash:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontWeight:"main",labelLimit:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickColor:"main",tickExtra:"main",tickOffset:"both",tickOpacity:"main",tickRound:"main",ticks:"main",tickSize:"main",title:"main",titleAlign:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",tickWidth:"both",tickCount:"both",values:"both",scale:"both",zindex:"both"},s={orient:1,bandPosition:1,domain:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,translate:1,zindex:1},u=Object.assign(Object.assign({},s),{labelExpr:1,encoding:1});function l(e){return!!u[e]}Object(i.r)(u)},137:function(e,t,n){"use strict";n.d(t,"c",function(){return x}),n.d(t,"b",function(){return D}),n.d(t,"a",function(){return $});var i=n(18),r=n(0),o=n(51),c=n(21),a=n(5),s=n(4),u=n(33),l=n(6),d=n(13),f=n(54),b=n(50),g=n(1),p=n(24),m=n(112),h=n(111),O=n(290),j=n(20),v=n(156),y=n(31);function x(e){Object(j.g)(e)?function(e){const t=e.component.scales;g.r(t).forEach(n=>{const i=function(e,t){const n=e.getScaleComponent(t).get("type"),i=function(e,t,n,i){if("unaggregated"===e){const{valid:e,reason:i}=S(t,n);if(!e)return void l.e(i)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:e}=S(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i}));if("x"===t&&e.channelHasField("x2"))return e.channelHasField("x")?Object(y.e)(w(n,i,e,"x"),w(n,i,e,"x2"),"domain","scale",F):w(n,i,e,"x2");if("y"===t&&e.channelHasField("y2"))return e.channelHasField("y")?Object(y.e)(w(n,i,e,"y"),w(n,i,e,"y2"),"domain","scale",F):w(n,i,e,"y2");return w(n,i,e,t)}(e,n),r=t[n];if(r.setWithExplicit("domains",i),function(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t).bin,o=Object(d.m)(i)&&i,a=Object(c.c)(r)&&Object(c.f)(r.extent)&&r.extent;(o||a)&&n.set("selectionExtent",null!=o?o:a,!0)}(e,n),e.component.data.isFaceted){let t=e;for(;!Object(j.d)(t)&&t.parent;)t=t.parent;const r=t.component.resolve.scale[n];if("shared"===r)for(const e of i.value)Object(p.isDataRefDomain)(e)&&(e.data=O.a+e.data.replace(O.a,""))}})}(e):function(e){for(const t of e.children)x(t);const t=e.component.scales;g.r(t).forEach(n=>{let i,r=null;for(const t of e.children){const e=t.component.scales[n];if(e){i=void 0===i?e.getWithExplicit("domains"):Object(y.e)(i,e.getWithExplicit("domains"),"domains","scale",F);const t=e.get("selectionExtent");r&&t&&r.selection!==t.selection&&l.e("The same selection must be used to override scale domains in a layered view."),r=t}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)})}(e)}function w(e,t,n,i){var l;const p=n.fieldDef(i);if(Object(d.j)(t)){const r=w(e,void 0,n,i);return Object(y.c)([...r.value,t.unionWith])}if(t&&"unaggregated"!==t&&!Object(d.m)(t)){const{type:e}=p,n=null===(l=Object(b.e)(p.timeUnit))||void 0===l?void 0:l.unit;return"temporal"===e||n?Object(y.c)(function(e,t,n){return e.map(e=>({signal:`{data: ${Object(s.valueExpr)(e,{timeUnit:n,type:t})}}`}))}(t,e,n)):Object(y.c)([t])}const O=n.stack;if(O&&i===O.fieldChannel){if("normalize"===O.offset)return Object(y.d)([[0,1]]);const e=n.requestDataName(u.a);return Object(y.d)([{data:e,field:n.vgField(i,{suffix:"start"})},{data:e,field:n.vgField(i,{suffix:"end"})}])}const x=Object(a.M)(i)?function(e,t,n){if(!Object(d.g)(n))return;const i=e.fieldDef(t),r=i.sort;if(Object(f.b)(r))return{op:"min",field:Object(h.b)(i,t),order:"ascending"};const c=null!==e.stack;if(Object(f.e)(r))return k(r,c);if(Object(f.d)(r)){const{encoding:t,order:n}=r,i=e.fieldDef(t),{aggregate:a,field:u}=i;if(Object(o.f)(a)||Object(o.e)(a))return k({field:Object(s.vgField)(i),order:n},c);if(Object(o.d)(a)||!a)return k({op:a,field:u,order:n},c)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(g.c(["ascending",void 0],r))return!0}return}(n,i,e):void 0;if("unaggregated"===t){const e=n.requestDataName(u.a),{field:t}=p;return Object(y.d)([{data:e,field:Object(s.vgField)({field:t,aggregate:"min"})},{data:e,field:Object(s.vgField)({field:t,aggregate:"max"})}])}if(Object(c.e)(p.bin)){if(Object(d.g)(e))return"bin-ordinal"===e?Object(y.d)([]):Object(y.d)([{data:g.o(x)?n.requestDataName(u.a):n.requestDataName(u.b),field:n.vgField(i,Object(s.binRequiresRange)(p,i)?{binSuffix:"range"}:{}),sort:!0!==x&&Object(r.F)(x)?x:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:e}=p;if(Object(c.e)(e)){const t=Object(m.b)(n,p.field,e);return Object(y.d)([new v.a(()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`})])}return Object(y.d)([{data:n.requestDataName(u.a),field:n.vgField(i,{})}])}}if(p.timeUnit&&g.c(["time","utc"],e)&&Object(s.hasBand)(i,p,Object(j.g)(n)?n.encoding[Object(a.G)(i)]:void 0,n.markDef,n.config)){const e=n.requestDataName(u.a);return Object(y.d)([{data:e,field:n.vgField(i)},{data:e,field:n.vgField(i,{suffix:"end"})}])}return x?Object(y.d)([{data:g.o(x)?n.requestDataName(u.a):n.requestDataName(u.b),field:n.vgField(i),sort:x}]):Object(y.d)([{data:n.requestDataName(u.a),field:n.vgField(i)}])}function k(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":f.a},i?{field:g.z(i)}:{}),r?{order:r}:{})}function S(e,t){const{aggregate:n,type:i}=e;return n?Object(r.H)(n)&&!o.b[n]?{valid:!1,reason:l.b.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===i&&"log"===t?{valid:!1,reason:l.b.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:l.b.unaggregateDomainHasNoEffectForRawField(e)}}function F(e,t,n,i){return e.explicit&&t.explicit&&l.e(l.b.mergeConflictingDomainProperty(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function D(e){if(Object(p.isDataRefDomain)(e)&&Object(r.H)(e.field))return e.field;if(Object(p.isDataRefUnionedDomain)(e)){let t;for(const n of e.fields)if(Object(p.isDataRefDomain)(n)&&Object(r.H)(n.field))if(t){if(t!==n.field)return l.e("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return l.e("Detected faceted independent scales that union domain of identical fields from different source detected. We will assume that this is the same field from a different fork of the same data source. However, if this is not case, the result view size maybe incorrect."),t}if(Object(p.isFieldRefUnionDomain)(e)){l.e("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return Object(r.H)(t)?t:void 0}}function $(e,t){return function(e){const t=g.E(e.map(e=>{if(Object(p.isDataRefDomain)(e)){const{sort:t}=e;return Object(i.a)(e,["sort"])}return e}),g.m),n=g.E(e.map(e=>{if(Object(p.isDataRefDomain)(e)){const t=e.sort;return void 0===t||g.o(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(e=>void 0!==e),g.m);if(0===t.length)return;if(1===t.length){const t=e[0];if(Object(p.isDataRefDomain)(t)&&n.length>0){let e=n[0];return n.length>1&&(l.e(l.b.MORE_THAN_ONE_SORT),e=!0),Object.assign(Object.assign({},t),{sort:e})}return t}const r=g.E(n.map(e=>g.o(e)||!("op"in e)||e.op in o.a?e:(l.e(l.b.domainSortDropped(e)),!0)),g.m);let c;1===r.length?c=r[0]:r.length>1&&(l.e(l.b.MORE_THAN_ONE_SORT),c=!0);const a=g.E(e.map(e=>Object(p.isDataRefDomain)(e)?e.data:null),e=>e);if(1===a.length&&null!==a[0])return Object.assign({data:a[0],fields:t.map(e=>e.field)},c?{sort:c}:{});return Object.assign({fields:t},c?{sort:c}:{})}(e.component.scales[t].get("domains").map(t=>(Object(p.isDataRefDomain)(t)&&(t.data=e.lookupDataSource(t.data)),t)))}},138:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(33),r=n(1),o=n(19);class c extends o.a{constructor(e){let t;if(super(null),e=null!=e?e:{name:"source"},Object(i.c)(e)||(t=e.format?Object.assign({},Object(r.v)(e.format,["parse"])):{}),Object(i.e)(e))this._data={values:e.values};else if(Object(i.i)(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];Object(r.c)(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else Object(i.h)(e)?this._data={values:[{type:"Sphere"}]}:(Object(i.f)(e)||Object(i.c)(e))&&(this._data={});this._generator=Object(i.c)(e),e.name&&(this._name=e.name),t&&Object(r.r)(t).length>0&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}},139:function(e,t,n){"use strict";n.d(t,"g",function(){return j}),n.d(t,"c",function(){return v}),n.d(t,"k",function(){return y}),n.d(t,"h",function(){return x}),n.d(t,"f",function(){return w}),n.d(t,"l",function(){return k}),n.d(t,"j",function(){return S}),n.d(t,"i",function(){return F}),n.d(t,"e",function(){return D}),n.d(t,"a",function(){return $}),n.d(t,"b",function(){return E}),n.d(t,"d",function(){return C});var i=n(33),r=n(1),o=n(196),c=n(112),a=n(19),s=n(213),u=n(250),l=n(89),d=n(211),f=n(290),b=n(101),g=n(256),p=n(192),m=n(291),h=n(214),O=n(32);class j extends b.a{run(e){const t=e.parent;if(e instanceof l.a){if(Object(b.c)(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof l.a)this.setMutated(),t.merge(e);else{if(Object(r.i)(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}class v extends b.b{mergeNodes(e,t){const n=t.shift();for(const i of t)e.removeChild(i),i.parent=n,i.remove()}run(e){const t=e.children.map(e=>e.hash()),n={};for(let i=0;i<t.length;i++)void 0===n[t[i]]?n[t[i]]=[e.children[i]]:n[t[i]].push(e.children[i]);for(const t of Object(r.r)(n))n[t].length>1&&(this.setMutated(),this.mergeNodes(e,n[t]));for(const t of e.children)this.run(t);return this.mutatedFlag}}class y extends b.a{run(e){return e instanceof a.b||e.numChildren()>0||e instanceof s.a?this.flags:(this.setMutated(),e.remove(),this.flags)}}class x extends b.a{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(e){if(this.setContinue(),e instanceof p.a){const t=e.producedFields();Object(r.l)(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...t]),this.prev=e}return this.flags}reset(){this.fields.clear()}}class w extends b.a{run(e){this.setContinue();const t=e.parent.children.filter(e=>e instanceof p.a),n=t.pop();for(const e of t)this.setMutated(),n.merge(e);return this.flags}}function k(e){if(e instanceof s.a)if(1!==e.numChildren()||e.children[0]instanceof a.b){const n=e.model.component.data.main;!function e(t){if(t instanceof a.b&&t.type===i.a&&1===t.numChildren()){const n=t.children[0];n instanceof s.a||(n.swapWithParent(),e(t))}}(n);const r=(t=e,function e(n){if(!(n instanceof s.a)){const i=n.clone();if(i instanceof a.b){const e=f.a+i.getSource();i.setSource(e),t.model.component.data.outputNodes[e]=i}else(i instanceof o.a||i instanceof g.a||i instanceof m.a||i instanceof d.a)&&i.addDimensions(t.fields);return n.children.flatMap(e).forEach(e=>e.parent=i),[i]}return n.children.flatMap(e)}),c=e.children.map(r).flat();for(const e of c)e.parent=n}else{const t=e.children[0];(t instanceof o.a||t instanceof g.a||t instanceof m.a||t instanceof d.a)&&t.addDimensions(e.fields),t.swapWithParent(),k(e)}else e.children.map(k);var t}class S extends b.b{constructor(){super()}run(e){e instanceof a.b&&!e.isRequired()&&(this.setMutated(),e.remove());for(const t of e.children)this.run(t);return this.mutatedFlag}}class F extends b.b{constructor(e){super(),this.requiresSelectionId=e&&Object(O.f)(e)}run(e){e instanceof h.a&&(this.requiresSelectionId&&(Object(b.c)(e.parent)||e.parent instanceof o.a||e.parent instanceof l.a)||(this.setMutated(),e.remove()));for(const t of e.children)this.run(t);return this.mutatedFlag}}class D extends b.a{run(e){const t=e.parent,n=[...t.children],i=t.children.filter(e=>e instanceof l.a);if(t.numChildren()>1&&i.length>=1){const e={},o=new Set;for(const t of i){const n=t.parse;for(const t of Object(r.r)(n))t in e?e[t]!==n[t]&&o.add(t):e[t]=n[t]}for(const t of o)delete e[t];if(0!==Object(r.r)(e).length){this.setMutated();const i=new l.a(t,e);for(const o of n){if(o instanceof l.a)for(const t of Object(r.r)(e))delete o.parse[t];t.removeChild(o),o.parent=i,o instanceof l.a&&0===Object(r.r)(o.parse).length&&o.remove()}}}return this.setContinue(),this.flags}}class $ extends b.a{run(e){const t=e.parent,n=t.children.filter(e=>e instanceof o.a),i={};for(const e of n){const t=Object(r.m)(e.groupBy);t in i||(i[t]=[]),i[t].push(e)}for(const e of Object(r.r)(i)){const n=i[e];if(n.length>1){const e=n.pop();for(const i of n)e.merge(i)&&(t.removeChild(i),i.parent=e,i.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class E extends b.a{constructor(e){super(),this.model=e}run(e){const t=e.parent,n=!(Object(b.c)(t)||t instanceof u.a||t instanceof l.a||t instanceof h.a),i=[],o=[];for(const e of t.children)e instanceof c.a&&(n&&!Object(r.i)(t.producedFields(),e.dependentFields())?i.push(e):o.push(e));if(i.length>0){const e=i.pop();for(const t of i)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated(),t instanceof c.a?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(o.length>1){const e=o.pop();for(const t of o)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class C extends b.a{run(e){const t=e.parent,n=[...t.children];if(!Object(r.B)(n,e=>e instanceof a.b)||t.numChildren()<=1)return this.setContinue(),this.flags;const i=[];let o;for(const e of n)if(e instanceof a.b){let n=e;for(;1===n.numChildren();){const e=n.children[0];if(!(e instanceof a.b))break;n=e}i.push(...n.children),o?(t.removeChild(e),e.parent=o.parent,o.parent.removeChild(o),o.parent=n,this.setMutated()):o=n}else i.push(e);if(i.length){this.setMutated();for(const e of i)e.parent.removeChild(e),e.parent=o}return this.setContinue(),this.flags}}},14:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"g",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"i",function(){return u}),n.d(t,"k",function(){return l}),n.d(t,"l",function(){return d}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return b}),n.d(t,"p",function(){return g}),n.d(t,"d",function(){return p}),n.d(t,"m",function(){return m}),n.d(t,"f",function(){return h}),n.d(t,"y",function(){return j}),n.d(t,"z",function(){return v}),n.d(t,"j",function(){return y}),n.d(t,"x",function(){return x}),n.d(t,"e",function(){return w}),n.d(t,"q",function(){return k}),n.d(t,"r",function(){return S}),n.d(t,"t",function(){return F}),n.d(t,"c",function(){return D}),n.d(t,"s",function(){return $}),n.d(t,"u",function(){return E}),n.d(t,"v",function(){return C}),n.d(t,"w",function(){return N});var i=n(0),r=n(1);const o="area",c="bar",a="image",s="line",u="point",l="rect",d="rule",f="text",b="tick",g="trail",p="circle",m="square",h="geoshape",O={area:1,bar:1,image:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function j(e){return Object(r.c)(["line","area","trail"],e)}function v(e){return Object(r.c)(["rect","bar","image"],e)}const y=Object(r.r)(O);function x(e){return e.type}Object(i.cb)(y);const w=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],k=["filled","color","tooltip","invalid","timeUnitBandPosition","timeUnitBand"],S={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},F={color:"#4c78a8",invalid:"filter",timeUnitBand:1},D={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},$={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},E={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},C={thickness:1};function N(e){return x(e)?e.type:e}},147:function(e,t,n){"use strict";n.d(t,"d",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"a",function(){return p});var i=n(18),r=n(125),o=n(0),c=n(32),a=n(6),s=n(1),u=n(19),l=n(250),d=n(361);function f(e,t){var n;const c={},a=e.config.selection;for(const u in t){if(!Object(o.v)(t,u))continue;const l=Object(s.f)(t[u]),f=a[l.type],{fields:b,encodings:g}=f,p=Object(i.a)(f,["fields","encodings"]);for(const e in p)"encodings"===e&&l.fields||"fields"===e&&l.encodings||("mark"===e&&(l[e]=Object.assign(Object.assign({},p[e]),l[e])),void 0!==l[e]&&!0!==l[e]||(l[e]=null!=(n=p[e])?n:l[e]));const m=Object(s.H)(u),h=c[m]=Object.assign(Object.assign({},l),{name:m,events:Object(o.H)(l.on)?Object(r.a)(l.on,"scope"):Object(s.f)(l.on)});Object(d.a)(h,n=>{n.has(h)&&n.parse&&n.parse(e,h,l,t[u])})}return c}function b(e,t,n,i="datum"){const r=[];const a=Object(s.s)(t,function(t){const a=Object(s.H)(t),u=e.getSelectionComponent(a,t),l=Object(o.Y)(a+c.b);if(u.project.timeUnit){const t=null!=n?n:e.component.data.raw,i=u.project.timeUnit.clone();t.parent?i.insertAsParentOf(t):t.parent=i}return"none"!==u.empty&&r.push(l),`vlSelectionTest(${l}, ${i}`+("global"===u.resolve?")":`, ${Object(o.Y)(u.resolve)})`)});return(r.length?"!("+r.map(e=>`length(data(${e}))`).join(" || ")+") || ":"")+`(${a})`}function g(e,t){const n=t.encoding;let i=t.field;if(n||i){if(n&&!i){const r=e.project.items.filter(e=>e.channel===n);!r.length||r.length>1?(i=e.project.items[0].field,Object(a.e)((r.length?"Multiple ":"No ")+`matching ${Object(o.Y)(n)} encoding found for selection ${Object(o.Y)(t.selection)}. `+`Using "field": ${Object(o.Y)(i)}.`)):i=r[0].field}}else i=e.project.items[0].field,e.project.items.length>1&&Object(a.e)('A "field" or "encoding" must be specified when using a selection as a scale domain. '+`Using "field": ${Object(o.Y)(i)}.`);return`${e.name}[${Object(o.Y)(i)}]`}function p(e,t){Object(c.e)(e,n=>{const i=n.name,r=e.getName(`lookup_${i}`);e.component.data.outputNodes[r]=n.materialized=new u.b(new l.a(t,e,{selection:i}),r,"lookup",e.component.data.outputNodeRefCounts)})}},154:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"b",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return p});var i=n(0),r=n(6),o=n(1);const c=2006;function a(e){return!!(e&&(e.year||e.quarter||e.month||e.date||e.day||e.hours||e.minutes||e.seconds||e.milliseconds))}const s=["january","february","march","april","may","june","july","august","september","october","november","december"],u=s.map(e=>e.substr(0,3)),l=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],d=l.map(e=>e.substr(0,3));function f(e,t){const n=[];if(t&&void 0!==e.day&&Object(o.r)(e).length>1&&(r.e(r.b.droppedDay(e)),delete(e=Object(o.f)(e)).day),void 0!==e.year?n.push(e.year):void 0!==e.day?n.push(c):n.push(0),void 0!==e.month){const c=t?function(e){if(Object(o.q)(e)&&(e=+e),Object(i.E)(e))return e-1;{const t=e.toLowerCase(),n=s.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),o=u.indexOf(i);if(-1!==o)return o;throw new Error(r.b.invalidTimeUnit("month",e))}}(e.month):e.month;n.push(c)}else if(void 0!==e.quarter){const c=t?function(e){if(Object(o.q)(e)&&(e=+e),Object(i.E)(e))return e>4&&r.e(r.b.invalidTimeUnit("quarter",e)),e-1;throw new Error(r.b.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(Object(i.E)(c)?3*c:c+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const c=t?function(e){if(Object(o.q)(e)&&(e=+e),Object(i.E)(e))return e%7;{const t=e.toLowerCase(),n=l.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),o=d.indexOf(i);if(-1!==o)return o;throw new Error(r.b.invalidTimeUnit("day",e))}}(e.day):e.day;n.push(Object(i.E)(c)?c+1:c+"+1")}else n.push(1);for(const t of["hours","minutes","seconds","milliseconds"]){const i=e[t];n.push(void 0===i?0:i)}return n}function b(e){const t=f(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}function g(e){const t=f(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}function p(e){const t=f(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}},155:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var i=n(18),r=n(0);function o(e){const{anchor:t,frame:n,offset:r,orient:o,color:c,subtitleColor:a,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:d,subtitleLineHeight:f,subtitlePadding:b}=e,g=Object(i.a)(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]);return{mark:Object.assign(Object.assign({},g),c?{fill:c}:{}),nonMark:Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),o?{orient:o}:{}),subtitle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a?{subtitleColor:a}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),d?{subtitleFontWeight:d}:{}),f?{subtitleLineHeight:f}:{}),b?{subtitlePadding:b}:{})}}function c(e){return Object(r.H)(e)||Object(r.A)(e)&&Object(r.H)(e[0])}},156:function(e,t,n){"use strict";n.d(t,"a",function(){return i});class i{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new i(()=>e(t))}}},16:function(e,t,n){"use strict";n.d(t,"l",function(){return g}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"d",function(){return O}),n.d(t,"f",function(){return j}),n.d(t,"c",function(){return v}),n.d(t,"k",function(){return y}),n.d(t,"b",function(){return k}),n.d(t,"n",function(){return S}),n.d(t,"m",function(){return F}),n.d(t,"j",function(){return D}),n.d(t,"h",function(){return $}),n.d(t,"i",function(){return E});var i=n(0),r=n(21),o=n(4),c=n(104),a=n(13),s=n(50),u=n(155),l=n(45),d=n(1),f=n(24);const b=" – ";function g(e){return Object(f.isSignalRef)(e)?e:{value:e}}function p(e,t,n){for(const i of n){const n=O(i,t.markDef,t.config);void 0!==n&&(e[i]={value:n})}return e}function m(e){var t;return[].concat(e.type,null!=(t=e.style)?t:[])}function h(e,t,n){return Object(d.k)(t[e],O(e,t,n))}function O(e,t,n,{vgChannel:i}={}){return Object(d.k)(i?j(e,t,n.style):void 0,j(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function j(e,t,n){const i=m(t);let r;for(const t of i){const i=n[t],o=e;i&&void 0!==i[o]&&(r=i[o])}return r}function v(e,t,n,i){var c;if(Object(o.isTimeFormatFieldDef)(e)){const r=Object(o.isScaleFieldDef)(e)&&e.scale&&e.scale.type===a.b.UTC;return{signal:S(Object(o.vgField)(e,{expr:n}),null===(c=Object(s.e)(e.timeUnit))||void 0===c?void 0:c.unit,t,i.timeFormat,r,!0)}}{const c=y(e,t,i);if(Object(r.e)(e.bin)){return{signal:k(Object(o.vgField)(e,{expr:n}),Object(o.vgField)(e,{expr:n,binSuffix:"end"}),c,i)}}return"quantitative"===e.type||c?{signal:`${x(Object(o.vgField)(e,{expr:n,binSuffix:"range"}),c)}`}:{signal:`''+${Object(o.vgField)(e,{expr:n})}`}}}function y(e,t,n){return t||(e.type===l.d?n.numberFormat:void 0)}function x(e,t){return`format(${e}, "${t||""}")`}function w(e,t,n){return x(e,null!=t?t:n.numberFormat)}function k(e,t,n,i){return`${Object(c.b)(e,!1)} ? "null" : ${w(e,n,i)} + "${b}" + ${w(t,n,i)}`}function S(e,t,n,i,r,o=!1){return!t||n?(n=null!=n?n:i)||o?`${r?"utc":"time"}Format(${e}, '${n}')`:void 0:Object(s.b)(t,e,r)}function F(e,t){return Object(i.i)(e).reduce((e,n)=>{var i;return e.field.push(Object(o.vgField)(n,t)),e.order.push(null!=(i=n.sort)?i:"ascending"),e},{field:[],order:[]})}function D(e,t){const n=[...e];return t.forEach(e=>{for(const t of n)if(Object(d.d)(t,e))return;n.push(e)}),n}function $(e,t){return Object(d.d)(e,t)||!t?e:e?[...Object(i.i)(e),...Object(i.i)(t)].join(", "):t}function E(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if(Object(u.b)(n)&&Object(u.b)(i))return{explicit:e.explicit,value:$(n,i)};if(!Object(u.b)(n)&&!Object(u.b)(i))return{explicit:e.explicit,value:D(n,i)};throw new Error("It should never reach here")}},172:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(0),r=n(4),o=n(288),c=n(147);function a(e,t,n,a){const s=t&&t.condition,u=a(t);if(s){return{[n]:[...Object(i.i)(s).map(t=>{const n=a(t),i=Object(r.isConditionalSelection)(t)?Object(c.c)(e,t.selection):Object(o.a)(e,t.test);return Object.assign({test:i},n)}),...void 0!==u?[u]:[]]}}return void 0!==u?{[n]:u}:{}}},177:function(e,t,n){"use strict";function i(e){return o(e)||c(e)||r(e)}function r(e){return void 0!==e.concat}function o(e){return void 0!==e.vconcat}function c(e){return void 0!==e.hconcat}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return c})},178:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return f});var i=n(5),r=n(4),o=n(6),c=n(13),a=n(1),s=n(16),u=n(344),l=n(77);function d(e,t,{defaultPos:n,vgChannel:o}){const{encoding:c,markDef:a,config:s,stack:d}=t,b=c[e],g=c[e===i.z?i.A:i.C],p=t.scaleName(e),m=t.getScaleComponent(e),h=Object(u.a)(e,a),O=f({model:t,defaultPos:n,channel:e,scaleName:p,scale:m,checkBarAreaWithoutZero:!g});return{[null!=o?o:e]:b||!c.latitude&&!c.longitude?function(e){const{channel:t,channelDef:n,scaleName:i,stack:o,offset:c}=e;if(Object(r.isFieldDef)(n)&&o&&t===o.fieldChannel)return Object(r.isPositionFieldDef)(n)&&void 0!==n.band?l.c({scaleName:i,fieldDef:n,startSuffix:"start",band:n.band,offset:0}):l.b(n,i,{suffix:"end"},{offset:c});return l.e(e)}({channel:e,channelDef:b,channel2Def:g,markDef:a,config:s,scaleName:p,scale:m,stack:d,offset:h,defaultRef:O}):{field:t.getName(e)}}}function f({model:e,defaultPos:t,channel:n,scaleName:r,scale:u,checkBarAreaWithoutZero:d}){const{mark:f,markDef:b,config:g}=e;return()=>{const p=Object(i.D)(n),m=Object(a.k)(b[n],Object(s.d)(n,b,g));if(void 0!==m)return l.f(n,m);if("zeroOrMin"===t||"zeroOrMax"===t){if(r){const e=u.get("type");if(Object(a.c)([c.b.LOG,c.b.TIME,c.b.UTC],e))!d||"bar"!==f&&"area"!==f&&"rule"!==f||o.e(o.b.nonZeroScaleUsedWithLengthMark(f,p,{scaleType:e}));else{if(u.domainDefinitelyIncludesZero())return{scale:r,value:0};!d||"bar"!==f&&"area"!==f||o.e(o.b.nonZeroScaleUsedWithLengthMark(f,p,{zeroFalse:!1===u.explicit.zero}))}}return"zeroOrMin"===t?"x"===p?{value:0}:{field:{group:"height"}}:"x"===p?{field:{group:"width"}}:{value:0}}{const t=e["x"===p?"width":"height"];return Object.assign(Object.assign({},t),{mult:.5})}}}},18:function(e,t,n){"use strict";n.d(t,"a",function(){return i});function i(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}},183:function(e,t,n){"use strict";n.d(t,"a",function(){return U}),n.d(t,"b",function(){return H});var i=n(33),r=n(6),o=n(60),c=n(1),a=n(20),s=n(32),u=n(147),l=n(196),d=n(112),f=n(111),b=n(19),g=n(537),p=n(213),m=n(250),h=n(538),O=n(539),j=n(540),v=n(89),y=n(541),x=n(542),w=n(345),k=n(214),S=n(404),F=n(1043),D=n(211),$=n(1044),E=n(545),C=n(546),N=n(549),_=n(547),z=n(548),A=n(550),T=n(346),R=n(138),P=n(256),M=n(192),L=n(291);function U(e,t){var n,r,o,a,s,u,l,d,f,b;for(const g of t){const t=g.data;if((!e.name||!g.hasName()||e.name===g.dataName)&&!((null===(n=e.format)||void 0===n?void 0:n.mesh)&&(null===(r=t.format)||void 0===r?void 0:r.feature)||((null===(o=e.format)||void 0===o?void 0:o.feature)||(null===(a=t.format)||void 0===a?void 0:a.feature))&&(null===(s=e.format)||void 0===s?void 0:s.feature)!==(null===(u=t.format)||void 0===u?void 0:u.feature)||((null===(l=e.format)||void 0===l?void 0:l.mesh)||(null===(d=t.format)||void 0===d?void 0:d.mesh))&&(null===(f=e.format)||void 0===f?void 0:f.mesh)!==(null===(b=t.format)||void 0===b?void 0:b.mesh)))if(Object(i.e)(e)&&Object(i.e)(t)){if(Object(c.d)(e.values,t.values))return g}else if(Object(i.i)(e)&&Object(i.i)(t)){if(e.url===t.url)return g}else if(Object(i.f)(e)&&e.name===g.dataName)return g}return null}function H(e){var t,n,H,q,W,I,B,G,Y,V,J;let Q=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new R.a([]);return t.push(e),e}const n=U(e.data,t);if(n)return Object(i.c)(e.data)||(n.data.format=Object(c.t)({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new R.a(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:X,outputNodeRefCounts:Z}=e.component.data,K=e.parent?e.parent.component.data.ancestorParse.clone():new F.a,ee=e.data;Object(i.c)(ee)?(Object(i.g)(ee)?Q=new T.a(Q,ee.sequence):Object(i.d)(ee)&&(Q=new w.a(Q,ee.graticule)),K.parseNothing=!0):null===(null===(n=null===(t=ee)||void 0===t?void 0:t.format)||void 0===n?void 0:n.parse)&&(K.parseNothing=!0),Q=null!=(H=v.a.makeExplicit(Q,e,K))?H:Q,Q=new k.a(Q);const te=e.parent&&Object(a.e)(e.parent);(Object(a.g)(e)||Object(a.d)(e))&&te&&(Q=null!=(q=d.a.makeFromEncoding(Q,e))?q:Q),e.transforms.length>0&&(Q=function(e,t,n){var i,c;let a=0;for(const u of t.transforms){let b,p=void 0;if(Object(o.c)(u))b=e=new f.a(e,u),p="derived";else if(Object(o.e)(u)){const r=Object(v.c)(u);b=e=null!=(i=v.a.makeWithAncestors(e,{},r,n))?i:e,e=new m.a(e,t,u.filter)}else if(Object(o.b)(u))b=e=d.a.makeFromTransform(e,u,t),p="number";else if(Object(o.t)(u))p="date",void 0===n.getWithExplicit(u.field).value&&(e=new v.a(e,{[u.field]:p}),n.set(u.field,p,!1)),b=e=M.a.makeFromTransform(e,u);else if(Object(o.a)(u))b=e=l.a.makeFromTransform(e,u),p="number",Object(s.f)(t)&&(e=new k.a(e));else if(Object(o.l)(u))b=e=C.a.make(e,t,u,a++),p="derived";else if(Object(o.u)(u))b=e=new L.a(e,u),p="number";else if(Object(o.j)(u))b=e=new D.a(e,u),p="number";else if(Object(o.s)(u))b=e=P.a.makeFromTransform(e,u),p="derived";else if(Object(o.g)(u))b=e=new j.a(e,u),p="derived";else if(Object(o.f)(u))b=e=new O.a(e,u),p="derived";else if(Object(o.o)(u))b=e=new N.a(e,u),p="derived";else if(Object(o.r)(u))e=new A.a(e,u);else if(Object(o.h)(u))b=e=S.a.makeFromTransform(e,u),p="derived";else if(Object(o.d)(u))b=e=new g.a(e,u),p="derived";else if(Object(o.p)(u))b=e=new _.a(e,u),p="derived";else if(Object(o.q)(u))b=e=new z.a(e,u),p="derived";else{if(!Object(o.k)(u)){r.e(r.b.invalidTransformIgnored(u));continue}b=e=new E.a(e,u),p="derived"}if(b&&void 0!==p)for(const e of null!=(c=b.producedFields())?c:[])n.set(e,p,!1)}return e}(Q,e,K));const ne=Object(v.d)(e),ie=Object(v.b)(e);Q=null!=(W=v.a.makeWithAncestors(Q,{},Object.assign(Object.assign({},ne),ie),K))?W:Q,Object(a.g)(e)&&(Q=y.a.parseAll(Q,e),Q=x.a.parseAll(Q,e)),(Object(a.g)(e)||Object(a.d)(e))&&(te||(Q=null!=(I=d.a.makeFromEncoding(Q,e))?I:Q),Q=null!=(B=M.a.makeFromEncoding(Q,e))?B:Q,Q=f.a.parseAllForSortIndex(Q,e));const re=e.getName(i.b),oe=new b.b(Q,re,i.b,Z);if(X[re]=oe,Q=oe,Object(a.g)(e)){const t=l.a.makeFromEncoding(Q,e);t&&(Q=t,Object(s.f)(e)&&(Q=new k.a(Q))),Q=null!=(G=S.a.makeFromEncoding(Q,e))?G:Q,Q=null!=(Y=P.a.makeFromEncoding(Q,e))?Y:Q}Object(a.g)(e)&&(Q=null!=(V=h.a.make(Q,e))?V:Q);const ce=e.getName(i.a),ae=new b.b(Q,ce,i.a,Z);X[ce]=ae,Q=ae,Object(a.g)(e)&&Object(u.a)(e,ae);let se=null;if(Object(a.d)(e)){const t=e.getName("facet");Q=f.a.parseAllForSortIndex(Q,e),Q=null!=(J=Object($.a)(Q,e.facet))?J:Q,se=new p.a(Q,e,t,ae.getSource()),X[t]=se,Q=se}return Object.assign(Object.assign({},e.component.data),{outputNodes:X,outputNodeRefCounts:Z,raw:oe,main:ae,facetRoot:se,ancestorParse:K})}},184:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(18),r=n(0),o=n(5),c=n(6),a=n(13),s=n(1),u=n(192);const l="_tuple_fields";class d{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}const f={has:()=>!0,parse:(e,t,n)=>{var i,l,f;const b=t.name,g=null!=(i=t.project)?i:t.project=new d,p={},m={},h=new Set,O=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=Object(s.H)(`${b}_${n}`);for(let e=1;h.has(i);e++)i=Object(s.H)(`${b}_${n}_${e}`);return h.add(i),{[t]:i}};if(!n.fields&&!n.encodings){const t=e.config.selection[n.type];if(n.init)for(const e of Object(r.i)(n.init))for(const i of Object(s.r)(e))Object(o.O)(i)?(n.encodings||(n.encodings=[])).push(i):"interval"===n.type?(c.e('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=t.encodings):(n.fields||(n.fields=[])).push(i);else n.encodings=t.encodings,n.fields=t.fields}for(const e of null!=(l=n.fields)?l:[]){const t={type:"E",field:e};t.signals=Object.assign({},O(t,"data")),g.items.push(t),g.hasField[e]=t}for(const i of null!=(f=n.encodings)?f:[]){const n=e.fieldDef(i);if(n){let r=n.field;if(n.aggregate){c.e(c.b.cannotProjectAggregate(i,n.aggregate));continue}if(!r){c.e(c.b.cannotProjectOnChannelWithoutField(i));continue}if(n.timeUnit){r=e.vgField(i);const t={timeUnit:n.timeUnit,as:r,field:n.field};m[Object(s.m)(t)]=t}if(!p[r]){let o="E";if("interval"===t.type){const t=e.getScaleComponent(i).get("type");Object(a.f)(t)&&(o="R")}else n.bin&&(o="R-RE");const c={field:r,channel:i,type:o};c.signals=Object.assign(Object.assign({},O(c,"data")),O(c,"visual")),g.items.push(p[r]=c),g.hasField[r]=g.hasChannel[i]=p[r]}}else c.e(c.b.cannotProjectOnChannelWithoutField(i))}if(n.init){const e=e=>g.items.map(t=>void 0!==e[t.channel]?e[t.channel]:e[t.field]);if("interval"===n.type)t.init=e(n.init);else{const i=Object(r.i)(n.init);t.init=i.map(e)}}Object(s.r)(m).length>0&&(g.timeUnit=new u.a(null,m))},signals:(e,t,n)=>{const r=t.name+l;return n.filter(e=>e.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(e=>{const{signals:t,hasLegend:n}=e,r=Object(i.a)(e,["signals","hasLegend"]),o=Object(s.f)(r);return o.field=Object(s.z)(o.field),o})})}};t.b=f},185:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"a",function(){return b}),n.d(t,"e",function(){return p});var i=n(5),r=n(75),o=n(13),c=n(76),a=n(24),s=n(31);function u(e){b(e);const t=e.component.layoutSize;t.setWithExplicit("width",g(e,"width")),t.setWithExplicit("height",g(e,"height"))}const l=u,d={vconcat:"width",hconcat:"height"};function f(e){b(e);const t=e.component.layoutSize,n=d[e.concatType];n&&t.setWithExplicit(n,g(e,n))}function b(e){for(const t of e.children)t.parseLayoutSize()}function g(e,t){const n="width"===t?"x":"y",i=e.component.resolve;let r;for(const o of e.children){const e=o.component.layoutSize.getWithExplicit(t),c=i.scale[n];if("independent"===c&&"step"===e.value){r=void 0;break}if(r){if("independent"===c&&r.value!==e.value){r=void 0;break}r=Object(s.e)(r,e,t,"")}else r=e}if(r){for(const n of e.children)e.renameSignal(n.getName(t),e.getName(t)),n.component.layoutSize.set(t,"merged",!1);return r}return{explicit:!1,value:void 0}}function p(e){const{size:t,component:n}=e;for(const r of i.p){const o=Object(i.H)(r);if(t[o]){const e=t[o];n.layoutSize.set(o,Object(c.d)(e)?"step":e,!0)}else{const t=m(e,o);n.layoutSize.set(o,t,!1)}}}function m(e,t){const n="width"===t?"x":"y",i=e.config,s=e.getScaleComponent(n);if(s){const e=s.get("type"),n=s.get("range");if(Object(o.g)(e)){const e=Object(r.c)(i.view,t);return Object(a.isVgRangeStep)(n)||Object(c.d)(e)?"step":e}return Object(r.b)(i.view,t)}if(e.hasProjection)return Object(r.b)(i.view,t);{const e=Object(r.c)(i.view,t);return Object(c.d)(e)?e.step:e}}},19:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n(1);class r{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const t of this._children)t.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}class o extends r{constructor(e,t,n,i){super(e,t),this.type=n,this.refCounts=i,this._source=this._name=t,!this.refCounts||this._name in this.refCounts||(this.refCounts[this._name]=0)}clone(){const e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${Object(i.F)()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}},192:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(18),r=n(5),o=n(4),c=n(50),a=n(1),s=n(20),u=n(19);class l extends u.a{constructor(e,t){super(e),this.formula=t}clone(){return new l(null,Object(a.f)(this.formula))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{const{field:c,timeUnit:u}=n,l=Object(s.g)(t)?t.encoding[Object(r.G)(i)]:void 0,d=Object(s.g)(t)&&Object(o.hasBand)(i,n,l,t.markDef,t.config);if(u){const t=Object(o.vgField)(n,{forAs:!0});e[Object(a.m)({as:t,field:c,timeUnit:u})]=Object.assign({as:t,field:c,timeUnit:u},d?{band:!0}:{})}return e},{});return 0===Object(a.r)(n).length?null:new l(e,n)}static makeFromTransform(e,t){const n=Object.assign({},t),{timeUnit:r}=n,o=Object(i.a)(n,["timeUnit"]),s=Object(c.e)(r),u=Object.assign(Object.assign({},o),{timeUnit:s});return new l(e,{[Object(a.m)(u)]:u})}merge(e){this.formula=Object.assign({},this.formula);for(const t in e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(Object(a.G)(this.formula).map(e=>e.as))}dependentFields(){return new Set(Object(a.G)(this.formula).map(e=>e.field))}hash(){return`TimeUnit ${Object(a.m)(this.formula)}`}assemble(){const e=[];for(const t of Object(a.G)(this.formula)){const{field:n,as:r,timeUnit:o}=t,a=Object(c.e)(o),{unit:s,utc:u}=a,l=Object(i.a)(a,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:n,type:"timeunit"},s?{units:Object(c.c)(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return e}}},193:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r});const i=["row","column"],r=["header","footer"]},195:function(e,t,n){"use strict";n.d(t,"g",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"a",function(){return p}),n.d(t,"b",function(){return h});var i=n(0),r=n(5),o=n(4),c=n(13),a=n(1),s=n(24),u=n(403);function l(e,t){const n=e.values;return Object(i.A)(n)?Object(o.valueArray)(t,n):Object(s.isSignalRef)(n)?n:void 0}function d(e,t,n,i){var r;if("shape"!==t){const e=null!=(r=Object(u.getFirstConditionValue)(n))?r:i;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function f(e){const{legend:t}=e;return Object(a.k)(t.type,b(e))}function b({channel:e,timeUnit:t,scaleType:n,alwaysReturn:i}){if(Object(r.J)(e)){if(Object(a.c)(["quarter","month","day"],t))return"symbol";if(Object(c.h)(n))return i?"gradient":void 0}return i?"symbol":void 0}function g({legend:e,legendConfig:t,timeUnit:n,channel:i,scaleType:r}){const o=Object(a.k)(e.orient,t.orient,"right"),c=f({legend:e,channel:i,timeUnit:n,scaleType:r,alwaysReturn:!0});return Object(a.k)(e.direction,t[c?"gradientDirection":"symbolDirection"],function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(o,c))}function p({legend:e,legendConfig:t,model:n,channel:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:u,gradientVerticalMinLength:l}=t;if(Object(c.h)(r)){if("horizontal"===g({legend:e,legendConfig:t,channel:i,scaleType:r})){const i=Object(a.k)(e.orient,t.orient);return"top"===i||"bottom"===i?m(n,"width",s,o):s}return m(n,"height",l,u)}}function m(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function h(e){if(Object(a.c)(["quantile","threshold","log"],e))return"greedy"}},196:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(51),r=n(5),o=n(4),c=n(6),a=n(1),s=n(20),u=n(19);class l extends u.a{constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}clone(){return new l(null,new Set(this.dimensions),Object(a.f)(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef(e=>{e.aggregate&&(n=!0)});const c={},u=new Set;return n?(t.forEachFieldDef((e,n)=>{var a,l,d,f;const{aggregate:b,field:g}=e;if(b)if("count"===b)c["*"]=null!=(a=c["*"])?a:{},c["*"].count=new Set([Object(o.vgField)(e,{forAs:!0})]);else{if(Object(i.f)(b)||Object(i.e)(b)){const e=Object(i.f)(b)?"argmin":"argmax",t=b[e];c[t]=null!=(l=c[t])?l:{},c[t][e]=new Set([Object(o.vgField)({op:e,field:t},{forAs:!0})])}else c[g]=null!=(d=c[g])?d:{},c[g][b]=new Set([Object(o.vgField)(e,{forAs:!0})]);Object(r.M)(n)&&"unaggregated"===t.scaleDomain(n)&&(c[g]=null!=(f=c[g])?f:{},c[g].min=new Set([Object(o.vgField)({field:g,aggregate:"min"},{forAs:!0})]),c[g].max=new Set([Object(o.vgField)({field:g,aggregate:"max"},{forAs:!0})]))}else!function(e,t,n,i){const c=Object(s.g)(i)?i.encoding[Object(r.G)(t)]:void 0;if(Object(o.isTypedFieldDef)(n)&&Object(s.g)(i)&&Object(o.hasBand)(t,n,c,i.markDef,i.config))e.add(Object(o.vgField)(n,{})),e.add(Object(o.vgField)(n,{suffix:"end"})),n.bin&&Object(o.binRequiresRange)(n,t)&&e.add(Object(o.vgField)(n,{binSuffix:"range"}));else if(Object(r.K)(t)){const n=Object(r.E)(t);e.add(i.getName(n))}else e.add(Object(o.vgField)(n))}(u,n,e,t)}),u.size+Object(a.r)(c).length===0?null:new l(e,u,c)):null}static makeFromTransform(e,t){var n,i,r;const c=new Set,s={};for(const e of t.aggregate){const{op:t,field:r,as:c}=e;t&&("count"===t?(s["*"]=null!=(n=s["*"])?n:{},s["*"].count=new Set([c||Object(o.vgField)(e,{forAs:!0})])):(s[r]=null!=(i=s[r])?i:{},s[r][t]=new Set([c||Object(o.vgField)(e,{forAs:!0})])))}for(const e of null!=(r=t.groupby)?r:[])c.add(e);return c.size+Object(a.r)(s).length===0?null:new l(e,c,s)}merge(e){return Object(a.A)(this.dimensions,e.dimensions)?(function(e,t){var n;for(const i of Object(a.r)(t)){const r=t[i];for(const t of Object(a.r)(r))i in e?e[i][t]=new Set([...(n=e[i][t],null!=n?n:[]),...r[t]]):e[i]={[t]:r[t]}}}(this.measures,e.measures),!0):(c.a("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Object(a.r)(this.measures)])}producedFields(){const e=new Set;for(const t of Object(a.r)(this.measures))for(const n of Object(a.r)(this.measures[t])){const i=this.measures[t][n];0===i.size?e.add(`${n}_${t}`):i.forEach(e.add,e)}return e}hash(){return`Aggregate ${Object(a.m)({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[],t=[],n=[];for(const i of Object(a.r)(this.measures))for(const r of Object(a.r)(this.measures[i]))for(const o of this.measures[i][r])n.push(o),e.push(r),t.push("*"===i?null:Object(a.z)(i));return{type:"aggregate",groupby:[...this.dimensions],ops:e,fields:t,as:n}}}},20:function(e,t,n){"use strict";n.d(t,"g",function(){return E}),n.d(t,"d",function(){return C}),n.d(t,"f",function(){return N}),n.d(t,"c",function(){return _}),n.d(t,"e",function(){return z}),n.d(t,"a",function(){return A}),n.d(t,"b",function(){return T});var i=n(18),r=n(0),o=n(5),c=n(4),a=n(46),s=n(6),u=n(13),l=n(80),d=n(76),f=n(155),b=n(60),g=n(1),p=n(24),m=n(249),h=n(295),O=n(193),j=n(251),v=n(534),y=n(535),x=n(1036),w=n(1037),k=n(1039),S=n(137),F=n(1040),D=n(31);class ${constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function E(e){var t;return"unit"===(null===(t=e)||void 0===t?void 0:t.type)}function C(e){var t;return"facet"===(null===(t=e)||void 0===t?void 0:t.type)}function N(e){var t;return"repeat"===(null===(t=e)||void 0===t?void 0:t.type)}function _(e){var t;return"concat"===(null===(t=e)||void 0===t?void 0:t.type)}function z(e){var t;return"layer"===(null===(t=e)||void 0===t?void 0:t.type)}class A{constructor(e,t,n,i,r,o,c,a){var s,u;this.type=t,this.parent=n,this.config=r,this.repeater=o,this.view=a,this.children=[],this.correctDataNames=(e=>(e.from&&e.from.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e)),this.parent=n,this.config=r,this.repeater=o,this.name=null!=(s=e.name)?s:i,this.title=Object(f.b)(e.title)?{text:e.title}:e.title,this.scaleNameMap=n?n.scaleNameMap:new $,this.projectionNameMap=n?n.projectionNameMap:new $,this.signalNameMap=n?n.signalNameMap:new $,this.data=e.data,this.description=e.description,this.transforms=Object(b.v)(null!=(u=e.transform)?u:[]),this.layout=Object(l.f)(e)||Object(l.d)(e)?{}:Object(d.b)(e,t,r),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:Object(l.b)(e)||n&&n.component.data.isFaceted&&void 0===e.data},layoutSize:new D.a,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},c?Object(g.f)(c):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Object(F.a)(this)}parseProjection(){Object(w.a)(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Object(y.b)(this)}assembleGroupStyle(){var e,t;if("unit"===this.type||"layer"===this.type)return null!=(t=null===(e=this.view)||void 0===e?void 0:e.style)?t:"cell"}assembleEncodeFromView(e){const{style:t}=e,n=Object(i.a)(e,["style"]),o={};for(const e in n)if(Object(r.v)(n,e)){const t=n[e];void 0!==t&&(o[e]={value:t})}return o}assembleGroupEncodeEntry(e){let t=void 0;return this.view&&(t=this.assembleEncodeFromView(this.view)),e||"unit"!==this.type&&"layer"!==this.type?t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=t?t:{})}assembleLayout(){if(!this.layout)return;const e=this.layout,{spacing:t}=e,n=Object(i.a)(e,["spacing"]),{component:r,config:o}=this,c=Object(h.c)(r.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),c?{titleBand:c}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of o.e)e[n].title&&t.push(Object(h.d)(this,n));for(const e of O.a)t=t.concat(Object(h.a)(this,e));return t}assembleAxes(){return Object(m.a)(this.component.axes,this.config)}assembleLegends(){return Object(v.a)(this)}assembleProjections(){return Object(x.a)(this)}assembleTitle(){var e,t,n;const r=null!=(e=this.title)?e:{},{encoding:o}=r,c=Object(i.a)(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},Object(f.a)(this.config.title).nonMark),c),o?{encode:{update:o}}:{});if(a.text)return Object(g.c)(["unit","layer"],this.type)?Object(g.c)(["middle",void 0],a.anchor)&&(a.frame=null!=(t=a.frame)?t:"group"):a.anchor=null!=(n=a.anchor)?n:"start",Object(g.r)(a).length>0?a:void 0}assembleGroup(e=[]){const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||C(this.parent)?Object(k.a)(this):[];i.length>0&&(t.scales=i);const r=this.assembleAxes();r.length>0&&(t.axes=r);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return Object(g.H)((this.name?this.name+"_":"")+e)}requestDataName(e){var t;const n=this.getName(e),i=this.component.data.outputNodeRefCounts;return i[n]=(null!=(t=i[n])?t:0)+1,n}getSizeSignalRef(e){if(C(this.parent)){const t=Object(o.F)(e),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),i=n.get("range");if(Object(u.g)(e)&&Object(p.isVgRangeStep)(i)){const e=n.get("name"),i=Object(S.a)(this,t),r=Object(S.b)(i);if(r){const t=Object(c.vgField)({aggregate:"distinct",field:r},{expr:"datum"});return{signal:Object(j.b)(e,n,t)}}return s.e(`Unknown field for ${t}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):Object(o.I)(e)&&Object(o.M)(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(s.b.selectionNotFound(t));return n}}class T extends A{vgField(e,t={}){const n=this.fieldDef(e);if(n)return Object(c.vgField)(n,t)}reduceFieldDef(e,t){return Object(a.h)(this.getMapping(),(t,n,i)=>{const r=Object(c.getFieldDef)(n);return r?e(t,r,i):t},t)}forEachFieldDef(e,t){Object(a.d)(this.getMapping(),(t,n)=>{const i=Object(c.getFieldDef)(t);i&&e(i,n)},t)}}},204:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return a});var i=n(4),r=n(16),o=n(172);function c(e,t="text"){const n=e.encoding[t];return Object(o.a)(e,n,t,t=>a(t,e.config))}function a(e,t,n="datum"){if(e){if(Object(i.isValueDef)(e))return{value:e.value};if(Object(i.isTypedFieldDef)(e))return Object(r.c)(e,Object(i.format)(e),n,t)}}},21:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"a",function(){return f});var i=n(0),r=n(5),o=n(4),c=n(1);function a(e){return Object(i.B)(e)&&(e=Object(o.normalizeBin)(e,void 0)),"bin"+Object(c.r)(e).map(t=>d(e[t])?Object(c.H)(`_${t}_${Object.entries(e[t])}`):Object(c.H)(`_${t}_${e[t]}`)).join("")}function s(e){return!0===e||l(e)&&!e.binned}function u(e){return"binned"===e||l(e)&&!0===e.binned}function l(e){return Object(i.F)(e)}function d(e){var t;return null===(t=e)||void 0===t?void 0:t.selection}function f(e){switch(e){case r.q:case r.c:case r.u:case r.b:case r.f:case r.v:case r.y:case r.o:case r.g:case r.x:case r.t:return 6;case r.w:return 4;default:return 10}}},211:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(4),r=n(1),o=n(19);class c extends o.a{constructor(e,t){super(e),this.transform=t}clone(){return new c(null,Object(r.f)(this.transform))}addDimensions(e){this.transform.groupby=Object(r.E)(this.transform.groupby.concat(e),e=>e)}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t=>e.add(t)),this.transform.joinaggregate.map(e=>e.field).filter(e=>void 0!==e).forEach(t=>e.add(t)),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var t;return null!=(t=e.as)?t:Object(i.vgField)(e)}hash(){return`JoinAggregateTransform ${Object(r.m)(this.transform)}`}assemble(){const e=[],t=[],n=[];for(const i of this.transform.joinaggregate)t.push(i.op),n.push(this.getDefaultName(i)),e.push(void 0===i.field?null:i.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==i?{groupby:i}:{})}}},213:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n(0),r=n(21),o=n(5),c=n(4),a=n(6),s=n(13),u=n(54),l=n(1),d=n(24),f=n(193),b=n(137),g=n(111),p=n(19);class m extends p.a{constructor(e,t,n,a){super(e),this.model=t,this.name=n,this.data=a;for(const e of o.e){const n=t.facet[e];if(n){const{bin:o,sort:a}=n;this[e]=Object.assign({name:t.getName(`${e}_domain`),fields:[Object(c.vgField)(n),...Object(r.e)(o)?[Object(c.vgField)(n,{binSuffix:"end"})]:[]]},Object(u.e)(a)?{sortField:a}:Object(i.A)(a)?{sortIndexField:Object(g.b)(n,e)}:{})}}this.childModel=t.child}hash(){let e="Facet";for(const t of o.e)this[t]&&(e+=` ${t.charAt(0)}:${Object(l.m)(this[t])}`);return e}get fields(){var e;const t=[];for(const n of o.e)(null===(e=this[n])||void 0===e?void 0:e.fields)&&t.push(...this[n].fields);return t}dependentFields(){const e=new Set(this.fields);for(const t of o.e)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of["x","y"]){const n=this.childModel.component.scales[t];if(n&&!n.merged){const i=n.get("type"),r=n.get("range");if(Object(s.g)(i)&&Object(d.isVgRangeStep)(r)){const n=Object(b.a)(this.childModel,t),i=Object(b.b)(n);i?e[t]=i:a.e(`Unknown field for ${t}. Cannot calculate view size.`)}}}return e}assembleRowColumnHeaderData(e,t,n){const i={row:"y",column:"x"}[e],r=[],o=[],a=[];n&&n[i]&&(t?(r.push(`distinct_${n[i]}`),o.push("max")):(r.push(n[i]),o.push("distinct")),a.push(`distinct_${n[i]}`));const{sortField:s,sortIndexField:l}=this[e];if(s){const{op:e=u.a,field:t}=s;r.push(t),o.push(e),a.push(Object(c.vgField)(s,{forAs:!0}))}else l&&(r.push(l),o.push("max"),a.push(l));return{name:this[e].name,source:null!=t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},r.length?{fields:r,ops:o,as:a}:{})]}}assembleFacetHeaderData(e){var t,n;const{columns:i}=this.model.layout,{layoutHeaders:r}=this.model.component,o=[],c={};for(const e of f.a){for(const i of f.b){const o=null!=(t=r[e]&&r[e][i])?t:[];for(const t of o)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){c[e]=!0;break}}if(c[e]){const t=`length(data("${this.facet.name}"))`,n="row"===e?i?{signal:`ceil(${t} / ${i})`}:1:i?{signal:`min(${t}, ${i})`}:{signal:t};o.push({name:`${this.facet.name}_${e}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:a,column:s}=c;return(a||s)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}assemble(){var e,t;const n=[];let i=null;const r=this.getChildIndependentFieldsWithStep(),{column:c,row:a,facet:s}=this;if(c&&a&&(r.x||r.y)){i=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!=(e=r.x)?e:[],null!=(t=r.y)?t:[]),c=o.map(()=>"distinct");n.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:c}]})}for(const e of[o.c,o.q])this[e]&&n.push(this.assembleRowColumnHeaderData(e,i,r));if(s){const e=this.assembleFacetHeaderData(r);e&&n.push(...e)}return n}}},214:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(115),r=n(19);class o extends r.a{clone(){return new o(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([i.a])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:i.a}}}},227:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d});var i=n(4),r=n(1),o=n(16),c=n(344),a=n(529),s=n(178),u=n(77);function l(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?d(e,t,{defaultPos:n,defaultPos2:i}):Object(s.a)(e,t,{defaultPos:n})}function d(e,t,{defaultPos:n,defaultPos2:l}){const{markDef:d,config:b}=t,g="x"===e?"width":"height",p=function(e,t,n){const{encoding:a,mark:l,markDef:d,stack:b,config:g}=e,p="x2"===n?"x":"y",m="x2"===n?"width":"height",h=a[p],O=e.scaleName(p),j=e.getScaleComponent(p),v=Object(c.a)(n,e.markDef);if(!h&&(a.latitude||a.longitude))return{[n]:{field:e.getName(n)}};const y=function({channel:e,channelDef:t,channel2Def:n,markDef:r,config:o,scaleName:c,scale:a,stack:s,offset:l,defaultRef:d}){if(Object(i.isFieldDef)(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0))return u.b(t,c,{suffix:"start"},{offset:l});return u.e({channel:e,channelDef:n,scaleName:c,scale:a,stack:s,markDef:r,config:o,offset:l,defaultRef:d})}({channel:n,channelDef:h,channel2Def:a[n],markDef:d,config:g,scaleName:O,scale:j,stack:b,offset:v,defaultRef:void 0});if(void 0!==y)return{[n]:y};const x=Object(s.b)({model:e,defaultPos:t,channel:n,scaleName:O,scale:j,checkBarAreaWithoutZero:!a[n]})();return Object(r.k)(f(n,d),f(n,{[n]:Object(o.f)(n,d,g.style),[m]:Object(o.f)(m,d,g.style)}),f(n,g[l]),f(n,g.mark),{[n]:x})}(t,l,"x"===e?"x2":"y2"),m=p[g]?Object(a.a)(e,d,b):e;return Object.assign(Object.assign({},Object(s.a)(e,t,{defaultPos:n,vgChannel:m})),p)}function f(e,t){const n="x2"===e?"width":"height";return t[e]?{[e]:u.f(e,t[e])}:t[n]?{[n]:{value:t[n]}}:void 0}},24:function(e,t,n){"use strict";n.r(t),n.d(t,"isSignalRef",function(){return o}),n.d(t,"isVgRangeStep",function(){return c}),n.d(t,"isDataRefUnionedDomain",function(){return a}),n.d(t,"isFieldRefUnionDomain",function(){return s}),n.d(t,"isDataRefDomain",function(){return u}),n.d(t,"VG_MARK_CONFIGS",function(){return l}),n.d(t,"VG_CORNERRADIUS_CHANNELS",function(){return d});var i=n(0),r=n(1);function o(e){return e&&!!e.signal}function c(e){return!!e.step}function a(e){return!Object(i.A)(e)&&("fields"in e&&!("data"in e))}function s(e){return!Object(i.A)(e)&&("fields"in e&&"data"in e)}function u(e){return!Object(i.A)(e)&&("field"in e&&"data"in e)}const l=Object(r.r)({opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),d=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"]},247:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(14),r=n(123);class o{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!Object(r.a)(e)&&Object(i.w)(e.mark)===this.name}}},248:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(6),r=n(80),o=n(1031),c=n(543),a=n(1046),s=n(1059),u=n(553);function l(e,t,n,l,d,f){if(Object(r.b)(e))return new c.a(e,t,n,d,f);if(Object(r.d)(e))return new a.a(e,t,n,l,d,f);if(Object(r.f)(e))return new u.a(e,t,n,l,d,f);if(Object(r.e)(e))return new s.a(e,t,n,d,f);if(Object(r.a)(e))return new o.a(e,t,n,d,f);throw new Error(i.b.invalidSpec(e))}},249:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"a",function(){return p});var i=n(18),r=n(0),o=n(130),c=n(5),a=n(4),s=n(155),u=n(1),l=n(24),d=n(288);function f(e,t,n,i){var r,o,c;e.encode=null!=(r=e.encode)?r:{},e.encode[t]=null!=(o=e.encode[t])?o:{},e.encode[t].update=null!=(c=e.encode[t].update)?c:{},e.encode[t].update[n]=i}function b(e,t,n,c={header:!1}){var b,g;const p=e.combine(),{orient:m,scale:h,labelExpr:O,title:j,zindex:v}=p,y=Object(i.a)(p,["orient","scale","labelExpr","title","zindex"]);for(const e in y){const n=o.b[e],i=y[e];if(n&&n!==t&&"both"!==n)delete y[e];else if(Object(o.f)(i)){const{condition:t,value:n}=i,c=Object(r.i)(t),a=o.d[e];if(a){const{vgProp:t,part:i}=a;f(y,i,t,[...c.map(e=>{const{value:t,test:n}=e;return{test:Object(d.a)(null,n),value:t}}),{value:n}]),delete y[e]}else if(null===a){const t={signal:c.map(e=>{const{value:t,test:n}=e;return`${Object(d.a)(null,n)} ? ${Object(r.Y)(t)} : `}).join("")+Object(r.Y)(n)};y[e]=t}}else if(Object(l.isSignalRef)(i)){const t=o.d[e];if(t){const{vgProp:n,part:r}=t;f(y,r,n,i),delete y[e]}}}if("grid"===t){if(!y.grid)return;if(y.encode){const{grid:e}=y.encode;y.encode=Object.assign({},e?{grid:e}:{}),0===Object(u.r)(y.encode).length&&delete y.encode}return Object.assign(Object.assign({scale:h,orient:m},y),{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Object(u.k)(v,0)})}{if(!c.header&&e.mainExtracted)return;if(void 0!==O){let e=O;(null===(g=null===(b=y.encode)||void 0===b?void 0:b.labels)||void 0===g?void 0:g.update)&&Object(l.isSignalRef)(y.encode.labels.update.text)&&(e=Object(u.y)(O,"datum.label",y.encode.labels.update.text.signal)),f(y,"labels","text",{signal:e})}if(y.encode){for(const t of o.a)e.hasAxisPart(t)||delete y.encode[t];0===Object(u.r)(y.encode).length&&delete y.encode}const t=function(e,t){if(e)return Object(s.b)(e)?e:e.map(e=>Object(a.defaultTitle)(e,t)).join(", ")}(j,n);return Object.assign(Object.assign(Object.assign({scale:h,orient:m,grid:!1},t?{title:t}:{}),y),{zindex:Object(u.k)(v,0)})}}function g(e){const{axes:t}=e.component;for(const n of c.p)if(t[n])for(const i of t[n])if(!i.get("gridScale")){const t="x"===n?"height":"width";return[{name:t,update:e.getSizeSignalRef(t).signal}]}return[]}function p(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(e=>b(e,"grid",t)),...i.map(e=>b(e,"grid",t)),...n.map(e=>b(e,"main",t)),...i.map(e=>b(e,"main",t))].filter(e=>e)}},250:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1),r=n(288),o=n(19),c=n(532);class a extends o.a{constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=Object(r.a)(this.model,this.filter,this),this._dependentFields=Object(c.a)(this.expr)}clone(){return new a(null,this.model,Object(i.f)(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}},251:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d});var i=n(13),r=n(1),o=n(24),c=n(20),a=n(75);function s(e){return[...u(e,"width"),...u(e,"height")]}function u(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const s=e.getSizeSignalRef(t).signal;if("step"===r){const t=e.getScaleComponent(n);if(t){const r=t.get("type"),a=t.get("range");if(Object(i.g)(r)&&Object(o.isVgRangeStep)(a)){const i=e.scaleName(n);if(Object(c.d)(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[l(i,a)]}return[l(i,a),{name:s,update:d(i,t,`domain('${i}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const t=s.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",i=`isFinite(${n}) ? ${n} : ${Object(a.b)(e.config.view,t?"width":"height")}`;return[{name:s,init:i,on:[{update:i,events:"window:resize"}]}]}return[{name:s,value:r}]}function l(e,t){return{name:e+"_step",value:t.step}}function d(e,t,n){const i=t.get("type"),o=t.get("padding"),c=Object(r.k)(t.get("paddingOuter"),o);let a=t.get("paddingInner");return`bandspace(${n}, ${a="band"===i?void 0!==a?a:o:1}, ${c}) * ${e}_step`}},252:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n(5),r=n(6),o=n(1),c=n(20);function a(e,t){if(Object(c.e)(t)||Object(c.d)(t))return"shared";if(Object(c.c)(t)||Object(c.f)(t))return Object(o.c)(i.p,e)?"independent":"shared";throw new Error("invalid model type for resolve")}function s(e,t){const n=e.scale[t],c=Object(o.c)(i.p,t)?"axis":"legend";return"independent"===n?("shared"===e[c][t]&&r.e(r.b.independentScaleMeansIndependentGuide(t)),"independent"):e[c][t]||"shared"}},254:function(e,t,n){"use strict";function i(e){return!!e.or}function r(e){return!!e.and}function o(e){return!!e.not}function c(e,t){if(o(e))c(e.not,t);else if(r(e))for(const n of e.and)c(n,t);else if(i(e))for(const n of e.or)c(n,t);else t(e)}function a(e,t){return o(e)?{not:a(e.not,t)}:r(e)?{and:e.and.map(e=>a(e,t))}:i(e)?{or:e.or.map(e=>a(e,t))}:t(e)}n.d(t,"d",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"e",function(){return a})},255:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"d",function(){return m});var i=n(18),r=n(4),o=n(46),c=n(6),a=n(14),s=n(1),u=n(247),l=n(105);const d="errorbar",f=Object(s.r)({ticks:1,rule:1}),b=new u.a(d,g);function g(e,{config:t}){const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:c,markDef:a,outerSpec:s,tooltipEncoding:u}=m(e,d,t),f=Object(l.f)(a,r,i,o,t.errorbar),b={type:"tick",orient:c},g=[...f({partName:"ticks",mark:b,positionPrefix:"lower",extraEncoding:u}),...f({partName:"ticks",mark:b,positionPrefix:"upper",extraEncoding:u}),...f({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},s),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function p(e,t){const{encoding:n}=e;if(function(e){return(Object(r.isFieldDef)(e.x)||Object(r.isFieldDef)(e.y))&&!Object(r.isFieldDef)(e.x2)&&!Object(r.isFieldDef)(e.y2)&&!Object(r.isFieldDef)(e.xError)&&!Object(r.isFieldDef)(e.xError2)&&!Object(r.isFieldDef)(e.yError)&&!Object(r.isFieldDef)(e.yError2)}(n))return{orient:Object(l.b)(e,t),inputType:"raw"};const i=function(e){return Object(r.isFieldDef)(e.x2)||Object(r.isFieldDef)(e.y2)}(n),o=function(e){return Object(r.isFieldDef)(e.xError)||Object(r.isFieldDef)(e.xError2)||Object(r.isFieldDef)(e.yError)||Object(r.isFieldDef)(e.yError2)}(n),c=n.x,a=n.y;if(i){if(o)throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error");const e=n.x2,i=n.y2;if(Object(r.isFieldDef)(e)&&Object(r.isFieldDef)(i))throw new Error(t+" cannot have both x2 and y2");if(Object(r.isFieldDef)(e)){if(Object(r.isFieldDef)(c)&&Object(r.isContinuous)(c))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+t)}if(Object(r.isFieldDef)(i)){if(Object(r.isFieldDef)(a)&&Object(r.isContinuous)(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+t)}throw new Error("No ranged axis")}{const e=n.xError,i=n.xError2,o=n.yError,s=n.yError2;if(Object(r.isFieldDef)(i)&&!Object(r.isFieldDef)(e))throw new Error(t+" cannot have xError2 without xError");if(Object(r.isFieldDef)(s)&&!Object(r.isFieldDef)(o))throw new Error(t+" cannot have yError2 without yError");if(Object(r.isFieldDef)(e)&&Object(r.isFieldDef)(o))throw new Error(t+" cannot have both xError and yError with both are quantiative");if(Object(r.isFieldDef)(e)){if(Object(r.isFieldDef)(c)&&Object(r.isContinuous)(c))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Object(r.isFieldDef)(o)){if(Object(r.isFieldDef)(a)&&Object(r.isContinuous)(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function m(e,t,n){var u;const{mark:d,encoding:f,selection:b,projection:g}=e,m=Object(i.a)(e,["mark","encoding","selection","projection"]),O=Object(a.x)(d)?d:{type:d};b&&c.e(c.b.selectionNotSupported(t));const{orient:j,inputType:v}=p(e,t),{continuousAxisChannelDef:y,continuousAxisChannelDef2:x,continuousAxisChannelDefError:w,continuousAxisChannelDefError2:k,continuousAxis:S}=Object(l.a)(e,j,t),{errorBarSpecificAggregate:F,postAggregateCalculates:D,tooltipSummary:$,tooltipTitleWithFieldName:E}=function(e,t,n,i,o,a,u,l){let d=[],f=[];const b=t.field;let g,p=!1;if("raw"===a){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":l.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&c.e(c.b.errorBarCenterIsUsedWithWrongExtent(t,n,u)),"stderr"===n||"stdev"===n)d=[{op:n,field:b,as:"extent_"+b},{op:t,field:b,as:"center_"+b}],f=[{calculate:`datum["center_${b}"] + datum["extent_${b}"]`,as:"upper_"+b},{calculate:`datum["center_${b}"] - datum["extent_${b}"]`,as:"lower_"+b}],g=[{fieldPrefix:"center_",titlePrefix:Object(s.D)(t)},{fieldPrefix:"upper_",titlePrefix:h(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:h(t,n,"-")}],p=!0;else{let t,i,o;e.center&&e.extent&&c.e(c.b.errorBarCenterIsNotNeeded(e.extent,u)),"ci"===n?(t="mean",i="ci0",o="ci1"):(t="median",i="q1",o="q3"),d=[{op:i,field:b,as:"lower_"+b},{op:o,field:b,as:"upper_"+b},{op:t,field:b,as:"center_"+b}],g=[{fieldPrefix:"upper_",titlePrefix:Object(r.title)({field:b,aggregate:o,type:"quantitative"},l,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Object(r.title)({field:b,aggregate:i,type:"quantitative"},l,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Object(r.title)({field:b,aggregate:t,type:"quantitative"},l,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&c.e(c.b.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===a?(g=[],f=[{calculate:`datum["${n.field}"]`,as:"upper_"+b},{calculate:`datum["${b}"]`,as:"lower_"+b}]):"aggregated-error"===a&&(g=[{fieldPrefix:"",titlePrefix:b}],f=[{calculate:`datum["${b}"] + datum["${i.field}"]`,as:"upper_"+b}],o?f.push({calculate:`datum["${b}"] + datum["${o.field}"]`,as:"lower_"+b}):f.push({calculate:`datum["${b}"] - datum["${i.field}"]`,as:"lower_"+b}));for(const e of f)g.push({fieldPrefix:e.as.substring(0,6),titlePrefix:Object(s.y)(Object(s.y)(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:f,errorBarSpecificAggregate:d,tooltipSummary:g,tooltipTitleWithFieldName:p}}(O,y,x,w,k,v,t,n),C=S,N=(f[C],"x"===S?"x2":"y2"),_=(f[N],"x"===S?"xError":"yError"),z=(f[_],"x"===S?"xError2":"yError2"),A=(f[z],Object(i.a)(f,["symbol"==typeof C?C:C+"","symbol"==typeof N?N:N+"","symbol"==typeof _?_:_+"","symbol"==typeof z?z:z+""])),{bins:T,timeUnits:R,aggregate:P,groupby:M,encoding:L}=Object(o.b)(A,n),U=[...P,...F],H="raw"!==v?[]:M,q=Object(l.d)($,y,L,E);return{transform:[...(u=m.transform,null!=u?u:[]),...T,...R,...0===U.length?[]:[{aggregate:U,groupby:H}],...D],groupby:H,continuousAxisChannelDef:y,continuousAxis:S,encodingWithoutContinuousAxis:L,ticksOrient:"vertical"===j?"horizontal":"vertical",markDef:O,outerSpec:m,tooltipEncoding:q}}function h(e,t,n){return Object(s.D)(e)+" "+n+" "+t}},256:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(0),r=n(4),o=n(1),c=n(16),a=n(19);class s extends a.a{constructor(e,t){super(e),this._stack=t}clone(){return new s(null,Object(o.f)(this._stack))}static makeFromTransform(e,t){const{stack:n,groupby:r,as:c,offset:a="zero"}=t,u=[],l=[];if(void 0!==t.sort)for(const e of t.sort)u.push(e.field),l.push(Object(o.k)(e.order,"ascending"));const d={field:u,order:l};let f;return f=function(e){return Object(i.A)(e)&&e.every(e=>Object(i.H)(e))&&e.length>1}(c)?c:Object(i.H)(c)?[c,c+"_end"]:[t.stack+"_start",t.stack+"_end"],new s(e,{stackField:n,groupby:r,offset:a,sort:d,facetby:[],as:f})}static makeFromEncoding(e,t){const n=t.stack,{encoding:o}=t;if(!n)return null;let a;if(n.groupbyChannel){const e=o[n.groupbyChannel];a=Object(r.getTypedFieldDef)(e)}const u=function(e){return e.stack.stackBy.reduce((e,t)=>{const n=t.fieldDef,i=Object(r.vgField)(n);return i&&e.push(i),e},[])}(t),l=t.encoding.order;let d;return d=Object(i.A)(l)||Object(r.isFieldDef)(l)?Object(c.m)(l):u.reduce((e,t)=>(e.field.push(t),e.order.push("descending"),e),{field:[],order:[]}),new s(e,{dimensionFieldDef:a,stackField:t.vgField(n.fieldChannel),facetby:[],stackby:u,sort:d,offset:n.offset,impute:n.impute,as:[t.vgField(n.fieldChannel,{suffix:"start",forAs:!0}),t.vgField(n.fieldChannel,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(t=>e.add(t)),this._stack.facetby.forEach(t=>e.add(t)),this._stack.sort.field.forEach(t=>e.add(t)),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Object(o.m)(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:e,impute:t,groupby:n}=this._stack;return e?e.bin?t?[Object(r.vgField)(e,{binSuffix:"mid"})]:[Object(r.vgField)(e,{}),Object(r.vgField)(e,{binSuffix:"end"})]:[Object(r.vgField)(e)]:null!=n?n:[]}assemble(){const e=[],{facetby:t,dimensionFieldDef:n,stackField:i,stackby:o,sort:c,offset:a,impute:s,as:u}=this._stack;if(s&&n){const{band:c=.5,bin:a}=n;a&&e.push({type:"formula",expr:`${c}*`+Object(r.vgField)(n,{expr:"datum"})+`+${1-c}*`+Object(r.vgField)(n,{expr:"datum",binSuffix:"end"}),as:Object(r.vgField)(n,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:i,groupby:[...o,...t],key:Object(r.vgField)(n,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:i,sort:c,as:u,offset:a}),e}}},26:function(e,t,n){"use strict";var i=n(872);n.d(t,"a",function(){return i.a});var r=n(320);n.d(t,"b",function(){return r.a});var o=n(172);n.d(t,"k",function(){return o.a});var c=n(594);n.d(t,"c",function(){return c.a}),n.d(t,"j",function(){return c.b});var a=n(98);n.d(t,"d",function(){return a.a});var s=n(178);n.d(t,"f",function(){return s.a});var u=n(227);n.d(t,"e",function(){return u.a});var l=n(377);n.d(t,"g",function(){return l.a});var d=n(204);n.d(t,"h",function(){return d.a});var f=n(269);n.d(t,"i",function(){return f.a})},269:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n(0),r=n(21),o=n(5),c=n(4),a=n(46),s=n(1),u=n(16),l=n(172),d=n(204);function f(e,t={}){const{encoding:n,markDef:r,config:o}=e,c=n.tooltip;return Object(i.A)(c)?{tooltip:b({tooltip:c},o,t)}:Object(l.a)(e,c,"tooltip",c=>{const a=Object(d.b)(c,e.config,t.reactiveGeom?"datum.datum":"datum");if(a)return a;if(null===c)return;let l=Object(s.k)(r.tooltip,Object(u.d)("tooltip",r,o));return!0===l&&(l={content:"encoding"}),Object(i.H)(l)?{value:l}:Object(i.F)(l)?"encoding"===l.content?b(n,o,t):{signal:"datum"}:void 0})}function b(e,t,{reactiveGeom:n}={}){const s=[],l={},f={},b=n?"datum.datum":"datum",g=[];function p(n,a){const s=Object(o.D)(a),l=Object(c.isTypedFieldDef)(n)?n:Object.assign(Object.assign({},n),{type:e[s].type}),p=Object(i.i)(Object(c.title)(l,t,{allowDisabling:!1})).join(", ");let m=Object(d.b)(l,t,b).signal;if("x"===a||"y"===a){const n="x"===a?"x2":"y2",i=Object(c.getFieldDef)(e[n]);if(Object(r.d)(l.bin)&&i){const e=Object(c.vgField)(l,{expr:b}),r=Object(c.vgField)(i,{expr:b});m=Object(u.b)(e,r,Object(c.format)(l),t),f[n]=!0}}g.push({channel:a,key:p,value:m})}Object(a.d)(e,(e,t)=>{Object(c.isFieldDef)(e)?p(e,t):Object(c.hasConditionalFieldDef)(e)&&p(e.condition,t)});for(const{channel:e,key:t,value:n}of g)f[e]||l[t]||(s.push(`${Object(i.Y)(t)}: ${n}`),l[t]=!0);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}},288:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(0),r=n(104),o=n(1),c=n(147);function a(e,t,n){return Object(o.s)(t,t=>Object(i.H)(t)?t:Object(r.g)(t)?Object(c.c)(e,t.selection,n):Object(r.a)(t))}},289:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(32);const r="_toggle",o={has:e=>"multi"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+r,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+i.c,o=t.name+r;return`${o} ? null : ${n}, `+("global"===t.resolve?`${o} ? null : true, `:`${o} ? null : {unit: ${Object(i.g)(e)}}, `)+`${o} ? ${n} : null`}};t.b=o},290:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return b});var i=n(6),r=n(657),o=n(101),c=n(139);const a="scale_",s=5;function u(e){const t=[];return e.forEach(function e(n){0===n.numChildren()?t.push(n):n.children.forEach(e)}),t}function l(e){return e}function d(e,t){return t.map(t=>{if(e instanceof o.a){const n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)}).some(l)}function f(e,t){let n=e.sources;const i=new Set;return i.add(d(new c.j,n)),i.add(d(new c.i(t),n)),n=n.filter(e=>e.numChildren()>0),i.add(d(new c.k,u(n))),n=n.filter(e=>e.numChildren()>0),i.add(d(new c.g,u(n))),i.add(d(new c.b(t),u(n))),i.add(d(new c.h,u(n))),i.add(d(new c.e,u(n))),i.add(d(new c.a,u(n))),i.add(d(new c.f,u(n))),i.add(d(new c.c,n)),i.add(d(new c.d,u(n))),e.sources=n,i.has(!0)}function b(e,t){Object(r.a)(e.sources);let n=0,o=0;for(let i=0;i<s&&f(e,t);i++)n++;e.sources.map(c.l);for(let n=0;n<s&&f(e,t);n++)o++;Object(r.a)(e.sources),Math.max(n,o)===s&&i.e(`Maximum optimization runs(${s}) reached.`)}},291:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(51),r=n(4),o=n(1),c=n(19);class a extends c.a{constructor(e,t){super(e),this.transform=t}clone(){return new a(null,Object(o.f)(this.transform))}addDimensions(e){this.transform.groupby=Object(o.E)(this.transform.groupby.concat(e),e=>e)}dependentFields(){var e,t;const n=new Set;return(e=this.transform.groupby,null!=e?e:[]).forEach(e=>n.add(e)),(t=this.transform.sort,null!=t?t:[]).forEach(e=>n.add(e.field)),this.transform.window.map(e=>e.field).filter(e=>void 0!==e).forEach(e=>n.add(e)),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var t;return null!=(t=e.as)?t:Object(r.vgField)(e)}hash(){return`WindowTransform ${Object(o.m)(this.transform)}`}assemble(){var e;const t=[],n=[],r=[],o=[];for(const e of this.transform.window)n.push(e.op),r.push(this.getDefaultName(e)),o.push(void 0===e.param?null:e.param),t.push(void 0===e.field?null:e.field);const c=this.transform.frame,a=this.transform.groupby;if(c&&null===c[0]&&null===c[1]&&n.every(e=>Object(i.d)(e)))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==a?{groupby:a}:{});const s=[],u=[];if(void 0!==this.transform.sort)for(const t of this.transform.sort)s.push(t.field),u.push(null!=(e=t.order)?e:"ascending");const l={field:s,order:u},d=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:r,ops:n,fields:t,sort:l},void 0!==d?{ignorePeers:d}:{}),void 0!==a?{groupby:a}:{}),void 0!==c?{frame:c}:{})}}},295:function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return y}),n.d(t,"c",function(){return S});var i=n(0),r=n(5),o=n(4),c=n(411),a=n(54),s=n(93),u=n(1),l=n(120),d=n(16),f=n(111),b=n(20),g=n(106),p=n(193);function m(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Object(g.b)(["titleAnchor","titleAngle","titleOrient"],r,i,t),u=Object(g.a)(t,s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),O(a,u)),h(u,a,o)),F(i,r,t,c.c,c.d))}}function h(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Object(l.b)(t,"row"===e?"left":"top");return i?{align:i}:{}}function O(e,t){const n=Object(l.c)(e,"row"===t?"left":"top");return n?{baseline:n}:{}}function j(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of p.b)if(n[r])for(const o of n[r])i.push(x(e,t,r,n,o));return i}function v(e,t){var n;const{sort:r}=e;return Object(a.e)(r)?{field:Object(o.vgField)(r,{expr:"datum"}),order:(n=r.order,null!=n?n:"ascending")}:Object(i.A)(r)?{field:Object(f.b)(e,t,{expr:"datum"}),order:"ascending"}:{field:Object(o.vgField)(e,{expr:"datum"}),order:null!=r?r:"ascending"}}function y(e,t,n){const{format:i,labelAngle:r,labelAnchor:a,labelOrient:s,labelExpr:l}=Object(g.b)(["format","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),f=Object(d.c)(e,i,"parent",n).signal,b=Object(g.a)(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?Object(u.y)(Object(u.y)(l,"datum.label",f),"datum.value",Object(o.vgField)(e,{expr:"parent"})):f}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),O(r,b)),h(b,r,a)),F(n,e,t,c.a,c.b))}function x(e,t,n,i,r){var o;if(r){let c=null;const{facetFieldDef:a}=i,l=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:e}=Object(g.b)(["labelOrient"],a,l,t);("row"===t&&!Object(u.c)(["top","bottom"],e)||"column"===t&&!Object(u.c)(["left","right"],e))&&(c=y(a,t,l))}const d=Object(b.d)(e)&&!Object(s.b)(e.facet),f=r.axes,p=(null===(o=f)||void 0===o?void 0:o.length)>0;if(c||p){const o="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:v(a,t)}:{}),p&&d?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),c?{title:c}:{}),r.sizeSignal?{encode:{update:{[o]:r.sizeSignal}}}:{}),p?{axes:f}:{})}}return null}const w={column:{start:0,end:1},row:{start:1,end:0}};function k(e,t){return w[t][e]}function S(e,t){var n;const i={};for(const o of r.e){const r=e[o];if(null===(n=r)||void 0===n?void 0:n.facetFieldDef){const{titleAnchor:e,titleOrient:n}=Object(g.b)(["titleAnchor","titleOrient"],r.facetFieldDef,t,o),c=Object(g.a)(o,n),a=k(e,c);void 0!==a&&(i[c]=a)}}return Object(u.r)(i).length>0?i:void 0}function F(e,t,n,i,r){const o={};for(const c of i){if(!r[c])continue;const i=Object(g.c)(c,t,e,n);void 0!==i&&(o[r[c]]=i)}return o}},31:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return l});var i=n(6),r=n(1);class o{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new o(Object(r.f)(this.explicit),Object(r.f)(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(e){return Object(r.k)(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of Object(r.r)(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function c(e){return{explicit:!0,value:e}}function a(e){return{explicit:!1,value:e}}function s(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:u(t,n,i,r)}}function u(e,t,n,r){return e.explicit&&t.explicit&&i.e(i.b.mergeConflictingProperty(n,r,e.value,t.value)),e}function l(e,t,n,i,o=u){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Object(r.d)(e.value,t.value)?e:o(e,t,n,i)}},32:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"f",function(){return h});var i=n(0),r=n(5),o=n(115),c=n(20),a=n(343),s=n(531),u=n(1035);const l="_store",d="_tuple",f="_modify",b="vlSelectionResolve",g={single:u.a,multi:s.a,interval:a.b};function p(e,t){const n=e.component.selection;if(n)for(const e in n)if(Object(i.v)(n,e)){const i=n[e];if(!0===t(i,g[i.type]))break}}function m(e,{escape:t}={escape:!0}){let n=t?Object(i.Y)(e.name):e.name;const o=function(e){let t=e.parent;for(;t&&!Object(c.d)(t);)t=t.parent;return t}(e);if(o){const{facet:e}=o;for(const t of r.e)e[t]&&(n+=` + '__facet_${t}_' + (facet[${Object(i.Y)(o.vgField(t))}])`)}return n}function h(e){let t=!1;return p(e,e=>{t=t||e.project.items.some(e=>e.field===o.a)}),t}},320:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(6),r=n(1),o=n(16),c=n(98);function a(e,t={filled:void 0}){const{markDef:n,encoding:a,config:s}=e,{type:u}=n,l=Object(r.k)(t.filled,n.filled),d={fill:Object(o.d)("fill",n,s),stroke:Object(o.d)("stroke",n,s),color:Object(o.d)("color",n,s)},f=Object(r.c)(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,b=Object(r.k)(n.fill,!0===l?n.color:void 0,d.fill,!0===l?d.color:void 0,f),g=Object(r.k)(n.stroke,!1===l?n.color:void 0,d.stroke,!1===l?d.color:void 0),p=l?"fill":"stroke",m=Object.assign(Object.assign({},b?{fill:Object(o.l)(b)}:{}),g?{stroke:Object(o.l)(g)}:{});return n.color&&(l?n.fill:n.stroke)&&i.e(i.b.droppingColor("property",{fill:"fill"in n,stroke:"stroke"in n})),Object.assign(Object.assign(Object.assign(Object.assign({},m),Object(c.a)("color",e,{vgChannel:p,defaultValue:l?b:g})),Object(c.a)("fill",e,{defaultValue:a.fill?b:void 0})),Object(c.a)("stroke",e,{defaultValue:a.stroke?g:void 0}))}},33:function(e,t,n){"use strict";function i(e){return!!e.url}function r(e){return!!e.values}function o(e){return!(!e.name||i(e)||r(e)||c(e))}function c(e){return e&&(a(e)||s(e)||u(e))}function a(e){return!!e.sequence}function s(e){return!!e.sphere}function u(e){return!!e.graticule}n.d(t,"i",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"g",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d});const l="main",d="raw"},332:function(e,t,n){"use strict";function i(e){return void 0!==e.repeat}n.d(t,"a",function(){return i})},343:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n(18),r=n(0),o=n(32),c=n(5),a=n(6),s=n(13),u=n(1),l=n(99),d=n(184),f=n(117);const b="_brush",g="_scale_trigger",p={signals:(e,t)=>{const n=t.name,i=n+d.a,u=f.a.has(t),p=[],h=[],O=[];if(t.translate&&!u){const e=`!event.item || event.item.mark.name !== ${Object(r.Y)(n+b)}`;m(t,(t,n)=>{var i;const o=Object(r.i)(null!=(i=n.between[0].filter)?i:n.between[0].filter=[]);return o.indexOf(e)<0&&o.push(e),t})}t.project.items.forEach((n,i)=>{const o=n.channel;if(o!==c.z&&o!==c.B)return void Object(a.e)("Interval selections only support x and y encoding channels.");const u=t.init?t.init[i]:null,d=function(e,t,n,i){const o=n.channel,a=n.signals.visual,u=n.signals.data,d=f.a.has(t),b=Object(r.Y)(e.scaleName(o)),p=e.getScaleComponent(o),h=p?p.get("type"):void 0,O=e=>`scale(${b}, ${e})`,j=e.getSizeSignalRef(o===c.z?"width":"height").signal,v=`${o}(unit)`,y=m(t,(e,t)=>[...e,{events:t.between[0],update:`[${v}, ${v}]`},{events:t,update:`[${a}[0], clamp(${v}, 0, ${j})]`}]);return y.push({events:{signal:t.name+g},update:Object(s.f)(h)?`[${O(`${u}[0]`)}, ${O(`${u}[1]`)}]`:"[0, 0]"}),d?[{name:u,on:[]}]:[Object.assign(Object.assign({name:a},i?{init:Object(l.b)(i,!0,O)}:{value:[]}),{on:y}),Object.assign(Object.assign({name:u},i?{init:Object(l.b)(i)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${b}, ${a})`}]})]}(e,t,n,u),b=n.signals.data,j=n.signals.visual,v=Object(r.Y)(e.scaleName(o)),y=e.getScaleComponent(o).get("type"),x=Object(s.f)(y)?"+":"";p.push(...d),h.push(b),O.push({scaleName:e.scaleName(o),expr:`(!isArray(${b}) || `+`(${x}invert(${v}, ${j})[0] === ${x}${b}[0] && `+`${x}invert(${v}, ${j})[1] === ${x}${b}[1]))`})}),u||p.push({name:n+g,value:{},on:[{events:O.map(e=>({scale:e.scaleName})),update:O.map(e=>e.expr).join(" && ")+` ? ${n+g} : {}`}]});const j=t.init,v=`unit: ${Object(o.g)(e)}, fields: ${i}, values`;return p.concat(Object.assign(Object.assign({name:n+o.c},j?{init:`{${v}: ${Object(l.b)(j)}}`}:{}),{on:[{events:[{signal:h.join(" || ")}],update:h.join(" && ")+` ? {${v}: [${h}]} : null`}]}))},modifyExpr:(e,t)=>{return t.name+o.c+", "+("global"===t.resolve?"true":`{unit: ${Object(o.g)(e)}}`)},marks:(e,t,n)=>{const c=t.name,{x:a,y:s}=t.project.hasChannel,l=a&&a.signals.visual,d=s&&s.signals.visual,g=`data(${Object(r.Y)(t.name+o.b)})`;if(f.a.has(t))return n;const p={x:void 0!==a?{signal:`${l}[0]`}:{value:0},y:void 0!==s?{signal:`${d}[0]`}:{value:0},x2:void 0!==a?{signal:`${l}[1]`}:{field:{group:"width"}},y2:void 0!==s?{signal:`${d}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const t of Object(u.r)(p))p[t]=[Object.assign({test:`${g}.length && ${g}[0].unit === ${Object(o.g)(e)}`},p[t]),{value:0}];const m=t.mark,{fill:h,fillOpacity:O,cursor:j}=m,v=Object(i.a)(m,["fill","fillOpacity","cursor"]),y=Object(u.r)(v).reduce((e,t)=>(e[t]=[{test:[void 0!==a&&`${l}[0] !== ${l}[1]`,void 0!==s&&`${d}[0] !== ${d}[1]`].filter(e=>e).join(" && "),value:v[t]},{value:null}],e),{});return[{name:c+b+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:O}},update:p}},...n,{name:c+b,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},j?{cursor:{value:j}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},p),y)}}]}};function m(e,t){return e.events.reduce((e,n)=>n.between?t(e,n):(Object(a.e)(`${n} is not an ordered event stream for interval selections.`),e),[])}t.b=p},344:function(e,t,n){"use strict";function i(e,t){const n=t[e+"Offset"];if(n)return n}n.d(t,"a",function(){return i})},345:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){super(e),this.params=t}clone(){return new o(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Object(i.m)(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}},346:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){super(e),this.params=t}clone(){return new o(null,this.params)}dependentFields(){return new Set}producedFields(){var e;return new Set([(e=this.params.as,null!=e?e:"data")])}hash(){return`Hash ${Object(i.m)(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}},359:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return p});var i=n(18),r=n(0),o=n(46),c=n(6),a=n(14),s=n(1),u=n(247),l=n(105);const d="boxplot",f=Object(s.r)({box:1,median:1,outliers:1,rule:1,ticks:1}),b=new u.a(d,p);function g(e){return Object(r.E)(e)?"tukey":e}function p(e,{config:t}){var n,u;const{mark:f,encoding:b,selection:p,projection:h}=e,O=Object(i.a)(e,["mark","encoding","selection","projection"]),j=Object(a.x)(f)?f:{type:f};p&&c.e(c.b.selectionNotSupported("boxplot"));const v=null!=(n=j.extent)?n:t.boxplot.extent,y=Object(s.k)(j.size,t.boxplot.size),x=g(v),{transform:w,continuousAxisChannelDef:k,continuousAxis:S,groupby:F,aggregate:D,encodingWithoutContinuousAxis:$,ticksOrient:E,boxOrient:C,customTooltipWithoutAggregatedField:N}=function(e,t,n){const r=Object(l.b)(e,d),{continuousAxisChannelDef:c,continuousAxis:a}=Object(l.a)(e,r,d),s=c.field,u=g(t),f=[...m(s),{op:"median",field:s,as:"mid_box_"+s},{op:"min",field:s,as:("min-max"===u?"lower_whisker_":"min_")+s},{op:"max",field:s,as:("min-max"===u?"upper_whisker_":"max_")+s}],b="min-max"===u||"tukey"===u?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:"iqr_"+s},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:"upper_whisker_"+s},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:"lower_whisker_"+s}],p=e.encoding,h=a,O=(p[h],Object(i.a)(p,["symbol"==typeof h?h:h+""])),{customTooltipWithoutAggregatedField:j,filteredEncoding:v}=Object(l.c)(O),{bins:y,timeUnits:x,aggregate:w,groupby:k,encoding:S}=Object(o.b)(v,n),F="vertical"===r?"horizontal":"vertical",D=r;return{transform:[...y,...x,{aggregate:[...w,...f],groupby:k},...b],groupby:k,aggregate:w,continuousAxisChannelDef:c,continuousAxis:a,encodingWithoutContinuousAxis:S,ticksOrient:F,boxOrient:D,customTooltipWithoutAggregatedField:j}}(e,v,t),{color:_,size:z}=$,A=Object(i.a)($,["color","size"]),T=e=>Object(l.f)(j,S,k,e,t.boxplot),R=T(A),P=T($),M=T(Object.assign(Object.assign({},A),z?{size:z}:{})),L=Object(l.d)([{fieldPrefix:"min-max"===x?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===x?"lower_whisker_":"min_",titlePrefix:"Min"}],k,$),U={type:"tick",color:"black",opacity:1,orient:E,invalid:null},H="min-max"===x?L:Object(l.d)([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],k,$),q=[...R({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:H}),...R({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:H}),...R({partName:"ticks",mark:U,positionPrefix:"lower_whisker",extraEncoding:H}),...R({partName:"ticks",mark:U,positionPrefix:"upper_whisker",extraEncoding:H})],W=[..."tukey"!==x?q:[],...P({partName:"box",mark:Object.assign(Object.assign({type:"bar"},y?{size:y}:{}),{orient:C,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:L}),...M({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Object(r.F)(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),y?{size:y}:{}),{orient:E}),positionPrefix:"mid_box",extraEncoding:L})];let I;if("min-max"!==x){const e=`datum["lower_box_${k.field}"]`,n=`datum["upper_box_${k.field}"]`,r=`(${n} - ${e})`,o=`${e} - ${v} * ${r}`,c=`${n} + ${v} * ${r}`,a=`datum["${k.field}"]`,s={joinaggregate:m(k.field),groupby:F};let u=void 0;"tukey"===x&&(u={transform:[{filter:`(${o} <= ${a}) && (${a} <= ${c})`},{aggregate:[{op:"min",field:k.field,as:"lower_whisker_"+k.field},{op:"max",field:k.field,as:"upper_whisker_"+k.field},{op:"min",field:"lower_box_"+k.field,as:"lower_box_"+k.field},{op:"max",field:"upper_box_"+k.field,as:"upper_box_"+k.field},...D],groupby:F}],layer:q});const{tooltip:d}=A,f=Object(i.a)(A,["tooltip"]),{scale:b,axis:g}=k,p=Object(l.e)(k),h=Object(l.g)(j,"outliers",t.boxplot,{transform:[{filter:`(${a} < ${o}) || (${a} > ${c})`}],mark:"point",encoding:Object.assign(Object.assign({[S]:Object.assign(Object.assign(Object.assign({field:k.field,type:k.type},void 0!==p?{title:p}:{}),void 0!==b?{scale:b}:{}),void 0!==g?{axis:g}:{})},f),N?{tooltip:N}:{})})[0];h&&u?I={transform:[s],layer:[h,u]}:h?(I=h).transform.unshift(s):u&&(I=u).transform.unshift(s)}return I?Object.assign(Object.assign({},O),{layer:[I,{transform:w,layer:W}]}):Object.assign(Object.assign({},O),{transform:(u=O.transform,null!=u?u:[]).concat(w),layer:W})}function m(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}},360:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d});var i=n(6),r=n(1),o=n(247),c=n(105),a=n(255);const s="errorband",u=Object(r.r)({band:1,borders:1}),l=new o.a(s,d);function d(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:u,markDef:l,outerSpec:d,tooltipEncoding:f}=Object(a.d)(e,s,t),b=l,g=Object(c.f)(b,o,r,u,t.errorband),p=void 0!==e.encoding.x&&void 0!==e.encoding.y;let m={type:p?"area":"rect"},h={type:p?"line":"rule"};const O=Object.assign(Object.assign({},b.interpolate?{interpolate:b.interpolate}:{}),b.tension&&b.interpolate?{interpolate:b.tension}:{});return p?(m=Object.assign(Object.assign({},m),O),h=Object.assign(Object.assign({},h),O)):b.interpolate?i.e(i.b.errorBand1DNotSupport("interpolate")):b.tension&&i.e(i.b.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},d),{transform:n,layer:[...g({partName:"band",mark:m,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f}),...g({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:f}),...g({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:f})]})}},361:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n(1032),r=n(527),o=n(528),c=n(184),a=n(117),s=n(530),u=n(289),l=n(1033),d=n(1034);const f=[c.b,u.b,a.a,s.a,l.a,d.a,r.a,o.a,i.a];function b(e,t){for(const n of f)n.has(e)&&t(n)}},377:function(e,t,n){"use strict";n.d(t,"a",function(){return j});var i=n(0),r=n(21),o=n(5),c=n(4),a=n(75),s=n(6),u=n(13),l=n(1),d=n(24),f=n(16),b=n(98),g=n(344),p=n(529),m=n(178),h=n(227),O=n(77);function j(e,t,n){var i,a,d,j;const{config:k,encoding:S,markDef:F}=e,D="x"===t?"x2":"y2",$="x"===t?"width":"height",E=S[t],C=S[D],N=e.getScaleComponent(t),_=N?N.get("type"):void 0,z=e.scaleName(t),A=F.orient,T=null!=(j=null!=(d=null!=(a=null!=(i=S[$])?i:S.size)?a:F[$])?d:F.size)?j:Object(f.d)("size",F,k,{vgChannel:$}),R="x"===t?"vertical"===A:"horizontal"===A;if(Object(c.isFieldDef)(E)&&(Object(r.e)(E.bin)||Object(r.d)(E.bin)||E.timeUnit&&!C)&&!T&&!Object(u.g)(_)){return function({fieldDef:e,fieldDef2:t,channel:n,band:i,scaleName:a,markDef:u,spacing:l=0,reverse:d}){const f=n===o.z?o.A:o.C;return Object(r.e)(e.bin)||e.timeUnit?{[f]:w({channel:n,fieldDef:e,scaleName:a,markDef:u,band:(1-i)/2,offset:x(f,l,d)}),[n]:w({channel:n,fieldDef:e,scaleName:a,markDef:u,band:1-(1-i)/2,offset:x(n,l,d)})}:Object(r.d)(e.bin)&&Object(c.isFieldDef)(t)?{[f]:O.b(e,a,{},{offset:x(f,l,d)}),[n]:O.b(t,a,{},{offset:x(n,l,d)})}:void s.e(s.b.channelRequiredForBinned(f))}({fieldDef:E,fieldDef2:C,channel:t,markDef:F,scaleName:z,band:Object(c.getBand)(t,E,void 0,F,k),spacing:Object(l.k)(F.binSpacing,k[n].binSpacing),reverse:N.get("reverse")})}if((Object(c.isFieldDef)(E)&&Object(u.g)(_)||R)&&!C){if(Object(c.isFieldDef)(E)&&_===u.b.BAND){return function(e,t,n,i){var r;const o=n.scaleName(t),a="x"===t?"width":"height",{markDef:u,encoding:l,config:d}=n,f=Object(p.a)(t,u,d),m=Object(g.a)(t,u),h={[f]:O.b(e,o,{},{band:.5,offset:m})};if(l.size||null!==u.size&&void 0!==u.size){const e=u.orient;if(e){if(Object(c.getTypedFieldDef)(l.size)||Object(c.isValueDef)(l.size))return Object.assign(Object.assign({},h),Object(b.a)("size",n,{vgChannel:a}));if(void 0!==u.size)return Object.assign(Object.assign({},h),{[a]:{value:u.size}})}else s.e(s.b.cannotApplySizeToNonOrientedMark(u.type))}if(void 0!==(null===(r=i)||void 0===r?void 0:r.value))return Object.assign(Object.assign({},h),{[a]:i});const{band:j=1}=e;return{[t]:O.b(e,o,{binSuffix:"range"},{band:(1-j)/2,offset:m}),[a]:null!=i?i:y(o,j)}}(E,t,e,v(n,F,$,z,N,k,Object(c.isPositionFieldDef)(E)?E.band:void 0))}return function(e,t,n){const i="x"===e?"xc":"yc",r="x"===e?"width":"height";return Object.assign(Object.assign({},Object(m.a)(e,t,{defaultPos:"mid",vgChannel:i})),Object(b.a)("size",t,{defaultRef:n,vgChannel:r}))}(t,e,v(n,F,$,z,N,k))}return Object(h.b)(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function v(e,t,n,r,o,c,s){const b=Object(l.k)(t[n],t.size,Object(f.d)("size",t,c,{vgChannel:n}));if(void 0!==b)return Object(f.l)(b);if(o){const t=o.get("type");if("point"===t||"band"===t){if(void 0!==c[e].discreteBandSize)return{value:c[e].discreteBandSize};if(t===u.b.POINT){const e=o.get("range");return Object(d.isVgRangeStep)(e)&&Object(i.E)(e.step)?{value:e.step-2}:{value:a.a-2}}return y(r,s)}return{value:c[e].continuousBandSize}}const g=Object(a.d)(c.view,n);return{value:Object(l.k)(c[e].discreteBandSize,g-2)}}function y(e,t=!0){return{scale:e,band:t}}function x(e,t,n){if(Object(d.isSignalRef)(n))return"x"===e||"y2"===e?{signal:`${n.signal} ? ${t} : 0`}:{signal:`${n.signal} ? 0 : ${t}`};return{x:n?t:0,x2:n?0:t,y:n?0:t,y2:n?t:0}[e]}function w({channel:e,fieldDef:t,scaleName:n,markDef:i,band:r,offset:o}){const c=O.c({scaleName:n,fieldDef:t,band:r,offset:o});return O.g({fieldDef:t,channel:e,markDef:i,ref:c})}},4:function(e,t,n){"use strict";n.r(t),n.d(t,"isConditionalSelection",function(){return m}),n.d(t,"isRepeatRef",function(){return h}),n.d(t,"toFieldDefBase",function(){return O}),n.d(t,"isSortableFieldDef",function(){return j}),n.d(t,"getBand",function(){return v}),n.d(t,"hasBand",function(){return y}),n.d(t,"isConditionalDef",function(){return x}),n.d(t,"hasConditionalFieldDef",function(){return w}),n.d(t,"hasConditionalValueDef",function(){return k}),n.d(t,"isFieldDef",function(){return S}),n.d(t,"isTypedFieldDef",function(){return F}),n.d(t,"isStringFieldDef",function(){return D}),n.d(t,"isValueDef",function(){return $}),n.d(t,"isScaleFieldDef",function(){return E}),n.d(t,"isPositionFieldDef",function(){return C}),n.d(t,"isMarkPropFieldDef",function(){return N}),n.d(t,"isTextFieldDef",function(){return _}),n.d(t,"vgField",function(){return z}),n.d(t,"isDiscrete",function(){return A}),n.d(t,"isContinuous",function(){return T}),n.d(t,"isCount",function(){return R}),n.d(t,"verbalTitleFormatter",function(){return P}),n.d(t,"functionalTitleFormatter",function(){return M}),n.d(t,"defaultTitleFormatter",function(){return L}),n.d(t,"setTitleFormatter",function(){return H}),n.d(t,"resetTitleFormatter",function(){return q}),n.d(t,"title",function(){return W}),n.d(t,"getGuide",function(){return I}),n.d(t,"defaultTitle",function(){return B}),n.d(t,"format",function(){return G}),n.d(t,"defaultType",function(){return Y}),n.d(t,"getFieldDef",function(){return V}),n.d(t,"getTypedFieldDef",function(){return J}),n.d(t,"normalize",function(){return Q}),n.d(t,"normalizeFieldDef",function(){return X}),n.d(t,"normalizeBin",function(){return Z}),n.d(t,"channelCompatibility",function(){return ee}),n.d(t,"isTimeFormatFieldDef",function(){return te}),n.d(t,"isTimeFieldDef",function(){return ne}),n.d(t,"valueExpr",function(){return ie}),n.d(t,"valueArray",function(){return re}),n.d(t,"binRequiresRange",function(){return oe});var i=n(0),r=n(51),o=n(21),c=n(5),a=n(16),s=n(154),u=n(6),l=n(14),d=n(54),f=n(93),b=n(50),g=n(45),p=n(1);function m(e){return e.selection}function h(e){return e&&!Object(i.H)(e)&&"repeat"in e}function O(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function j(e){return F(e)&&!!e.sort}function v(e,t,n,i,r,{isMidPoint:c}={}){const{timeUnit:s,bin:u}=t;if(Object(p.c)(["x","y"],e)){if(C(t)&&void 0!==t.band)return t.band;if(s&&!n)return c?Object(a.d)("timeUnitBandPosition",i,r):Object(l.z)(i.type)?Object(a.d)("timeUnitBand",i,r):0;if(Object(o.e)(u))return Object(l.z)(i.type)&&!c?1:.5}}function y(e,t,n,i,r){return!!(Object(o.e)(t.bin)||t.timeUnit&&F(t)&&"temporal"===t.type)&&!!v(e,t,n,i,r)}function x(e){return!!e&&!!e.condition}function w(e){return!!e&&!!e.condition&&!Object(i.A)(e.condition)&&S(e.condition)}function k(e){return!!e&&!!e.condition&&(Object(i.A)(e.condition)||$(e.condition))}function S(e){return!(!e||!e.field&&"count"!==e.aggregate)}function F(e){return!!e&&(!!e.field&&!!e.type||"count"===e.aggregate)}function D(e){return S(e)&&Object(i.H)(e.field)}function $(e){return e&&"value"in e&&void 0!==e.value}function E(e){return!(!e||!e.scale&&!e.sort)}function C(e){return!(!e||!e.axis&&!e.stack&&!e.impute&&void 0===e.band)}function N(e){return!!e&&!!e.legend}function _(e){return!!e&&!!e.format}function z(e,t={}){var n,i,c;let a=e.field;const s=t.prefix;let u=t.suffix,l="";if(R(e))a=Object(p.n)("count");else{let s;if(!t.nofn)if(function(e){return!!e.op}(e))s=e.op;else{const{bin:d,aggregate:f,timeUnit:g}=e;Object(o.e)(d)?(s=Object(o.b)(d),u=(null!=(n=t.binSuffix)?n:"")+(null!=(i=t.suffix)?i:"")):f?Object(r.e)(f)?(l=`.${a}`,a=`argmax_${f.argmax}`):Object(r.f)(f)?(l=`.${a}`,a=`argmin_${f.argmin}`):s=String(f):g&&(s=Object(b.f)(g),u=(!Object(p.c)(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(null!=(c=t.suffix)?c:""))}s&&(a=a?`${s}_${a}`:s)}return u&&(a=`${a}_${u}`),s&&(a=`${s}_${a}`),t.forAs?a:t.expr?Object(p.j)(a,t.expr)+l:Object(p.z)(a)+l}function A(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"temporal":return!1}throw new Error(u.b.invalidFieldType(e.type))}function T(e){return!A(e)}function R(e){return"count"===e.aggregate}function P(e,t){var n;const{field:i,bin:c,timeUnit:a,aggregate:s}=e;if("count"===s)return t.countTitle;if(Object(o.e)(c))return`${i} (binned)`;if(a){const e=null===(n=Object(b.e)(a))||void 0===n?void 0:n.unit;if(e)return`${i} (${Object(b.c)(e).join("-")})`}else if(s)return Object(r.e)(s)?`${i} for max ${s.argmax}`:Object(r.f)(s)?`${i} for min ${s.argmin}`:`${Object(p.D)(s)} of ${i}`;return i}function M(e){var t,n;const{aggregate:i,bin:c,timeUnit:a,field:s}=e;if(Object(r.e)(i))return`${s} for argmax(${i.argmax})`;if(Object(r.f)(i))return`${s} for argmin(${i.argmin})`;const u=Object(b.e)(a),l=i||(null===(t=u)||void 0===t?void 0:t.unit)||(null===(n=u)||void 0===n?void 0:n.maxbins)&&"timeunit"||Object(o.e)(c)&&"bin";return l?l.toUpperCase()+"("+s+")":s}const L=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return M(e);default:return P(e,t)}};let U=L;function H(e){U=e}function q(){H(L)}function W(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const c=(null!=(r=I(e))?r:{}).title,a=i?B(e,t):void 0;return n?Object(p.k)(c,e.title,a):null!=(o=null!=c?c:e.title)?o:a}function I(e){return C(e)&&e.axis?e.axis:N(e)&&e.legend?e.legend:Object(f.a)(e)&&e.header?e.header:void 0}function B(e,t){return U(e,t)}function G(e){var t;if(_(e)&&e.format)return e.format;return(null!=(t=I(e))?t:{}).format}function Y(e,t){if(e.timeUnit)return"temporal";if(Object(o.e)(e.bin))return"quantitative";switch(Object(c.P)(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}function V(e){return S(e)?e:w(e)?e.condition:void 0}function J(e){return S(e)?e:w(e)?e.condition:void 0}function Q(e,t){if(Object(i.H)(e)||Object(i.E)(e)||Object(i.B)(e)){const n=Object(i.H)(e)?"string":Object(i.E)(e)?"number":"boolean";return u.e(u.b.primitiveChannelDef(t,n,e)),{value:e}}return S(e)?X(e,t):w(e)?Object.assign(Object.assign({},e),{condition:X(e.condition,t)}):e}function X(e,t){const{aggregate:n,timeUnit:a,bin:s,field:l}=e,f=Object.assign({},e);if(!n||Object(r.d)(n)||Object(r.e)(n)||Object(r.f)(n)||(u.e(u.b.invalidAggregate(n)),delete f.aggregate),a&&(f.timeUnit=Object(b.e)(a)),l&&(f.field=`${l}`),Object(o.e)(s)&&(f.bin=Z(s,t)),Object(o.d)(s)&&!Object(p.c)(c.p,t)&&u.e(`Channel ${t} should not be used with "binned" bin.`),F(f)){const{type:e}=f,t=Object(g.g)(e);e!==t&&(f.type=t),"quantitative"!==e&&Object(r.g)(n)&&(u.e(u.b.invalidFieldTypeForCountAggregate(e,n)),f.type="quantitative")}else if(!Object(c.N)(t)){const e=Y(f,t);u.e(u.b.missingFieldType(t,e)),f.type=e}if(F(f)){const{compatible:e,warning:n}=ee(f,t);e||u.e(n)}if(j(f)&&Object(i.H)(f.sort)){const{sort:e}=f;if(Object(d.c)(e))return Object.assign(Object.assign({},f),{sort:{encoding:e}});const t=e.substr(1);if("-"===e.charAt(0)&&Object(d.c)(t))return Object.assign(Object.assign({},f),{sort:{encoding:t,order:"descending"}})}return f}function Z(e,t){return Object(i.B)(e)?{maxbins:Object(o.a)(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Object(o.a)(t)})}const K={compatible:!0};function ee(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case"row":case"column":case"facet":return T(e)?{compatible:!1,warning:u.b.facetChannelShouldBeDiscrete(t)}:K;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":case"url":return K;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==g.d?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:K;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"x2":case"y2":return"nominal"!==n||e.sort?K:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case"strokeDash":return Object(p.c)(["ordinal","nominal"],e.type)?K:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case"shape":return Object(p.c)(["ordinal","nominal","geojson"],e.type)?K:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==e.type||"sort"in e?K:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}function te(e){const t=I(e),n=t&&t.formatType||_(e)&&e.formatType;return"time"===n||!n&&ne(e)}function ne(e){return"temporal"===e.type||!!e.timeUnit}function ie(e,{timeUnit:t,type:n,time:r,undefinedIfExprNotRequired:o}){var c;const a=null===(c=Object(b.e)(t))||void 0===c?void 0:c.unit;let u;return Object(s.d)(e)?u=Object(s.b)(e):(Object(i.H)(e)||Object(i.E)(e))&&(a||"temporal"===n)&&(u=Object(b.d)(a)?Object(s.b)({[a]:e}):`datetime(${JSON.stringify(e)})`),u?r?`time(${u})`:u:o?void 0:JSON.stringify(e)}function re(e,t){var n;const{type:i}=e,r=null===(n=Object(b.e)(e.timeUnit))||void 0===n?void 0:n.unit;return t.map(e=>{const t=ie(e,{timeUnit:r,type:i,undefinedIfExprNotRequired:!0});return void 0!==t?{signal:t}:e})}function oe(e,t){return Object(o.e)(e.bin)?Object(c.M)(t)&&Object(p.c)(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}},403:function(e,t,n){"use strict";n.r(t),n.d(t,"symbols",function(){return p}),n.d(t,"gradient",function(){return m}),n.d(t,"labels",function(){return h}),n.d(t,"entries",function(){return O}),n.d(t,"getFirstConditionValue",function(){return v});var i=n(0),r=n(5),o=n(4),c=n(14),a=n(13),s=n(50),u=n(1),l=n(16),d=n(26),f=n(32),b=n(195);function g(e,t,n){const i=t.getScaleComponent(n).get("type");return Object(u.k)(e.get("type"),Object(b.d)({channel:n,scaleType:i,alwaysReturn:!0}))}function p(e,t,n,o,a){var s,f,b,p,m;if("symbol"!==g(a,n,o))return;const{markDef:h,encoding:O,config:y,mark:w}=n,k=h.filled&&"trail"!==w;let S=Object.assign(Object.assign({},Object(l.a)({},n,c.e)),d.b(n,{filled:k}));const F=null!=(s=j(O.opacity))?s:h.opacity,D=x(n,a,e);if(S.fill)if("fill"===o||k&&o===r.b)delete S.fill;else if(S.fill.field)a.get("symbolFillColor")?delete S.fill:(S.fill=Object(l.l)(null!=(f=y.legend.symbolBaseFillColor)?f:"black"),S.fillOpacity=Object(l.l)(null!=F?F:1));else if(Object(i.A)(S.fill)){const e=null!=(m=null!=(p=v(null!=(b=O.fill)?b:O.color))?p:h.fill)?m:k&&h.color;e&&(S.fill=Object(l.l)(e))}if(S.stroke)if("stroke"===o||!k&&o===r.b)delete S.stroke;else if(S.stroke.field)delete S.stroke;else if(Object(i.A)(S.stroke)){const e=Object(u.k)(v(O.stroke||O.color),h.stroke,k?h.color:void 0);e&&(S.stroke={value:e})}return o!==r.o&&(D?S.opacity=[Object.assign({test:D},Object(l.l)(null!=F?F:1)),Object(l.l)(y.legend.unselectedOpacity)]:F&&(S.opacity=Object(l.l)(F))),S=Object.assign(Object.assign({},S),t),Object(u.r)(S).length>0?S:void 0}function m(e,t,n,i,r){if("gradient"!==g(r,n,i))return;let o={};const c=j(n.encoding.opacity)||n.markDef.opacity;return c&&(o.opacity=Object(l.l)(c)),o=Object.assign(Object.assign({},o),t),Object(u.r)(o).length>0?o:void 0}function h(e,t,n,i,r){var c;const d=n.legend(i),f=n.config,b=x(n,r,e);let g={};if(Object(o.isTimeFormatFieldDef)(e)){const r=n.getScaleComponent(i).get("type")===a.b.UTC,o=Object(l.n)("datum.value",null===(c=Object(s.e)(e.timeUnit))||void 0===c?void 0:c.unit,d.format,f.timeFormat,r);t=Object.assign(Object.assign({},o?{text:{signal:o}}:{}),t)}return b&&(t.opacity=[{test:b,value:1},{value:f.legend.unselectedOpacity}]),g=Object.assign(Object.assign({},g),t),Object(u.r)(g).length>0?g:void 0}function O(e,t,n,i,r){var o;return(null===(o=r.get("selections"))||void 0===o?void 0:o.length)?{fill:{value:"transparent"}}:void 0}function j(e){return y(e,(e,t)=>Math.max(e,t.value))}function v(e){return y(e,(e,t)=>Object(u.k)(e,t.value))}function y(e,t){return Object(o.hasConditionalValueDef)(e)?Object(i.i)(e.condition).reduce(t,e.value):Object(o.isValueDef)(e)?e.value:void 0}function x(e,t,n){var r;const o=t.get("selections");if(!(null===(r=o)||void 0===r?void 0:r.length))return;const c=Object(i.Y)(n.field);return o.map(e=>{return`(!length(data(${Object(i.Y)(Object(u.H)(e)+f.b)})) || (${e}[${c}] && indexof(${e}[${c}], datum.value) >= 0))`}).join(" || ")}},404:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(4),r=n(46),o=n(60),c=n(1),a=n(19);class s extends a.a{constructor(e,t){super(e),this.transform=t}clone(){return new s(null,Object(c.f)(this.transform))}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...(e=this.transform.groupby,null!=e?e:[])])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:i}=e;return{signal:`sequence(${[t,n,...i?[i]:[]].join(",")})`}}static makeFromTransform(e,t){return new s(e,t)}static makeFromEncoding(e,t){const n=t.encoding,o=n.x,c=n.y;if(Object(i.isFieldDef)(o)&&Object(i.isFieldDef)(c)){const i=o.impute?o:c.impute?c:void 0;if(void 0===i)return;const a=o.impute?c:c.impute?o:void 0,{method:u,value:l,frame:d,keyvals:f}=i.impute,b=Object(r.g)(t.mark,n);return new s(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:i.field,key:a.field},u?{method:u}:{}),void 0!==l?{value:l}:{}),d?{frame:d}:{}),void 0!==f?{keyvals:f}:{}),b.length?{groupby:b}:{}))}return null}hash(){return`Impute ${Object(c.m)(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:n,method:i,groupby:r,value:c,frame:a=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:e,key:t},n?{keyvals:Object(o.i)(n)?this.processSequence(n):n}:{}),{method:"value"}),r?{groupby:r}:{}),{value:i&&"value"!==i?null:c});if(i&&"value"!==i){return[s,Object.assign({type:"window",as:[`imputed_${e}_value`],ops:[i],fields:[e],frame:a,ignorePeers:!1},r?{groupby:r}:{}),{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]}return[s]}}},410:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var i=n(5);function r(e){return"fit"===e||"fit-x"===e||"fit-y"===e}function o(e){return e?`fit-${Object(i.F)(e)}`:"fit"}const c=["background","padding"];function a(e){return c.reduce((t,n)=>(e&&void 0!==e[n]&&(t[n]=e[n]),t),{})}},411:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return a});var i=n(1);const r={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},o={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelLimit:"limit",labelOrient:"orient",labelPadding:"offset"},c=Object(i.r)(r),a=Object(i.r)(o)},45:function(e,t,n){"use strict";n.d(t,"f",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return u});const i={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1};const r="quantitative",o="ordinal",c="temporal",a="nominal",s="geojson";function u(e){if(e)switch(e=e.toLowerCase()){case"q":case r:return"quantitative";case"t":case c:return"temporal";case"o":case o:return"ordinal";case"n":case a:return"nominal";case s:return"geojson"}}},46:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"b",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return O}),n.d(t,"h",function(){return j}),n.d(t,"g",function(){return v});var i=n(18),r=n(0),o=n(51),c=n(21),a=n(5),s=n(4),u=n(6),l=n(45),d=n(1),f=n(24);function b(e,t){const n=e&&e[t];return!!n&&(Object(r.A)(n)?Object(d.B)(n,e=>!!e.field):Object(s.isFieldDef)(n)||Object(s.hasConditionalFieldDef)(n))}function g(e){return Object(d.B)(a.a,t=>{if(b(e,t)){const n=e[t];if(Object(r.A)(n))return Object(d.B)(n,e=>!!e.aggregate);{const e=Object(s.getFieldDef)(n);return e&&!!e.aggregate}}return!1})}function p(e,t){const n=[],r=[],u=[],d=[],f={};return O(e,(b,g)=>{if(Object(s.isFieldDef)(b)){const{field:p,aggregate:m,bin:h,timeUnit:O}=b,j=Object(i.a)(b,["field","aggregate","bin","timeUnit"]);if(m||O||h){const e=Object(s.getGuide)(b),i=e&&e.title;let v=Object(s.vgField)(b,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},i?[]:{title:Object(s.title)(b,t,{allowDisabling:!0})}),j),{field:v}),x="x"===g||"y"===g;if(m){let e;if(Object(o.e)(m)?(e="argmax",v=Object(s.vgField)({op:"argmax",field:m.argmax},{forAs:!0}),y.field=`${v}.${p}`):Object(o.f)(m)?(e="argmin",v=Object(s.vgField)({op:"argmin",field:m.argmin},{forAs:!0}),y.field=`${v}.${p}`):"boxplot"!==m&&"errorbar"!==m&&"errorband"!==m&&(e=m),e){const t={op:e,as:v};p&&(t.field=p),d.push(t)}}else if(n.push(v),Object(s.isTypedFieldDef)(b)&&Object(c.e)(h)){if(r.push({bin:h,field:p,as:v}),n.push(Object(s.vgField)(b,{binSuffix:"end"})),Object(s.binRequiresRange)(b,g)&&n.push(Object(s.vgField)(b,{binSuffix:"range"})),x){const e={field:v+"_end"};f[g+"2"]=e}y.bin="binned",Object(a.N)(g)||(y.type="quantitative")}else if(O){u.push({timeUnit:O,field:p,as:v});const e=Object(s.isTypedFieldDef)(b)&&b.type!==l.e&&"time";e&&("text"===g||"tooltip"===g?y.formatType=e:Object(a.L)(g)?y.legend=Object.assign({formatType:e},y.legend):x&&(y.axis=Object.assign({formatType:e},y.axis)))}f[g]=y}else n.push(p),f[g]=e[g]}else f[g]=e[g]}),{bins:r,timeUnits:u,aggregate:d,groupby:n,encoding:f}}function m(e,t){const n=t.type;return Object(d.r)(e).reduce((i,o)=>{var l;if(!Object(a.I)(o))return u.e(u.b.invalidEncodingChannel(o)),i;if(!function(e,t,n){const i=Object(a.R)(t,n);if(!i)return!1;if("binned"===i){const n=e["x2"===t?"x":"y"];return!!(Object(s.isFieldDef)(n)&&Object(s.isFieldDef)(e[t])&&Object(c.d)(n.bin))}return!0}(e,o,n))return u.e(u.b.incompatibleChannel(o,n)),i;if("size"===o&&"line"===n){if(null===(l=Object(s.getTypedFieldDef)(e[o]))||void 0===l?void 0:l.aggregate)return u.e(u.b.LINE_WITH_VARYING_SIZE),i}if("color"===o&&(t.filled?"fill"in e:"stroke"in e))return u.e(u.b.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;const d=e[o];if("detail"===o||"order"===o&&!Object(r.A)(d)&&!Object(s.isValueDef)(d)||"tooltip"===o&&Object(r.A)(d))d&&(i[o]=Object(r.i)(d).reduce((e,t)=>(Object(s.isFieldDef)(t)?e.push(Object(s.normalizeFieldDef)(t,o)):u.e(u.b.emptyFieldDef(t,o)),e),[]));else{if("tooltip"===o&&null===d)i[o]=null;else if(!(Object(s.isFieldDef)(d)||Object(s.isValueDef)(d)||Object(s.isConditionalDef)(d)||Object(f.isSignalRef)(d)))return u.e(u.b.emptyFieldDef(d,o)),i;i[o]=Object(s.normalize)(d,o)}return i},{})}function h(e){const t=[];for(const n of Object(d.r)(e))if(b(e,n)){const i=e[n],o=Object(r.i)(i);for(const e of o)Object(s.isFieldDef)(e)?t.push(e):Object(s.hasConditionalFieldDef)(e)&&t.push(e.condition)}return t}function O(e,t,n){if(e)for(const i of Object(d.r)(e)){const o=e[i];Object(r.A)(o)?o.forEach(e=>{t.call(n,e,i)}):t.call(n,o,i)}}function j(e,t,n,i){return e?Object(d.r)(e).reduce((n,o)=>{const c=e[o];return Object(r.A)(c)?c.reduce((e,n)=>t.call(i,e,n,o),n):t.call(i,n,c,o)},n):n}function v(e,t){return Object(d.r)(t).reduce((n,i)=>{switch(i){case"x":case"y":case"href":case"url":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"tooltip":return n;case"order":if("line"===e||"trail"===e)return n;case"detail":case"key":{const e=t[i];return(Object(r.A)(e)||Object(s.isFieldDef)(e))&&Object(r.i)(e).forEach(e=>{e.aggregate||n.push(Object(s.vgField)(e,{}))}),n}case"size":if("trail"===e)return n;case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{const e=Object(s.getTypedFieldDef)(t[i]);return e&&!e.aggregate&&n.push(Object(s.vgField)(e,{})),n}}},[])}},488:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(0),r=n(75),o=n(6),c=n(80),a=n(1);function s(e,t){void 0===t&&(t=Object(r.e)(e.config));const n=function(e,t={}){return u.map(e,{config:t})}(e,t),{width:i,height:s}=e,d=function(e,t,n){let{width:i,height:r}=t;const s=Object(c.f)(e)||Object(c.d)(e),u={};s?"container"==i&&"container"==r?(u.type="fit",u.contains="padding"):"container"==i?(u.type="fit-x",u.contains="padding"):"container"==r&&(u.type="fit-y",u.contains="padding"):("container"==i&&(o.e(o.b.containerSizeNonSingle("width")),i=void 0),"container"==r&&(o.e(o.b.containerSizeNonSingle("height")),r=void 0));const d=Object.assign(Object.assign(Object.assign({type:"pad"},u),n?l(n.autosize):{}),l(e.autosize));"fit"!==d.type||s||(o.e(o.b.FIT_NON_SINGLE),d.type="pad");"container"==i&&"fit"!=d.type&&"fit-x"!=d.type&&o.e(o.b.containerSizeNotCompatibleWithAutosize("width"));"container"==r&&"fit"!=d.type&&"fit-y"!=d.type&&o.e(o.b.containerSizeNotCompatibleWithAutosize("height"));if(Object(a.d)(d,{type:"pad"}))return;return d}(n,{width:i,height:s,autosize:e.autosize},t);return Object.assign(Object.assign({},n),d?{autosize:d}:{})}const u=new(n(1027).a);function l(e){return Object(i.H)(e)?{type:e}:null!=e?e:{}}},489:function(e,t,n){"use strict";function i(e){return void 0!==e.layer}n.d(t,"a",function(){return i})},5:function(e,t,n){"use strict";n.d(t,"q",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return a}),n.d(t,"z",function(){return s}),n.d(t,"B",function(){return u}),n.d(t,"A",function(){return l}),n.d(t,"C",function(){return d}),n.d(t,"i",function(){return f}),n.d(t,"k",function(){return b}),n.d(t,"j",function(){return g}),n.d(t,"l",function(){return p}),n.d(t,"b",function(){return m}),n.d(t,"f",function(){return h}),n.d(t,"v",function(){return O}),n.d(t,"t",function(){return j}),n.d(t,"u",function(){return v}),n.d(t,"o",function(){return y}),n.d(t,"g",function(){return x}),n.d(t,"x",function(){return w}),n.d(t,"y",function(){return k}),n.d(t,"w",function(){return S}),n.d(t,"E",function(){return A}),n.d(t,"K",function(){return R}),n.d(t,"h",function(){return P}),n.d(t,"J",function(){return L}),n.d(t,"e",function(){return H}),n.d(t,"a",function(){return W}),n.d(t,"O",function(){return Z}),n.d(t,"I",function(){return K}),n.d(t,"s",function(){return ee}),n.d(t,"N",function(){return te}),n.d(t,"D",function(){return ne}),n.d(t,"G",function(){return ie}),n.d(t,"m",function(){return be}),n.d(t,"p",function(){return pe}),n.d(t,"H",function(){return me}),n.d(t,"F",function(){return he}),n.d(t,"n",function(){return Fe}),n.d(t,"L",function(){return De}),n.d(t,"Q",function(){return $e}),n.d(t,"r",function(){return Ce}),n.d(t,"M",function(){return Ne}),n.d(t,"R",function(){return _e}),n.d(t,"P",function(){return Re});var i=n(18),r=n(1);const o="row",c="column",a="facet",s="x",u="y",l="x2",d="y2",f="latitude",b="longitude",g="latitude2",p="longitude2",m="color",h="fill",O="stroke",j="shape",v="size",y="opacity",x="fillOpacity",w="strokeOpacity",k="strokeWidth",S="strokeDash",F="text",D="order",$="detail",E="key",C="tooltip",N="href",_="url",z={x:1,y:1,x2:1,y2:1};function A(e){switch(e){case f:return"y";case g:return"y2";case b:return"x";case p:return"x2"}}const T={longitude:1,longitude2:1,latitude:1,latitude2:1};function R(e){return e in T}const P=Object(r.r)(T),M=Object.assign(Object.assign(Object.assign({},z),T),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1});function L(e){return"color"===e||"fill"===e||"stroke"===e}const U={row:1,column:1,facet:1},H=Object(r.r)(U),q=Object.assign(Object.assign({},M),U),W=Object(r.r)(q),{order:I,detail:B,tooltip:G}=q,Y=Object(i.a)(q,["order","detail","tooltip"]),{row:V,column:J,facet:Q}=Y,X=Object(i.a)(Y,["row","column","facet"]);Object(r.r)(Y),Object(r.r)(X);function Z(e){return!!X[e]}function K(e){return!!q[e]}const ee=["x2","y2","latitude2","longitude2"];function te(e){return ne(e)!==e}function ne(e){switch(e){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude"}return e}function ie(e){switch(e){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2"}}Object(r.r)(M);const{x:re,y:oe,x2:ce,y2:ae,latitude:se,longitude:ue,latitude2:le,longitude2:de}=M,fe=Object(i.a)(M,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]),be=Object(r.r)(fe),ge={x:1,y:1},pe=Object(r.r)(ge);function me(e){return"x"===e?"width":"height"}function he(e){return"width"===e?"x":"y"}const{text:Oe,tooltip:je,href:ve,url:ye,detail:xe,key:we,order:ke}=fe,Se=Object(i.a)(fe,["text","tooltip","href","url","detail","key","order"]),Fe=Object(r.r)(Se);function De(e){return!!fe[e]}function $e(e){switch(e){case m:case h:case O:case v:case j:case y:case k:case S:return!0;case x:case w:return!1}}const Ee=Object.assign(Object.assign({},ge),Se),Ce=Object(r.r)(Ee);function Ne(e){return!!Ee[e]}function _e(e,t){return function(e){switch(e){case m:case h:case O:case $:case E:case C:case N:case D:case y:case x:case w:case k:case a:case o:case c:return ze;case s:case u:case f:case b:return Te;case l:case d:case g:case p:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case v:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case S:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case j:return{point:"always",geoshape:"always"};case F:return{text:"always"};case _:return{image:"always"}}}(e)[t]}const ze={area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Ae}=ze,Te=Object(i.a)(ze,["geoshape"]);function Re(e){switch(e){case s:case u:case v:case k:case y:case x:case w:case l:case d:return;case a:case o:case c:case j:case S:case F:case C:case N:case _:return"discrete";case m:case h:case O:return"flexible";case f:case b:case g:case p:case $:case E:case D:return}}},50:function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return x}),n.d(t,"b",function(){return w}),n.d(t,"e",function(){return k}),n.d(t,"f",function(){return F});var i,r=n(18),o=n(294),c=n.n(o),a=n(0),s=n(154),u=n(6),l=n(1);!function(e){e.YEAR="year",e.MONTH="month",e.DAY="day",e.DATE="date",e.HOURS="hours",e.MINUTES="minutes",e.SECONDS="seconds",e.MILLISECONDS="milliseconds",e.YEARMONTH="yearmonth",e.YEARMONTHDATE="yearmonthdate",e.YEARMONTHDATEHOURS="yearmonthdatehours",e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",e.MONTHDATE="monthdate",e.MONTHDATEHOURS="monthdatehours",e.HOURSMINUTES="hoursminutes",e.HOURSMINUTESSECONDS="hoursminutesseconds",e.MINUTESSECONDS="minutesseconds",e.SECONDSMILLISECONDS="secondsmilliseconds",e.QUARTER="quarter",e.YEARQUARTER="yearquarter",e.QUARTERMONTH="quartermonth",e.YEARQUARTERMONTH="yearquartermonth",e.UTCYEAR="utcyear",e.UTCMONTH="utcmonth",e.UTCDAY="utcday",e.UTCDATE="utcdate",e.UTCHOURS="utchours",e.UTCMINUTES="utcminutes",e.UTCSECONDS="utcseconds",e.UTCMILLISECONDS="utcmilliseconds",e.UTCYEARMONTH="utcyearmonth",e.UTCYEARMONTHDATE="utcyearmonthdate",e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",e.UTCMONTHDATE="utcmonthdate",e.UTCMONTHDATEHOURS="utcmonthdatehours",e.UTCHOURSMINUTES="utchoursminutes",e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",e.UTCMINUTESSECONDS="utcminutesseconds",e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",e.UTCQUARTER="utcquarter",e.UTCYEARQUARTER="utcyearquarter",e.UTCQUARTERMONTH="utcquartermonth",e.UTCYEARQUARTERMONTH="utcyearquartermonth"}(i||(i={}));const d={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},f=Object(l.r)(d);function b(e){return!!d[e]}const g={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};const p={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},m=Object.assign(Object.assign({},g),p);function h(e){return!!m[e]}const O=Object.assign(Object.assign(Object.assign(Object.assign({},d),g),{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1}),p),j=(Object(l.r)(O),{"year-month":"%b %Y ","year-month-date":"%b %d, %Y "});function v(e){return f.reduce((t,n)=>y(e,n)?[...t,n]:t,[])}function y(e,t){const n=e.indexOf(t);return n>-1&&(t!==i.SECONDS||0===n||"i"!==e.charAt(n-1))}function x(e,t,{end:n}={end:!1}){const r=Object(l.b)(t),o=h(e)?"utc":"";let c;const a=f.reduce((t,n)=>(y(e,n)&&(t[n]=function(e){return e===i.QUARTER?`(${o}quarter(${r})-1)`:`${o}${e}(${r})`}(n),c=n),t),{});return n&&(a[c]+="+1"),Object(s.a)(a)}function w(e,t,n){if(!e)return;const i=function(e){if(!e)return;const t=v(e);return`timeUnitSpecifier(${c()(t)}, ${c()(j)})`}(e);return n||h(e)?`utcFormat(${t}, ${i})`:`timeFormat(${t}, ${i})`}function k(e){if(!e)return;let t;return Object(a.H)(e)?t={unit:S(e)}:Object(a.F)(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:S(e.unit)}:{})),h(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function S(e){return"day"!==e&&e.indexOf("day")>=0?(u.e(u.b.dayReplacedWithDate(e)),Object(l.y)(e,"day","date")):e}function F(e){const t=k(e),{utc:n}=t,i=Object(r.a)(t,["utc"]);return i.unit?(n?"utc":"")+Object(l.r)(i).map(e=>Object(l.H)(`${"unit"===e?"":`_${e}_`}${i[e]}`)).join(""):(n?"utc":"")+"timeunit"+Object(l.r)(i).map(e=>Object(l.H)(`_${e}_${i[e]}`)).join("")}},51:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return g});var i=n(0),r=n(1);const o={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},c={count:1,min:1,max:1};function a(e){return!!e&&!!e.argmin}function s(e){return!!e&&!!e.argmax}Object(r.r)(o);function u(e){return Object(i.H)(e)&&!!o[e]}const l=["count","valid","missing","distinct"];function d(e){return Object(i.H)(e)&&Object(r.c)(l,e)}function f(e){return Object(i.H)(e)&&Object(r.c)(["min","max"],e)}const b=["count","sum","distinct","valid","missing"],g=Object(i.cb)(["mean","average","median","q1","q3","min","max"])},523:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n(1);const r={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},o={clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};Object(i.r)(o)},524:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(18),r=n(6),o=n(177),c=n(93),a=n(489),s=n(332),u=n(123);class l{map(e,t){return Object(c.c)(e)?this.mapFacet(e,t):Object(s.a)(e)?this.mapRepeat(e,t):Object(o.c)(e)?this.mapHConcat(e,t):Object(o.d)(e)?this.mapVConcat(e,t):Object(o.b)(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(Object(a.a)(e))return this.mapLayer(e,t);if(Object(u.a)(e))return this.mapUnit(e,t);throw new Error(r.b.invalidSpec(e))}mapLayer(e,t){return Object.assign(Object.assign({},e),{layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))})}mapHConcat(e,t){return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map(e=>this.map(e,t))})}mapVConcat(e,t){return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map(e=>this.map(e,t))})}mapConcat(e,t){const{concat:n}=e,r=Object(i.a)(e,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map(e=>this.map(e,t))})}mapFacet(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}mapRepeat(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}},525:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n(0),r=n(51),o=n(5),c=n(4),a=n(46),s=n(6),u=n(14),l=n(13),d=n(1);const f={zero:1,center:1,normalize:1};const b=[u.b,u.a,u.l,u.i,u.d,u.m,u.h,u.n,u.o],g=[u.b,u.a];function p(e,t,n={}){const p=Object(u.x)(e)?e.type:e;if(!Object(d.c)(b,p))return null;const m=function(e){const t=e.x,n=e.y;if(Object(c.isFieldDef)(t)&&Object(c.isFieldDef)(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(Object(c.isFieldDef)(t)&&"quantitative"===t.type)return"x";if(Object(c.isFieldDef)(n)&&"quantitative"===n.type)return"y"}}(t);if(!m)return null;const h=t[m],O=Object(c.isStringFieldDef)(h)?Object(c.vgField)(h,{}):void 0,j="x"===m?"y":"x",v=t[j],y=Object(c.isStringFieldDef)(v)?Object(c.vgField)(v,{}):void 0,x=o.m.reduce((e,n)=>{if("tooltip"!==n&&Object(a.a)(t,n)){const r=t[n];Object(i.i)(r).forEach(t=>{const i=Object(c.getTypedFieldDef)(t);if(i.aggregate)return;const r=Object(c.isStringFieldDef)(i)?Object(c.vgField)(i,{}):void 0;(!r||r!==y&&r!==O)&&e.push({channel:n,fieldDef:i})})}return e},[]);let w;if(void 0!==h.stack?w=Object(i.B)(h.stack)?h.stack?"zero":null:h.stack:x.length>0&&Object(d.c)(g,p)&&(w="zero"),!w||!f[w])return null;if(Object(a.e)(t)&&0===x.length)return null;if(h.scale&&h.scale.type&&h.scale.type!==l.b.LINEAR){if(n.disallowNonLinearStack)return null;s.e(s.b.cannotStackNonLinearScale(h.scale.type))}return Object(a.a)(t,m===o.z?o.A:o.C)?(void 0!==h.stack&&s.e(s.b.cannotStackRangedMark(m)),null):(h.aggregate&&!Object(d.c)(r.c,h.aggregate)&&s.e(s.b.stackNonSummativeAggregate(h.aggregate)),{groupbyChannel:v?j:void 0,fieldChannel:m,impute:null!==h.impute&&Object(u.y)(p),stackBy:x,offset:w})}},526:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1),r=n(183),o=n(251),c=n(20);class a extends c.a{constructor(e,t,n,i,r,o,c){super(e,t,n,i,r,o,c)}parseData(){this.component.data=Object(r.b)(this),this.children.forEach(e=>{e.parseData()})}parseSelections(){this.component.selection={};for(const e of this.children)e.parseSelections(),Object(i.r)(e.component.selection).forEach(t=>{this.component.selection[t]=e.component.selection[t]})}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[]}assembleLayoutSignals(){return this.children.reduce((e,t)=>[...e,...t.assembleLayoutSignals()],Object(o.a)(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleMarks(){return this.children.map(e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),i=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),i?{encode:{update:i}}:{}),e.assembleGroup())})}}},527:function(e,t,n){"use strict";var i=n(0),r=n(32),o=n(1),c=n(99),a=n(528),s=n(184),u=n(115);const l={has:e=>"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!Object(u.c)(e.bind),parse:(e,t,n,i)=>{i.on||delete t.events,i.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,s=t.project,u=t.bind,l=t.init&&t.init[0],d=a.a.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return s.items.forEach((e,a)=>{var s,f;const b=Object(o.H)(`${r}_${e.field}`);n.filter(e=>e.name===b).length||n.unshift(Object.assign(Object.assign({name:b},l?{init:Object(c.b)(l[a])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${d}[${Object(i.Y)(e.field)}] : null`}]:[],bind:(s=u[e.field],f=null!=s?s:u[e.channel],null!=f?f:u)}))}),n},signals:(e,t,n)=>{const i=t.name,c=t.project,a=n.filter(e=>e.name===i+r.c)[0],u=i+s.a,l=c.items.map(e=>Object(o.H)(`${i}_${e.field}`)),d=l.map(e=>`${e} !== null`).join(" && ");return l.length&&(a.update=`${d} ? {fields: ${u}, values: [${l.join(", ")}]} : null`),delete a.value,delete a.on,n}};t.a=l},528:function(e,t,n){"use strict";var i=n(6),r=n(14),o=n(26);const c={has:e=>"interval"!==e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName("voronoi")},marks:(e,t,n)=>{const{x:c,y:a}=t.project.hasChannel,s=e.mark;if(Object(r.y)(s))return i.e(i.b.nearestNotSupportForContinuous(s)),n;const u={name:e.getName("voronoi"),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Object(o.i)(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:c||!a?"datum.datum.x || 0":"0"},y:{expr:a||!c?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let l=0,d=!1;return n.forEach((t,n)=>{var i;const r=null!=(i=t.name)?i:"";r===e.component.mark[0].name?l=n:r.indexOf("voronoi")>=0&&(d=!0)}),d||n.splice(l+1,0,u),n}};t.a=c},529:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1),r=n(16);const o={left:"x",center:"xc",right:"x2"},c={top:"y",middle:"yc",bottom:"y2"};function a(e,t,n){const a="x"===e?"align":"baseline",s=Object(i.k)(t[a],Object(r.d)(a,t,n));return"x"===e?o[null!=s?s:"center"]:c[null!=s?s:"middle"]}},530:function(e,t,n){"use strict";n.d(t,"b",function(){return f});var i=n(125),r=n(32),o=n(0),c=n(115),a=n(6),s=n(1),u=n(184),l=n(289);const d={has:e=>{const t="global"===e.resolve&&e.bind&&Object(c.c)(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==c.a;return t&&!n&&a.e(a.b.LEGEND_BINDINGS_PROJECT_LENGTH),t&&n},parse:(e,t,n,r)=>{var a;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=Object(o.i)(null!=(a=n.filter)?a:[]),n.filter.indexOf(e)<0&&n.filter.push(e)}const s=Object(c.d)(t.bind)?t.bind.legend:"click",u=Object(o.H)(s)?Object(i.a)(s,"view"):Object(o.i)(s);t.bind={legend:{merge:u}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Object(c.d)(t.bind)&&t.bind.legend,o=e=>t=>{const n=Object(s.f)(t);return n.markname=e,n};for(const e of t.project.items){if(!e.hasLegend)continue;const c=`${Object(s.H)(e.field)}_legend`,a=`${i}_${c}`;if(0===n.filter(e=>e.name===a).length){const e=r.merge.map(o(`${c}_symbols`)).concat(r.merge.map(o(`${c}_labels`))).concat(r.merge.map(o(`${c}_entries`)));n.unshift(Object.assign(Object.assign({name:a},t.init?{}:{value:null}),{on:[{events:e,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${a}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,o=t.project,a=n.find(e=>e.name===i+r.c),d=i+u.a,f=o.items.filter(e=>e.hasLegend).map(e=>Object(s.H)(`${i}_${Object(s.H)(e.field)}_legend`)),b=`${f.map(e=>`${e} !== null`).join(" && ")} ? {fields: ${d}, values: [${f.join(", ")}]} : null`;t.events&&f.length>0?a.on.push({events:f.map(e=>({signal:e})),update:b}):f.length>0&&(a.update=b,delete a.value,delete a.on);const g=n.find(e=>e.name===i+l.a),p=Object(c.d)(t.bind)&&t.bind.legend;return g&&(t.events?g.on.push(Object.assign(Object.assign({},g.on[0]),{events:p})):g.on[0].events=p),n}};function f(e,t,n){const i=e.fieldDef(t).field;Object(r.e)(e,e=>{var r,o;const c=null!=(r=e.project.hasField[i])?r:e.project.hasChannel[t];if(c&&d.has(e)){const t=null!=(o=n.get("selections"))?o:[];t.push(e.name),n.set("selections",t,!1),c.hasLegend=!0}})}t.a=d},531:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var i=n(0),r=n(32),o=n(184);function c(e,t){const n=t.name,c=n+o.a,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(t=>{const n=e.fieldDef(t.channel);return n&&n.bin?`[${s}[${Object(i.Y)(e.vgField(t.channel,{}))}], `+`${s}[${Object(i.Y)(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${s}[${Object(i.Y)(t.field)}]`}).join(", "),l=`unit: ${Object(r.g)(e)}, fields: ${c}, values`,d=t.events;return[{name:n+r.c,on:d?[{events:d,update:`datum && item().mark.marktype !== 'group' ? {${l}: [${u}]} : null`,force:!0}]:[]}]}const a={signals:c,modifyExpr:(e,t)=>{return t.name+r.c+", "+("global"===t.resolve?"null":`{unit: ${Object(r.g)(e)}}`)}};t.a=a},532:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(100);function r(e){const t=Object(i.g)(e),n=new Set;return t.visit(e=>{"MemberExpression"===e.type&&function e(t){return"MemberExpression"===t.object.type?e(t.object):"datum"===t.object.name}(e)&&n.add(function e(t){const n=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(n.push(...e(t.object)),n.push(...e(t.property))),n)}(e).slice(1).join("."))}),n}},533:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(13);function r(e,t,n,r,o){var c;const a=[..."band"===o?["axisBand"]:[],...Object(i.l)(o)?["axisQuantitative"]:[],..."time"===o||"utc"===o?["axisTemporal"]:[],"x"===n?"axisX":"axisY",...r?["axis"+r.substr(0,1).toUpperCase()+r.substr(1)]:[],"axis"];for(const n of a)if(void 0!==(null===(c=t[n])||void 0===c?void 0:c[e]))return{configFrom:n,configValue:t[n][e]};return{}}},534:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(18),r=n(1),o=n(24),c=n(535);function a(e){const t=e.component.legends,n={};for(const i of Object(r.r)(t)){const o=e.getScaleComponent(i),a=Object(r.C)(o.get("domains"));if(n[a])for(const e of n[a]){Object(c.a)(e,t[i])||n[a].push(t[i])}else n[a]=[t[i].clone()]}return Object(r.G)(n).flat().map(e=>{var t,n,c,a;const s=e.combine(),{labelExpr:u,selections:l}=s,d=Object(i.a)(s,["labelExpr","selections"]);if(null===(t=d.encode)||void 0===t?void 0:t.symbols){const e=d.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||d.stroke||(e.stroke={value:"transparent"}),d.fill&&delete e.fill}if(void 0!==u){let e=u;(null===(a=null===(c=null===(n=d.encode)||void 0===n?void 0:n.labels)||void 0===c?void 0:c.update)||void 0===a?void 0:a.text)&&Object(o.isSignalRef)(d.encode.labels.update.text)&&(e=Object(r.y)(u,"datum.label",d.encode.labels.update.text.signal)),function(e,t,n,i){var r,o,c;e.encode=null!=(r=e.encode)?r:{},e.encode[t]=null!=(o=e.encode[t])?o:{},e.encode[t].update=null!=(c=e.encode[t].update)?c:{},e.encode[t].update[n]=i}(d,"labels","text",{signal:e})}return d})}},535:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return v});var i=n(5),r=n(4),o=n(50),c=n(45),a=n(1),s=n(16),u=n(536),l=n(20),d=n(252),f=n(530),b=n(31),g=n(560),p=n(403),m=n(195);function h(e){Object(l.g)(e)?e.component.legends=function(e){const{encoding:t}=e;return[i.b,i.f,i.v,i.y,i.w,i.u,i.t,i.o,i.g,i.x].reduce((n,o)=>{const s=t[o];return!e.legend(o)||!e.getScaleComponent(o)||Object(r.isFieldDef)(s)&&o===i.t&&s.type===c.a||(n[o]=function(e,t){var n;const i=e.fieldDef(t),r=e.legend(t),o=new g.b({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}if("color"===t)return e.markDef.filled?{fill:n}:{stroke:n};return{[t]:n}}(e,t));Object(f.b)(e,t,o);for(const n of g.a){const c=j(n,r,t,e);if(void 0!==c){const t=O(c,n,r,i);(t||void 0===e.config.legend[n])&&o.set(n,c,t)}}const c=null!==(n=r.encoding)&&void 0!==n?n:{},s=o.get("selections"),l=["labels","legend","title","symbols","gradient","entries"].reduce((n,r)=>{var l,d,f;const b=Object(u.a)(null!=(l=c[r])?l:{},e),g=p[r]?p[r](i,b,e,t,o):b;return void 0!==g&&Object(a.r)(g).length>0&&(n[r]=Object.assign(Object.assign(Object.assign({},(null===(d=s)||void 0===d?void 0:d.length)?{name:`${Object(a.H)(i.field)}_legend_${r}`}:{}),(null===(f=s)||void 0===f?void 0:f.length)?{interactive:!!s}:{}),{update:g})),n},{});Object(a.r)(l).length>0&&o.set("encode",l,!!r.encoding);return o}(e,o)),n},{})}(e):e.component.legends=function(e){const{legends:t,resolve:n}=e.component;for(const i of e.children)h(i),Object(a.r)(i.component.legends).forEach(r=>{n.legend[r]=Object(d.b)(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=v(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))});return Object(a.r)(t).forEach(t=>{for(const i of e.children)i.component.legends[t]&&"shared"===n.legend[t]&&delete i.component.legends[t]}),t}(e)}function O(e,t,n,i){switch(t){case"values":return!!n.values;case"title":if("title"===t&&e===i.title)return!0}return e===n[t]}function j(e,t,n,i){var c;const{encoding:u,mark:l}=i,d=Object(r.getTypedFieldDef)(u[n]),f=i.config.legend,b=null===(c=Object(o.e)(d.timeUnit))||void 0===c?void 0:c.unit,g=i.getScaleComponent(n).get("type");switch(e){case"direction":return Object(m.e)({legend:t,legendConfig:f,timeUnit:b,channel:n,scaleType:g});case"format":if(Object(r.isTimeFormatFieldDef)(d))return;return Object(s.k)(d,t.format,i.config);case"formatType":if(Object(r.isTimeFormatFieldDef)(d))return;return t.formatType;case"gradientLength":return Object(a.k)(t.gradientLength,f.gradientLength,m.a({model:i,legend:t,legendConfig:f,channel:n,scaleType:g}));case"labelOverlap":return Object(a.k)(t.labelOverlap,m.b(g));case"symbolType":return Object(a.k)(t.symbolType,m.c(l,n,u.shape,i.markDef.shape));case"title":return Object(r.title)(d,i.config,{allowDisabling:!0})||void 0;case"type":return Object(m.f)({legend:t,channel:n,timeUnit:b,scaleType:g,alwaysReturn:!1});case"values":return m.g(t,d)}return t[e]}function v(e,t){var n,i,r,o,c,u;if(!e)return t.clone();const l=e.getWithExplicit("orient"),d=t.getWithExplicit("orient");if(l.explicit&&d.explicit&&l.value!==d.value)return;let f=!1;for(const n of g.a){const i=Object(b.e)(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(e,t)=>{switch(n){case"symbolType":return y(e,t);case"title":return Object(s.i)(e,t);case"type":return f=!0,Object(b.d)("symbol")}return Object(b.b)(e,t,n,"legend")});e.setWithExplicit(n,i)}return f&&((null==(r=null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)||r)&&Object(a.e)(e.implicit,["encode","gradient"]),(null==(u=null===(c=null===(o=e.explicit)||void 0===o?void 0:o.encode)||void 0===c?void 0:c.gradient)||u)&&Object(a.e)(e.explicit,["encode","gradient"])),e}function y(e,t){return"circle"===t.value?t:e}},536:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(1),r=n(24),o=n(26);function c(e,t){return Object(i.r)(e).reduce((n,i)=>{const c=e[i];return Object.assign(Object.assign({},n),Object(o.k)(t,c,i,e=>Object(r.isSignalRef)(e)?e:{value:e.value}))},{})}},537:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(18),r=n(1),o=n(19);class c extends o.a{constructor(e,t){var n,i,o;super(e),this.transform=t,this.transform=Object(r.f)(t);const c=null!=(n=this.transform.as)?n:[void 0,void 0];this.transform.as=[(i=c[0],null!=i?i:"value"),(o=c[1],null!=o?o:"density")]}clone(){return new c(null,Object(r.f)(this.transform))}dependentFields(){var e;return new Set([this.transform.density,...(e=this.transform.groupby,null!=e?e:[])])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Object(r.m)(this.transform)}`}assemble(){const e=this.transform,{density:t}=e,n=Object(i.a)(e,["density"]);return Object.assign({type:"kde",field:t},n)}}},538:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(5),r=n(4),o=n(14),c=n(13),a=n(1),s=n(16),u=n(19);class l extends u.a{constructor(e,t){super(e),this.filter=t}clone(){return new l(null,Object.assign({},this.filter))}static make(e,t){const{config:n,mark:r,markDef:u}=t;if("filter"!==Object(s.e)("invalid",u,n))return null;const d=t.reduceFieldDef((e,n,a)=>{const s=Object(i.M)(a)&&t.getScaleComponent(a);if(s){const t=s.get("type");!Object(c.f)(t)||n.aggregate||Object(o.y)(r)||(e[n.field]=n)}return e},{});return Object(a.r)(d).length?new l(e,d):null}dependentFields(){return new Set(Object(a.r)(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Object(a.m)(this.filter)}`}assemble(){const e=Object(a.r)(this.filter).reduce((e,t)=>{const n=this.filter[t],i=Object(r.vgField)(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${i}) || (isValid(${i}) && isFinite(+${i})))`):"quantitative"===n.type&&(e.push(`isValid(${i})`),e.push(`isFinite(+${i})`))),e},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}},539:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){super(e),this.transform=t,this.transform=Object(i.f)(t);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map((e,t)=>{var n;return null!=(n=r[t])?n:e})}clone(){return new o(this.parent,Object(i.f)(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Object(i.m)(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}},54:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return u});var i=n(0);const r="mean",o={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function c(e){return!!o[e]}function a(e){return!!e&&!!e.encoding}function s(e){return!(!e||"count"!==e.op&&!e.field)}function u(e){return!!e&&Object(i.A)(e)}},540:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){var n,r,o;super(e),this.transform=t,this.transform=Object(i.f)(t);const c=null!=(n=this.transform.as)?n:[void 0,void 0];this.transform.as=[(r=c[0],null!=r?r:"key"),(o=c[1],null!=o?o:"value")]}clone(){return new o(null,Object(i.f)(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Object(i.m)(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}},541:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(0),r=n(5),o=n(4),c=n(45),a=n(1),s=n(19);class u extends s.a{constructor(e,t,n,i){super(e),this.fields=t,this.geojson=n,this.signal=i}clone(){return new u(null,Object(a.f)(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const i of[[r.k,r.i],[r.l,r.j]]){const r=i.map(e=>t.channelHasField(e)?t.fieldDef(e).field:Object(o.isValueDef)(t.encoding[e])?{expr:t.encoding[e].value+""}:void 0);(r[0]||r[1])&&(e=new u(e,r,null,t.getName(`geojson_${n++}`)))}if(t.channelHasField(r.t)){const i=t.fieldDef(r.t);i.type===c.a&&(e=new u(e,null,i.field,t.getName(`geojson_${n++}`)))}return e}dependentFields(){var e;const t=(e=this.fields,null!=e?e:[]).filter(i.H);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Object(a.m)(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}},542:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(0),r=n(5),o=n(4),c=n(1),a=n(19);class s extends a.a{constructor(e,t,n,i){super(e),this.projection=t,this.fields=n,this.as=i}clone(){return new s(null,this.projection,Object(c.f)(this.fields),Object(c.f)(this.as))}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[r.k,r.i],[r.l,r.j]]){const i=n.map(e=>t.channelHasField(e)?t.fieldDef(e).field:Object(o.isValueDef)(t.encoding[e])?{expr:t.encoding[e].value+""}:void 0),c=n[0]===r.l?"2":"";(i[0]||i[1])&&(e=new s(e,t.projectionName(),i,[t.getName("x"+c),t.getName("y"+c)]))}return e}dependentFields(){return new Set(this.fields.filter(i.H))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Object(c.m)(this.fields)} ${Object(c.m)(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}},543:function(e,t,n){"use strict";n.d(t,"b",function(){return D}),n.d(t,"a",function(){return $});var i=n(0),r=n(21),o=n(5),c=n(4),a=n(46),s=n(6),u=n(13),l=n(54),d=n(93),f=n(1),b=n(24),g=n(248),p=n(544),m=n(111),h=n(183),O=n(295),j=n(106),v=n(193),y=n(1045),x=n(185),w=n(20),k=n(551),S=n(137),F=n(99);function D(e,t,n){return Object(c.vgField)(t,Object.assign({suffix:`by_${Object(c.vgField)(e)}`},null!=n?n:{}))}class $ extends w.b{constructor(e,t,n,i,r){super(e,"facet",t,n,r,i,e.resolve),this.child=Object(g.a)(e.spec,this,this.getName("child"),void 0,i,r),this.children=[this.child];const o=Object(k.b)(e.facet,i);this.facet=this.initFacet(o)}initFacet(e){return Object(d.b)(e)?Object(a.h)(e,(e,t,n)=>Object(f.c)([o.q,o.c],n)?void 0===t.field?(s.e(s.b.emptyFieldDef(t,n)),e):(e[n]=Object(c.normalize)(t,n),e):(s.e(s.b.incompatibleChannel(n,"facet")),e),{}):{facet:Object(c.normalize)(e,"facet")}}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=Object(h.b)(this),this.child.parseData()}parseLayoutSize(){Object(x.a)(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Object(y.a)(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e,t,n,i;const r={};for(const c of o.e)for(const o of v.b){const a=this.component.layoutHeaders[c],s=a[o],{facetFieldDef:u}=a;if(u){const t=Object(j.c)("titleOrient",u,this.config,c);if(Object(f.c)(["right","bottom"],t)){const n=Object(j.a)(c,t);r.titleAnchor=null!=(e=r.titleAnchor)?e:{},r.titleAnchor[n]="end"}}if(null===(t=s)||void 0===t?void 0:t[0]){const e="row"===c?"height":"width",t="header"===o?"headerBand":"footerBand";"facet"===c||this.child.component.layoutSize.get(e)||(r[t]=null!=(n=r[t])?n:{},r[t][c]=.5),a.title&&(r.offset=null!=(i=r.offset)?i:{},r.offset["row"===c?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let i="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof $)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroup(e){return this.parent&&this.parent instanceof $?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Object(c.vgField)(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(e)):super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof $){if(this.child.channelHasField("column")){const i=Object(c.vgField)(this.child.facet.column);e.push(i),t.push("distinct"),n.push(`distinct_${i}`)}}else for(const i of["x","y"]){const r=this.child.component.scales[i];if(r&&!r.merged){const o=r.get("type"),c=r.get("range");if(Object(u.g)(o)&&Object(b.isVgRangeStep)(c)){const r=Object(S.a)(this.child,i),o=Object(S.b)(r);o?(e.push(o),t.push("distinct"),n.push(`distinct_${o}`)):s.e(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:a}=this.facet,{fields:s,ops:u,as:d}=this.getCardinalityAggregateForChild(),f=[];for(const e of o.e){const t=this.facet[e];if(t){f.push(Object(c.vgField)(t));const{bin:o,sort:b}=t;if(Object(r.e)(o)&&f.push(Object(c.vgField)(t,{binSuffix:"end"})),Object(l.e)(b)){const{field:e,op:i=l.a}=b,r=D(t,b);n&&a?(s.push(r),u.push("max"),d.push(r)):(s.push(e),u.push(i),d.push(r))}else if(Object(i.A)(b)){const n=Object(m.b)(t,e);s.push(n),u.push("max"),d.push(n)}}}const b=!!n&&!!a;return Object.assign({name:e,data:t,groupby:f},b||s.length>0?{aggregate:Object.assign(Object.assign({},b?{cross:b}:{}),s.length?{fields:s,ops:u,as:d}:{})}:{})}facetSortFields(e){const{facet:t}=this,n=t[e];return n?Object(l.e)(n.sort)?[D(n,n.sort,{expr:"datum"})]:Object(i.A)(n.sort)?[Object(m.b)(n,e,{expr:"datum"})]:[Object(c.vgField)(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(Object(l.e)(e)?e.order:!Object(i.A)(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return Object(O.b)(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const i of v.a)if(e[i]){const r=Object(j.c)("labelOrient",e[i],t,i);if(Object(f.c)(n[i],r))return Object(O.b)(e[i],i,t)}}assembleMarks(){const{child:e}=this,t=this.component.data.facetRoot,n=Object(p.a)(t),i=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),c=e.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),c?{style:c}:{}),{from:{facet:this.assembleFacet()},sort:{field:o.e.map(e=>this.facetSortFields(e)).flat(),order:o.e.map(e=>this.facetSortOrder(e)).flat()}}),n.length>0?{data:n}:{}),i?{encode:{update:i}}:{}),e.assembleGroup(Object(F.a)(this,[])))]}getMapping(){return this.facet}}},544:function(e,t,n){"use strict";n.d(t,"a",function(){return z}),n.d(t,"b",function(){return A});var i=n(33),r=n(196),o=n(112),c=n(111),a=n(19),s=n(537),u=n(213),l=n(250),d=n(538),f=n(539),b=n(540),g=n(89),p=n(541),m=n(542),h=n(345),O=n(214),j=n(404),v=n(211),y=n(545),x=n(546),w=n(547),k=n(548),S=n(549),F=n(550),D=n(346),$=n(138),E=n(256),C=n(192),N=n(291);function _(e){let t=0;return function n(_,z){var A;_ instanceof $.a&&!_.isGenerator&&!Object(i.i)(_.data)&&(e.push(z),z={name:null,source:z.name,transform:[]});if(_ instanceof g.a&&(_.parent instanceof $.a&&!z.source?(z.format=Object.assign(Object.assign({},null!=(A=z.format)?A:{}),{parse:_.assembleFormatParse()}),z.transform.push(..._.assembleTransforms(!0))):z.transform.push(..._.assembleTransforms())),_ instanceof u.a)return z.name||(z.name=`data_${t++}`),!z.source||z.transform.length>0?(e.push(z),_.data=z.name):_.data=z.source,void _.assemble().forEach(t=>e.push(t));(_ instanceof h.a||_ instanceof D.a||_ instanceof d.a||_ instanceof l.a||_ instanceof c.a||_ instanceof m.a||_ instanceof p.a||_ instanceof r.a||_ instanceof x.a||_ instanceof N.a||_ instanceof v.a||_ instanceof b.a||_ instanceof f.a||_ instanceof s.a||_ instanceof y.a||_ instanceof w.a||_ instanceof k.a||_ instanceof O.a||_ instanceof F.a||_ instanceof S.a)&&z.transform.push(_.assemble()),(_ instanceof o.a||_ instanceof C.a||_ instanceof j.a||_ instanceof E.a)&&z.transform.push(..._.assemble()),_ instanceof a.b&&(z.source&&0===z.transform.length?_.setSource(z.source):_.parent instanceof a.b?_.setSource(z.name):(z.name||(z.name=`data_${t++}`),_.setSource(z.name),1===_.numChildren()&&(e.push(z),z={name:null,source:z.name,transform:[]})));switch(_.numChildren()){case 0:_ instanceof a.b&&(!z.source||z.transform.length>0)&&e.push(z);break;case 1:n(_.children[0],z);break;default:{z.name||(z.name=`data_${t++}`);let i=z.name;!z.source||z.transform.length>0?e.push(z):i=z.source,_.children.forEach(e=>{n(e,{name:null,source:i,transform:[]})});break}}}}function z(e){const t=[],n=_(t);return e.children.forEach(t=>n(t,{source:e.name,name:null,transform:[]})),t}function A(e,t){var n,i;const r=[],o=_(r);let c=0;e.sources.forEach(e=>{e.hasName()||(e.dataName=`source_${c++}`);const t=e.assemble();o(e,t)}),r.forEach(e=>{0===e.transform.length&&delete e.transform});let a=0;for(const[e,t]of r.entries())0!==(n=t.transform,null!=n?n:[]).length||t.source||r.splice(a++,0,r.splice(e,1)[0]);for(const t of r)for(const n of null!=(i=t.transform)?i:[])"lookup"===n.type&&(n.from=e.outputNodes[n.from].getSource());for(const e of r)e.name in t&&(e.values=t[e.name]);return r}},545:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(18),r=n(1),o=n(19);class c extends o.a{constructor(e,t){var n,i,o;super(e),this.transform=t,this.transform=Object(r.f)(t);const c=null!=(n=this.transform.as)?n:[void 0,void 0];this.transform.as=[(i=c[0],null!=i?i:t.on),(o=c[1],null!=o?o:t.loess)]}clone(){return new c(null,Object(r.f)(this.transform))}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...(e=this.transform.groupby,null!=e?e:[])])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Object(r.m)(this.transform)}`}assemble(){const e=this.transform,{loess:t,on:n}=e,r=Object(i.a)(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}},546:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(0),r=n(6),o=n(60),c=n(1),a=n(19),s=n(183),u=n(138);class l extends a.a{constructor(e,t,n){super(e),this.transform=t,this.secondary=n}clone(){return new l(null,Object(c.f)(this.transform),this.secondary)}static make(e,t,n,i){const d=t.component.data.sources,{from:f}=n;let b=null;if(Object(o.m)(f)){let e=Object(s.a)(f.data,d);e||(e=new u.a(f.data),d.push(e));const n=t.getName(`lookup_${i}`);b=new a.b(e,n,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=b}else if(Object(o.n)(f)){const e=f.selection;if(n=Object.assign({as:e},n),!(b=t.getSelectionComponent(Object(c.H)(e),e).materialized))throw new Error(r.b.noSameUnitLookup(e))}return new l(e,n,b.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Object(i.i)(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Object(c.m)({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Object(i.i)(this.transform.as)}:{});else{let t=this.transform.as;Object(i.H)(t)||(r.e(r.b.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}},547:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(18),r=n(1),o=n(19);class c extends o.a{constructor(e,t){var n,i,o;super(e),this.transform=t,this.transform=Object(r.f)(t);const c=null!=(n=this.transform.as)?n:[void 0,void 0];this.transform.as=[(i=c[0],null!=i?i:"prob"),(o=c[1],null!=o?o:"value")]}clone(){return new c(null,Object(r.f)(this.transform))}dependentFields(){var e;return new Set([this.transform.quantile,...(e=this.transform.groupby,null!=e?e:[])])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Object(r.m)(this.transform)}`}assemble(){const e=this.transform,{quantile:t}=e,n=Object(i.a)(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}},548:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(18),r=n(1),o=n(19);class c extends o.a{constructor(e,t){var n,i,o;super(e),this.transform=t,this.transform=Object(r.f)(t);const c=null!=(n=this.transform.as)?n:[void 0,void 0];this.transform.as=[(i=c[0],null!=i?i:t.on),(o=c[1],null!=o?o:t.regression)]}clone(){return new c(null,Object(r.f)(this.transform))}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...(e=this.transform.groupby,null!=e?e:[])])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Object(r.m)(this.transform)}`}assemble(){const e=this.transform,{regression:t,on:n}=e,r=Object(i.a)(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}},549:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){super(e),this.transform=t}clone(){return new o(null,Object(i.f)(this.transform))}addDimensions(e){var t;this.transform.groupby=Object(i.E)((t=this.transform.groupby,null!=t?t:[]).concat(e),e=>e)}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...(e=this.transform.groupby,null!=e?e:[])])}hash(){return`PivotTransform ${Object(i.m)(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:n,limit:i,op:r}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:t},void 0!==i?{limit:i}:{}),void 0!==r?{op:r}:{}),void 0!==n?{groupby:n}:{})}}},550:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(1),r=n(19);class o extends r.a{constructor(e,t){super(e),this.transform=t}clone(){return new o(null,Object(i.f)(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Object(i.m)(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}},551:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l});var i=n(18),r=n(0),o=n(4),c=n(6),a=n(54),s=n(93);function u(e,t){return Object(s.b)(e)?g(e,t):f(e,t)}function l(e,t){return g(e,t)}function d(e,t){return Object(o.isRepeatRef)(e.field)?e.field.repeat in t?Object.assign(Object.assign({},e),{field:t[e.field.repeat]}):void c.e(c.b.noSuchRepeatedValue(e.field.repeat)):e}function f(e,t){if(void 0!==(e=d(e,t))){if(null===e)return null;if(Object(o.isSortableFieldDef)(e)&&Object(a.e)(e.sort)){const n=d(e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function b(e,t){if(!Object(o.isFieldDef)(e)){if(Object(o.hasConditionalFieldDef)(e)){const n=f(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});{const{condition:t}=e;return Object(i.a)(e,["condition"])}}return e}{const n=f(e,t);if(n)return n;if(Object(o.isConditionalDef)(e))return{condition:e.condition}}}function g(e,t){const n={};for(const i in e)if(Object(r.v)(e,i)){const o=e[i];if(Object(r.A)(o))n[i]=o.map(e=>b(e,t)).filter(e=>e);else{const e=b(o,t);void 0!==e&&(n[i]=e)}}return n}},552:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return j});var i=n(130),r=n(21),o=n(5),c=n(4),a=n(1),s=n(24),u=n(16),l=n(536),d=n(252),f=n(31),b=n(561),g=n(533),p=n(1047),m=n(120);function h(e){return o.p.reduce((t,n)=>(e.component.scales[n]&&e.axis(n)&&(t[n]=[k(n,e)]),t),{})}const O={bottom:"top",top:"bottom",left:"right",right:"left"};function j(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const t of e.children){t.parseAxesAndHeaders();for(const r of Object(a.r)(t.component.axes))i.axis[r]=Object(d.b)(e.component.resolve,r),"shared"===i.axis[r]&&(n[r]=v(n[r],t.component.axes[r]),n[r]||(i.axis[r]="independent",delete n[r]))}for(const c of[o.z,o.B]){for(const o of e.children)if(o.component.axes[c]){if("independent"===i.axis[c]){n[c]=(t=n[c],null!=t?t:[]).concat(o.component.axes[c]);for(const e of o.component.axes[c]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(r[t]>0&&!n){const n=O[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}delete o.component.axes[c]}if("independent"===i.axis[c]&&n[c]&&n[c].length>1)for(const e of n[c])e.get("grid")&&!e.explicit.grid&&(e.implicit.grid=!1)}}function v(e,t){if(!e)return t.map(e=>e.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const n=e[i],r=t[i];if(!!n!=!!r)return;if(n&&r){const t=n.getWithExplicit("orient"),o=r.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[i]=y(n,r)}}}return e}function y(e,t){for(const n of b.a){const i=Object(f.e)(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(e,t)=>{switch(n){case"title":return Object(u.i)(e,t);case"gridScale":return{explicit:e.explicit,value:Object(a.k)(e.value,t.value)}}return Object(f.b)(e,t,n,"axis")});e.setWithExplicit(n,i)}return e}function x(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,c=r?r.title:void 0;return o&&c?Object(u.h)(o,c):o||(c||(void 0!==o?o:void 0!==c?c:void 0))}function w(e,t,n,i,r){switch(t){case"titleAngle":case"labelAngle":return e===Object(a.u)(n[t]);case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===x(i,r))return!0}return e===n[t]}function k(e,t){var n;const r=t.axis(e),o=new b.b;for(const n of b.a){const c=S(n,r,e,t),{configValue:u,configFrom:l}=Object(g.a)(n,t.config,e,o.get("orient"),t.getScaleComponent(e).get("type"));if(void 0!==c){const i=w(c,n,r,t,e);i||void 0===u?o.set(n,c,i):Object(a.c)(["grid","orient"],n)&&u&&o.set(n,u,!1)}else(Object(i.f)(u)||Object(s.isSignalRef)(u)||Object(a.c)(["axisQuantitative","axisTemporal"],l))&&o.set(n,u,!1)}const c=null!=(n=r.encoding)?n:{},u=i.a.reduce((n,i)=>{var r;if(!o.hasAxisPart(i))return n;const s=Object(l.a)(null!=(r=c[i])?r:{},t),u="labels"===i?p.a(t,e,s):s;return void 0!==u&&Object(a.r)(u).length>0&&(n[i]={update:u}),n},{});return Object(a.r)(u).length>0&&o.set("encode",u,!!r.encoding||void 0!==r.labelAngle),o}function S(e,t,n,o){const s=o.fieldDef(n),l=m.i(o,t,n,s),d=Object(a.k)(t.orient,m.j(n)),{mark:f,config:b}=o;switch(e){case"scale":return o.scaleName(n);case"gridScale":return m.h(o,n);case"format":if(Object(c.isTimeFormatFieldDef)(s))return;return Object(u.k)(s,t.format,b);case"formatType":if(Object(c.isTimeFormatFieldDef)(s))return;return t.formatType;case"grid":if(Object(r.d)(o.fieldDef(n).bin))return!1;{const e=o.getScaleComponent(n).get("type");return Object(a.k)(t.grid,m.a(e,s))}case"labelAlign":return Object(a.k)(t.labelAlign,m.b(l,d));case"labelAngle":return l;case"labelBaseline":return Object(a.k)(t.labelBaseline,m.c(l,d));case"labelFlush":return Object(a.k)(t.labelFlush,m.d(s,n));case"labelOverlap":{const e=o.getScaleComponent(n).get("type");return Object(a.k)(t.labelOverlap,m.e(s,e))}case"orient":return d;case"tickCount":{const e=o.getScaleComponent(n).get("type"),i="x"===n?"width":"y"===n?"height":void 0,r=i?o.getSizeSignalRef(i):void 0;return Object(a.k)(t.tickCount,m.f({fieldDef:s,scaleType:e,size:r}))}case"title":{const e="x"===n?"x2":"y2",i=o.fieldDef(e);return Object(a.k)(t.title,x(o,n),Object(u.j)([Object(c.toFieldDefBase)(s)],i?[Object(c.toFieldDefBase)(i)]:[]))}case"values":return m.k(t,o,s);case"zindex":return Object(a.k)(t.zindex,m.g(f,s))}return Object(i.e)(e)?t[e]:void 0}},553:function(e,t,n){"use strict";n.d(t,"a",function(){return x});var i=n(5),r=n(4),o=n(33),c=n(46),a=n(14),s=n(76),u=n(525),l=n(249),d=n(552),f=n(183),b=n(251),g=n(1048),p=n(185),m=n(1049),h=n(1050),O=n(20),j=n(551),v=n(99),y=n(147);class x extends O.b{constructor(e,t,n,i={},r,l){var d;super(e,"unit",t,n,l,r,void 0,Object(s.c)(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const f=Object(a.x)(e.mark)?e.mark.type:e.mark,b=Object(j.a)(null!=(d=e.encoding)?d:{},r);this.markDef=Object(m.a)(e.mark,b,l,{graticule:e.data&&Object(o.d)(e.data)});const p=this.encoding=Object(c.f)(b,this.markDef);this.size=Object(g.a)({encoding:p,size:Object(s.c)(e)?Object.assign(Object.assign(Object.assign({},i),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):i}),this.stack=Object(u.a)(f,p),this.specifiedScales=this.initScales(f,p),this.specifiedAxes=this.initAxes(p),this.specifiedLegends=this.initLegend(p),this.specifiedProjection=e.projection,this.selection=e.selection}get hasProjection(){const{encoding:e}=this,t=this.mark===a.f,n=e&&i.h.some(t=>Object(r.isFieldDef)(e[t]));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return i.r.reduce((e,n)=>{let i,o;const c=t[n];return Object(r.isFieldDef)(c)?(i=c,o=c.scale):Object(r.hasConditionalFieldDef)(c)&&(i=c.condition,o=c.condition.scale),i&&(e[n]=null!=o?o:{}),e},{})}initAxes(e){return[i.z,i.B].reduce((t,n)=>{const o=e[n];if(Object(r.isFieldDef)(o)||n===i.z&&Object(r.isFieldDef)(e.x2)||n===i.B&&Object(r.isFieldDef)(e.y2)){const e=Object(r.isFieldDef)(o)?o.axis:null;null!==e&&(t[n]=Object.assign({},e))}return t},{})}initLegend(e){return i.n.reduce((t,n)=>{const o=e[n];if(o){const e=Object(r.isFieldDef)(o)?o.legend:Object(r.hasConditionalFieldDef)(o)?o.condition.legend:null;null!==e&&!1!==e&&Object(i.Q)(n)&&(t[n]=Object.assign({},e))}return t},{})}parseData(){this.component.data=Object(f.b)(this)}parseLayoutSize(){Object(p.e)(this)}parseSelections(){this.component.selection=Object(y.d)(this,this.selection)}parseMarkGroup(){this.component.mark=Object(h.a)(this)}parseAxesAndHeaders(){this.component.axes=Object(d.b)(this)}assembleSelectionTopLevelSignals(e){return Object(v.e)(this,e)}assembleSignals(){return[...Object(l.c)(this),...Object(v.h)(this,[])]}assembleSelectionData(e){return Object(v.f)(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return Object(b.a)(this)}assembleMarks(){var e;let t=null!=(e=this.component.mark)?e:[];return this.parent&&Object(O.e)(this.parent)||(t=Object(v.g)(this,t)),t.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return c.a(this.encoding,e)}fieldDef(e){const t=this.encoding[e];return Object(r.getTypedFieldDef)(t)}}},560:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n(523),r=n(1),o=n(31);const c=Object.assign(Object.assign({},i.a),{labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),a=Object(r.r)(c);class s extends o.a{}},561:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n(130),r=n(1),o=n(31);const c=Object.assign(Object.assign({gridScale:1,scale:1},i.c),{labelExpr:1,encode:1}),a=Object(r.r)(c);class s extends o.a{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new s(Object(r.f)(this.explicit),Object(r.f)(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}}},562:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return a});var i=n(26);function r(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),i.f("x",e,{defaultPos:"mid"})),i.f("y",e,{defaultPos:"mid"})),i.d("size",e)),function(e,t,n){if(n)return{shape:{value:n}};return i.d("shape",e)}(e,0,t))}const o={vgMark:"symbol",encodeEntry:e=>r(e)},c={vgMark:"symbol",encodeEntry:e=>r(e,"circle")},a={vgMark:"symbol",encodeEntry:e=>r(e,"square")}},582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_INDEX={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1},t.isType=function(e){return!!t.TYPE_INDEX[e]},t.QUANTITATIVE="quantitative",t.ORDINAL="ordinal",t.TEMPORAL="temporal",t.NOMINAL="nominal",t.GEOJSON="geojson",t.getFullName=function(e){if(e)switch(e=e.toLowerCase()){case"q":case t.QUANTITATIVE:return"quantitative";case"t":case t.TEMPORAL:return"temporal";case"o":case t.ORDINAL:return"ordinal";case"n":case t.NOMINAL:return"nominal";case t.GEOJSON:return"geojson"}}},594:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var i=n(13),r=n(1),o=n(16),c=n(77);function a(e){const{config:t,markDef:n}=e;if(Object(o.e)("invalid",n,t)){const t=function(e,{invalid:t=!1,channels:n}){const o=n.reduce((t,n)=>{const r=e.getScaleComponent(n);if(r){const o=r.get("type"),c=e.vgField(n,{expr:"datum"});c&&Object(i.f)(o)&&(t[c]=!0)}return t},{}),a=Object(r.r)(o);if(a.length>0){const e=t?"||":"&&";return a.map(e=>Object(c.a)(e,t)).join(` ${e} `)}return}(e,{channels:["x","y"]});if(t)return{defined:{signal:t}}}return{}}function s(e,t){if(void 0!==t)return{[e]:{value:t}}}},6:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return l});var i=n(0);const r=n(1025),o=Object(i.K)(i.e);let c=o;function a(e){return c=e}function s(){return c=o}function u(...e){c.warn(...e)}function l(...e){c.debug(...e)}},60:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"i",function(){return c}),n.d(t,"l",function(){return a}),n.d(t,"m",function(){return s}),n.d(t,"n",function(){return u}),n.d(t,"o",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"p",function(){return f}),n.d(t,"q",function(){return b}),n.d(t,"k",function(){return g}),n.d(t,"r",function(){return p}),n.d(t,"u",function(){return m}),n.d(t,"j",function(){return h}),n.d(t,"f",function(){return O}),n.d(t,"c",function(){return j}),n.d(t,"b",function(){return v}),n.d(t,"h",function(){return y}),n.d(t,"t",function(){return x}),n.d(t,"a",function(){return w}),n.d(t,"s",function(){return k}),n.d(t,"g",function(){return S}),n.d(t,"v",function(){return F});var i=n(254),r=n(104);function o(e){return void 0!==e.filter}function c(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.stop)}function a(e){return void 0!==e.lookup}function s(e){return void 0!==e.data}function u(e){return void 0!==e.selection}function l(e){return void 0!==e.pivot}function d(e){return void 0!==e.density}function f(e){return void 0!==e.quantile}function b(e){return void 0!==e.regression}function g(e){return void 0!==e.loess}function p(e){return void 0!==e.sample}function m(e){return void 0!==e.window}function h(e){return void 0!==e.joinaggregate}function O(e){return void 0!==e.flatten}function j(e){return void 0!==e.calculate}function v(e){return!!e.bin}function y(e){return void 0!==e.impute}function x(e){return void 0!==e.timeUnit}function w(e){return void 0!==e.aggregate}function k(e){return void 0!==e.stack}function S(e){return void 0!==e.fold}function F(e){return e.map(e=>o(e)?{filter:Object(i.e)(e.filter,r.h)}:e)}},656:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(31);class r extends i.a{constructor(e,t,n,i){super(Object.assign({},t),{name:e}),this.specifiedProjection=t,this.size=n,this.data=i,this.merged=!1}get isFit(){return!!this.data}}},657:function(e,t,n){"use strict";n.d(t,"a",function(){return i});n(1),n(19),n(138);function i(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return console.error("Dataflow graph is inconsistent.",t,e),!1;if(!i(t.children))return!1}return!0}},658:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(0),r=n(1),o=n(31);class c extends o.a{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Object(r.B)(this.get("domains"),e=>Object(i.A)(e)&&2===e.length&&e[0]<=0&&e[1]>=0)}}},659:function(e,t,n){"use strict";n.d(t,"a",function(){return g}),n.d(t,"b",function(){return p});var i=n(0),r=n(21),o=n(5),c=n(6),a=n(13),s=n(1),u=n(112),l=n(20),d=n(31),f=n(156),b=n(1041);function g(e,t){Object(l.g)(e)?function(e,t){const n=e.component.scales;Object(s.r)(n).forEach(l=>{const d=e.specifiedScales[l],b=n[l],g=e.getScaleComponent(l),p=e.fieldDef(l),m=e.config,h=d[t],O=g.get("type"),j=Object(a.q)(O,t),v=Object(a.c)(l,t);if(void 0!==h&&(j?v&&c.e(v):c.e(c.b.scalePropertyNotWorkWithScaleType(O,t,l))),j&&void 0===v)if(void 0!==h)b.copyKeyFromObject(t,d);else{const n=function(e,t,n,c,l,d,b,g,p,m){const h=m.scale,{type:O,sort:j}=c;switch(e){case"bins":return function(e,t){const n=t.bin;if(Object(r.e)(n)){const i=Object(u.b)(e,t.field,n);return new f.a(()=>e.getSignalName(i))}if(Object(r.d)(n)&&Object(r.c)(n)&&void 0!==n.step)return{step:n.step};return}(t,c);case"interpolate":return function(e,t){if(Object(s.c)([o.b,o.f,o.v],e)&&"nominal"!==t)return"hcl";return}(n,O);case"nice":return function(e,t,n){if(n.bin||s.c([a.b.TIME,a.b.UTC],e))return;return!!s.c([o.z,o.B],t)||void 0}(l,n,c);case"padding":return function(e,t,n,i,r,c){if(s.c([o.z,o.B],e)){if(Object(a.h)(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:o}=r;if("bar"===t&&!i.bin&&!i.timeUnit&&("vertical"===o&&"x"===e||"horizontal"===o&&"y"===e))return c.continuousBandSize}if(t===a.b.POINT)return n.pointPadding}return}(n,l,h,c,p,m.bar);case"paddingInner":return function(e,t,n,i){if(void 0!==e)return;if(s.c([o.z,o.B],t)){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:r}=i;return Object(s.k)(e,"bar"===n?t:r)}return}(d,n,p.type,h);case"paddingOuter":return function(e,t,n,i,r,c){if(void 0!==e)return;if(s.c([o.z,o.B],t)&&n===a.b.BAND){const{bandPaddingOuter:e}=c;return Object(s.k)(e,r/2)}return}(d,n,l,p.type,b,h);case"reverse":return function(e,t){if(Object(a.f)(e)&&"descending"===t)return!0;return}(l,j);case"zero":return function(e,t,n,r,c){if(n&&"unaggregated"!==n&&Object(a.f)(c)){if(Object(i.A)(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Object(a.i)(c))return!0;if(!t.bin&&s.c([o.z,o.B],e)){const{orient:t,type:n}=r;return!Object(s.c)(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e)}return!1}(n,c,g,p,l)}return h[e]}(t,e,l,p,g.get("type"),g.get("padding"),g.get("paddingInner"),d.domain,e.markDef,m);void 0!==n&&b.set(t,n,!1)}})}(e,t):m(e,t)}function p(e){Object(l.g)(e)?Object(b.a)(e):m(e,"range")}function m(e,t){const n=e.component.scales;for(const n of e.children)"range"===t?p(n):g(n,t);Object(s.r)(n).forEach(i=>{let r;for(const n of e.children){const e=n.component.scales[i];if(e){const n=e.getWithExplicit(t);r=Object(d.e)(r,n,t,"scale",Object(d.f)((e,n)=>{switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0}))}}n[i].setWithExplicit(t,r)})}},660:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var i=n(26);const r={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"})),i.f("x",e,{defaultPos:"mid"})),i.f("y",e,{defaultPos:"mid"})),i.d("size",e,{vgChannel:"strokeWidth"})),i.c(e))},o={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i.a(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),i.f("x",e,{defaultPos:"mid"})),i.f("y",e,{defaultPos:"mid"})),i.d("size",e)),i.c(e))}},75:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"d",function(){return h}),n.d(t,"c",function(){return O}),n.d(t,"a",function(){return j}),n.d(t,"e",function(){return k}),n.d(t,"f",function(){return $});var i=n(18),r=n(12),o=n(0),c=n(130),a=n(1024),s=n(1026),u=n(523),l=n(14),d=n(13),f=n(115),b=n(76),g=n(155),p=n(1);function m(e,t){var n;return null!=(n=e[t])?n:e["width"===t?"continuousWidth":"continuousHeight"]}function h(e,t){const n=O(e,t);return Object(b.d)(n)?n.step:j}function O(e,t){var n;const i=null!=(n=e[t])?n:e["width"===t?"discreteWidth":"discreteHeight"];return Object(p.k)(i,{step:e.step})}const j=20;const v={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:j},mark:l.t,area:{},bar:l.s,circle:{},geoshape:{},image:{},line:{},point:{},rect:l.u,rule:{color:"black"},square:{},text:{color:"black"},tick:l.v,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:d.e,projection:{},axis:{},axisX:{},axisY:{},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:u.b,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:f.b,style:{},title:{},facet:{spacing:b.a},repeat:{spacing:b.a},concat:{spacing:b.a}},y=Object(r.F)("tableau10"),x={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},w={blue:y[0],orange:y[1],red:y[2],teal:y[3],green:y[4],yellow:y[5],purple:y[6],pink:y[7],brown:y[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function k(e={}){const{color:t,font:n,fontSize:r}=e,c=Object(i.a)(e,["color","font","fontSize"]);return Object(o.M)({},v,n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e={}){return{signals:[{name:"color",value:Object(o.F)(e)?Object.assign(Object.assign({},w),e):w}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:Object(o.F)(e)?Object.assign(Object.assign({},x),e):x}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},c||{})}const S=["view",...l.j],F=["color","fontSize","background","padding","facet","concat","repeat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","scale","selection","overlay"],D=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},l.r);function $(e){e=Object(p.f)(e);for(const t of F)delete e[t];if(e.axis)for(const t in e.axis)Object(c.f)(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of s.a)delete e.legend[t];if(e.mark)for(const t of l.q)delete e.mark[t];for(const t of S){for(const n of l.q)delete e[t][n];const n=D[t];if(n)for(const i of n)delete e[t][i];E(e,t)}for(const t of Object(a.a)())delete e[t];!function(e){const{mark:t,subtitle:n}=Object(g.a)(e.title),i=Object.assign(Object.assign({},t),e.style["group-title"]);Object(p.r)(i).length>0&&(e.style["group-title"]=i);Object(p.r)(n).length>0?e.title=n:delete e.title}(e);for(const t in e)Object(o.F)(e[t])&&0===Object(p.r)(e[t]).length&&delete e[t];return Object(p.r)(e).length>0?e:void 0}function E(e,t,n,i){const r=i?e[t][i]:e[t];"view"===t&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[null!=n?n:t]);Object(p.r)(o).length>0&&(e.style[null!=n?n:t]=o),i||delete e[t]}},76:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return f});var i=n(0),r=n(1),o=n(177),c=n(93),a=n(332);function s(e){return Object(i.F)(e)&&void 0!==e.step}function u(e){return e.view||e.width||e.height}const l=20,d=Object(r.r)({align:1,bounds:1,center:1,columns:1,spacing:1});function f(e,t,n){var r,s;const u=n[t],l={},{spacing:f,columns:b}=u;void 0!==f&&(l.spacing=f),void 0!==b&&(Object(c.c)(e)&&!Object(c.b)(e.facet)||Object(a.a)(e)&&Object(i.A)(e.repeat)||Object(o.b)(e))&&(l.columns=b);for(const t of d)if(void 0!==e[t])if("spacing"===t){const n=e[t];l[t]=Object(i.E)(n)?n:{row:(r=n.row,null!=r?r:f),column:(s=n.column,null!=s?s:f)}}else l[t]=e[t];return l}},77:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"g",function(){return h}),n.d(t,"a",function(){return j}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return y}),n.d(t,"d",function(){return x}),n.d(t,"f",function(){return w});var i=n(0),r=n(51),o=n(21),c=n(5),a=n(4),s=n(6),u=n(14),l=n(104),d=n(13),f=n(45),b=n(1),g=n(24),p=n(16);function m(e){const{channel:t,channelDef:n,markDef:i,scale:o}=e,c=x(e);return Object(a.isFieldDef)(n)&&!Object(r.g)(n.aggregate)&&o&&Object(d.h)(o.get("type"))&&!1===o.get("zero")?h({fieldDef:n,channel:t,markDef:i,ref:c}):c}function h({fieldDef:e,channel:t,markDef:n,ref:i}){return Object(u.y)(n.type)?i:[O(e,t),i]}function O(e,t){const n=j(e,!0),i="x"===Object(c.D)(t)?{value:0}:{field:{group:"height"}};return Object.assign({test:n},i)}function j(e,t=!0){return Object(l.b)(Object(i.H)(e)?e:Object(a.vgField)(e,{expr:"datum"}),!t)}function v(e,t,n,i){const r=Object.assign(Object.assign({},t?{scale:t}:{}),{field:Object(a.vgField)(e,n)});if(i){const{offset:e,band:t}=i;return Object.assign(Object.assign(Object.assign({},r),e?{offset:e}:{}),t?{band:t}:{})}return r}function y({scaleName:e,fieldDef:t,fieldDef2:n,offset:i,startSuffix:r,band:o=.5}){const c=0<o&&o<1?"datum":void 0,s=Object(a.vgField)(t,{expr:c,suffix:r}),u=void 0!==n?Object(a.vgField)(n,{expr:c}):Object(a.vgField)(t,{suffix:"end",expr:c});if(0===o)return Object.assign({scale:e,field:s},i?{offset:i}:{});if(1===o)return Object.assign({scale:e,field:u},i?{offset:i}:{});{const t=`${o} * ${s} + ${1-o} * ${u}`;return Object.assign({signal:`scale("${e}", ${t})`},i?{offset:i}:{})}}function x({channel:e,channelDef:t,channel2Def:n,markDef:r,config:u,scaleName:l,scale:p,stack:m,offset:h,defaultRef:O}){if(t){if(Object(a.isFieldDef)(t)){if(Object(a.isTypedFieldDef)(t)){const i=Object(a.getBand)(e,t,n,r,u,{isMidPoint:!0});if(Object(o.e)(t.bin)||i&&t.timeUnit)return Object(b.c)([c.z,c.B],e)&&Object(b.c)([f.d,f.e],t.type)?m&&m.impute?v(t,l,{binSuffix:"mid"},{offset:h}):y({scaleName:l,fieldDef:t,band:i,offset:h}):v(t,l,Object(a.binRequiresRange)(t,e)?{binSuffix:"range"}:{},{offset:h});if(Object(o.d)(t.bin)){if(Object(a.isFieldDef)(n))return y({scaleName:l,fieldDef:t,fieldDef2:n,band:i,offset:h});{const t=e===c.z?c.A:c.C;s.e(s.b.channelRequiredForBinned(t))}}}if(p){const e=p.get("type");if(Object(d.g)(e)){if("band"===e){return v(t,l,{binSuffix:"range"},{band:Object(b.k)(Object(a.isPositionFieldDef)(t)?t.band:void 0,.5),offset:h})}return v(t,l,{binSuffix:"range"},{offset:h})}}return v(t,l,{},{offset:h})}if(Object(a.isValueDef)(t)){const n=t.value,i=h?{offset:h}:{};return Object.assign(Object.assign({},w(e,n)),i)}if(Object(g.isSignalRef)(t))return t}const j=Object(i.D)(O)?Object.assign(Object.assign({},O()),h?{offset:h}:{}):O;return j?Object.assign(Object.assign({},j),h?{offset:h}:{}):j}function w(e,t){return Object(b.c)(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Object(b.c)(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:Object(p.l)(t)}},80:function(e,t,n){"use strict";var i=n(177);n.d(t,"a",function(){return i.a}),n.d(t,"c",function(){return i.c}),n.d(t,"g",function(){return i.d});var r=n(93);n.d(t,"b",function(){return r.c});var o=n(489);n.d(t,"d",function(){return o.a});var c=n(332);n.d(t,"e",function(){return c.a});var a=n(123);n.d(t,"f",function(){return a.a})},871:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n(0),r=n(5),o=n(4),c=n(75),a=n(6),s=n(488),u=n(410),l=n(1),d=n(248),f=n(544),b=n(290);function g(e,t={}){t.logger&&a.d(t.logger),t.fieldTitle&&o.setTitleFormatter(t.fieldTitle);try{const n=Object(c.e)(Object(i.M)(t.config,e.config)),g=Object(s.a)(e,n),p=Object(d.a)(g,null,"",void 0,void 0,n);return p.parse(),Object(b.b)(p.component.data,p),{spec:function(e,t,n={},i){const r=e.config?Object(c.f)(e.config):void 0,o=[].concat(e.assembleSelectionData([]),Object(f.b)(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let d=e.assembleLayoutSignals();return d=d.filter(e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...d,...e.assembleSelectionTopLevelSignals([])])),r?{config:r}:{}),i?{usermeta:i}:{})}(p,function(e,t,n,o){const c=o.component.layoutSize.get("width"),s=o.component.layoutSize.get("height");void 0===t?t={type:"pad"}:Object(i.H)(t)&&(t={type:t});if(c&&s&&Object(u.c)(t.type))if("step"===c&&"step"===s)a.e(a.b.droppingFit()),t.type="pad";else if("step"===c||"step"===s){const e="step"===c?"width":"height";a.e(a.b.droppingFit(Object(r.F)(e)));const n="width"===e?"height":"width";t.type=Object(u.b)(n)}return Object.assign(Object.assign(Object.assign({},1===Object(l.r)(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Object(u.a)(n)),Object(u.a)(e))}(e,g.autosize,n,p),e.datasets,e.usermeta),normalized:g}}finally{t.logger&&a.c(),t.fieldTitle&&o.resetTitleFormatter()}}},872:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n(0),r=n(5),o=n(14),c=n(13),a=n(1),s=n(24),u=n(16),l=n(320),d=n(98),f=n(204),b=n(269),g=n(77);n(172),n(178),n(227),n(377);function p(e,t){const{fill:n,stroke:i}="include"===t.color?Object(l.a)(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return s.VG_MARK_CONFIGS.reduce((n,i)=>(void 0!==e[i]&&"ignore"!==t[i]&&(n[i]={value:e[i]}),n),{})}(e.markDef,t)),m(e,"fill",n)),m(e,"stroke",i)),Object(d.a)("opacity",e)),Object(d.a)("fillOpacity",e)),Object(d.a)("strokeOpacity",e)),Object(d.a)("strokeWidth",e)),Object(d.a)("strokeDash",e)),Object(b.a)(e)),Object(f.a)(e,"href"))}function m(e,t,n){const{config:s,mark:l,markDef:d}=e;if("hide"===Object(u.e)("invalid",d,s)&&n&&!Object(o.y)(l)){const o=function(e,{invalid:t=!1,channels:n}){const i=n.reduce((t,n)=>{const i=e.getScaleComponent(n);if(i){const r=i.get("type"),o=e.vgField(n,{expr:"datum"});o&&Object(c.f)(r)&&(t[o]=!0)}return t},{}),r=Object(a.r)(i);if(r.length>0){const e=t?"||":"&&";return r.map(e=>Object(g.a)(e,t)).join(` ${e} `)}return}(e,{invalid:!0,channels:r.r});if(o)return{[t]:[{test:o,value:null},...Object(i.i)(n)]}}return n?{[t]:n}:{}}},873:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(46),r=n(524);const o=new class extends r.a{mapUnit(e,{config:t}){if(e.encoding){const{encoding:n,transform:r}=e,{bins:o,timeUnits:c,aggregate:a,groupby:s,encoding:u}=Object(i.b)(n,t),l=[...r||[],...o,...c,...0===a.length?[]:[{aggregate:a,groupby:s}]];return Object.assign(Object.assign(Object.assign({},e),l.length>0?{transform:l}:{}),{encoding:u})}return e}};function c(e,t){return o.map(e,{config:t})}},89:function(e,t,n){"use strict";n.d(t,"c",function(){return j}),n.d(t,"b",function(){return v}),n.d(t,"d",function(){return y}),n.d(t,"a",function(){return x});var i=n(0),r=n(51),o=n(5),c=n(4),a=n(33),s=n(154),u=n(6),l=n(254),d=n(14),f=n(104),b=n(54),g=n(1),p=n(20),m=n(31),h=n(19);function O(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function j(e){const t={};return Object(l.a)(e.filter,e=>{var n;if(Object(f.e)(e)){let r=null;Object(f.c)(e)?r=e.equal:Object(f.f)(e)?r=e.range[0]:Object(f.d)(e)&&(r=(n=e.oneOf,null!=n?n:e.in)[0]),r&&(Object(s.d)(r)?t[e.field]="date":Object(i.E)(r)?t[e.field]="number":Object(i.H)(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}}),t}function v(e){const t={};function n(e){Object(c.isTimeFormatFieldDef)(e)?t[e.field]="date":"quantitative"===e.type&&Object(r.h)(e.aggregate)?t[e.field]="number":Object(g.a)(e.field)>1?e.field in t||(t[e.field]="flatten"):Object(c.isScaleFieldDef)(e)&&Object(b.e)(e.sort)&&Object(g.a)(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((Object(p.g)(e)||Object(p.d)(e))&&e.forEachFieldDef((t,i)=>{if(Object(c.isTypedFieldDef)(t))n(t);else{const r=Object(o.D)(i),c=e.fieldDef(r);n(Object.assign(Object.assign({},t),{type:c.type}))}}),Object(p.g)(e)){const{mark:n,markDef:i,encoding:r}=e;if(Object(d.y)(n)&&!e.encoding.order){const e=r["horizontal"===i.orient?"y":"x"];!Object(c.isFieldDef)(e)||"quantitative"!==e.type||e.field in t||(t[e.field]="number")}}return t}function y(e){const t={};if(Object(p.g)(e)&&e.component.selection)for(const n of Object(g.r)(e.component.selection)){const i=e.component.selection[n];for(const e of i.project.items)!e.channel&&Object(g.a)(e.field)>1&&(t[e.field]="flatten")}return t}class x extends h.a{constructor(e,t){super(e),this._parse=t}clone(){return new x(null,Object(g.f)(this._parse))}hash(){return`Parse ${Object(g.m)(this._parse)}`}static makeExplicit(e,t,n){let i={};const r=t.data;return!Object(a.c)(r)&&r&&r.format&&r.format.parse&&(i=r.format.parse),this.makeWithAncestors(e,i,{},n)}static makeWithAncestors(e,t,n,i){for(const e of Object(g.r)(n)){const t=i.getWithExplicit(e);void 0!==t.value&&(t.explicit||t.value===n[e]||"derived"===t.value||"flatten"===n[e]?delete n[e]:u.e(u.b.differentParse(e,n[e],t.value)))}for(const e of Object(g.r)(t)){const n=i.get(e);void 0!==n&&(n===t[e]?delete t[e]:u.e(u.b.differentParse(e,t[e],n)))}const r=new m.a(t,n);i.copyAll(r);const o={};for(const e of Object(g.r)(r.combine())){const t=r.get(e);null!==t&&(o[e]=t)}return 0===Object(g.r)(o).length||i.parseNothing?null:new x(e,o)}get parse(){return this._parse}merge(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}assembleFormatParse(){const e={};for(const t of Object(g.r)(this._parse)){const n=this._parse[t];1===Object(g.a)(t)&&(e[t]=n)}return e}producedFields(){return new Set(Object(g.r)(this._parse))}dependentFields(){return new Set(Object(g.r)(this._parse))}assembleTransforms(e=!1){return Object(g.r)(this._parse).filter(t=>!e||Object(g.a)(t)>1).map(e=>{const t=function(e,t){const n=Object(g.b)(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(0===t.indexOf("date:"))return`timeParse(${n},'${O(t.slice(5,t.length))}')`;if(0===t.indexOf("utc:"))return`utcParse(${n},'${O(t.slice(4,t.length))}')`;return u.e(u.b.unrecognizedParse(t)),null}(e,this._parse[e]);return t?{type:"formula",expr:t,as:Object(g.x)(e)}:null}).filter(e=>null!==e)}}},93:function(e,t,n){"use strict";function i(e){return!!e.row||!!e.column}function r(e){return!!e&&!!e.header}function o(e){return void 0!==e.facet}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o})},98:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1),r=n(16),o=n(172),c=n(77);function a(e,t,n={}){const{markDef:a,encoding:s,config:u}=t,{vgChannel:l=e}=n;let{defaultRef:d,defaultValue:f}=n;void 0===d&&void 0!==(f=null!=f?f:l===e?a[e]:Object(i.k)(a[e],a[l],Object(r.d)(e,a,u,{vgChannel:l})))&&(d=Object(r.l)(f));const b=s[e];return Object(o.a)(t,b,l,n=>c.d({channel:e,channelDef:n,markDef:a,config:u,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:d}))}},99:function(e,t,n){"use strict";n.d(t,"b",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return O}),n.d(t,"d",function(){return j});var i=n(18),r=n(125),o=n(0),c=n(32),a=n(154),s=n(1),u=n(20),l=n(361),d=n(147);function f(e,t=!0,n=o.x){if(Object(o.A)(e)){const i=e.map(e=>f(e,t,n));return t?`[${i.join(", ")}]`:i}return Object(a.d)(e)?n(t?Object(a.b)(e):Object(a.c)(e)):t?n(JSON.stringify(e)):e}function b(e,t){return Object(c.e)(e,(n,i)=>{const r=n.name;let a=i.modifyExpr(e,n);t.push(...i.signals(e,n)),Object(l.a)(n,i=>{i.signals&&(t=i.signals(e,n,t)),i.modifyExpr&&(a=i.modifyExpr(e,n,a))}),t.push({name:r+c.a,on:[{events:{signal:n.name+c.c},update:`modify(${Object(o.Y)(n.name+c.b)}, ${a})`}]})}),v(t)}function g(e,t){if(e.component.selection&&Object(s.r)(e.component.selection).length){const n=Object(o.Y)(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Object(r.a)("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return v(t)}function p(e,t){let n=!1;if(Object(c.e)(e,(i,r)=>{const a=i.name,s=Object(o.Y)(a+c.b);if(0===t.filter(e=>e.name===a).length){const e="global"===i.resolve?"union":i.resolve,n="multi"===i.type?", true)":")";t.push({name:i.name,update:`${c.d}(${s}, ${Object(o.Y)(e)}${n}`})}n=!0,r.topLevelSignals&&(t=r.topLevelSignals(e,i,t)),Object(l.a)(i,n=>{n.topLevelSignals&&(t=n.topLevelSignals(e,i,t))})}),n){0===t.filter(e=>"unit"===e.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return v(t)}function m(e,t){const n=[...t];return Object(c.e)(e,t=>{const r={name:t.name+c.b};if(t.init){const n=t.project.items.map(e=>{const{signals:t}=e;return Object(i.a)(e,["signals"])}),o=t.init.map(e=>f(e,!1));r.values="interval"===t.type?[{unit:Object(c.g)(e,{escape:!1}),fields:n,values:o}]:o.map(t=>({unit:Object(c.g)(e,{escape:!1}),fields:n,values:t}))}n.filter(e=>e.name===t.name+c.b).length||n.push(r)}),n}function h(e,t){return Object(c.e)(e,(n,i)=>{t=i.marks?i.marks(e,n,t):t,Object(l.a)(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function O(e,t){for(const n of e.children)Object(u.g)(n)&&(t=h(n,t));return t}function j(e,t){const n=t.selection,i=e.getSelectionComponent(n,Object(s.H)(n));return{signal:Object(d.b)(i,t)}}function v(e){return e.map(e=>(e.on&&!e.on.length&&delete e.on,e))}}}]);
//# sourceMappingURL=vega-lite.js.map